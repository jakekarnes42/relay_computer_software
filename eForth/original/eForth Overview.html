
<!-- saved from url=(0041)http://www.offete.com/files/zeneForth.htm -->
<html xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word" xmlns="http://www.w3.org/TR/REC-html40"><head><meta http-equiv="Content-Type" content="text/html; charset=Big5">

<meta name="ProgId" content="Word.Document">
<meta name="Generator" content="Microsoft Word 10">
<meta name="Originator" content="Microsoft Word 10">
<link rel="File-List" href="http://www.offete.com/files/zeneForth.files/filelist.xml">
<link rel="Edit-Time-Data" href="http://www.offete.com/files/zeneForth.files/editdata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>eForth Overview</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>DNA BU-20 License Paks-1 orig</o:Author>
  <o:LastAuthor>ting</o:LastAuthor>
  <o:Revision>3</o:Revision>
  <o:TotalTime>2</o:TotalTime>
  <o:Created>2002-12-09T00:54:00Z</o:Created>
  <o:LastSaved>2010-12-24T05:30:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>17167</o:Words>
  <o:Characters>97852</o:Characters>
  <o:Company>eforth</o:Company>
  <o:Lines>815</o:Lines>
  <o:Paragraphs>229</o:Paragraphs>
  <o:CharactersWithSpaces>114790</o:CharactersWithSpaces>
  <o:Version>10.2625</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:PrintFractionalCharacterWidth/>
  <w:SpellingState>Clean</w:SpellingState>
  <w:HyphenationZone>0</w:HyphenationZone>
  <w:DoNotHyphenateCaps/>
  <w:DrawingGridHorizontalSpacing>6 pt</w:DrawingGridHorizontalSpacing>
  <w:DrawingGridVerticalSpacing>6 pt</w:DrawingGridVerticalSpacing>
  <w:DisplayHorizontalDrawingGridEvery>0</w:DisplayHorizontalDrawingGridEvery>
  <w:DisplayVerticalDrawingGridEvery>0</w:DisplayVerticalDrawingGridEvery>
  <w:UseMarginsForDrawingGridOrigin/>
  <w:DoNotShadeFormData/>
  <w:Compatibility>
   <w:OrigWordTableRules/>
   <w:NoLeading/>
   <w:SpaceForUL/>
   <w:BalanceSingleByteDoubleByteWidth/>
   <w:DoNotLeaveBackslashAlone/>
   <w:ULTrailSpace/>
   <w:DoNotExpandShiftReturn/>
   <w:SpacingInWholePoints/>
   <w:ShowBreaksInFrames/>
   <w:SuppressTopSpacing/>
   <w:SuppressTopSpacingMac5/>
   <w:MWSmallCaps/>
   <w:UsePrinterMetrics/>
   <w:WW6BorderRules/>
   <w:FootnoteLayoutLikeWW8/>
   <w:ShapeLayoutLikeWW8/>
   <w:AlignTablesRowByRow/>
   <w:ForgetLastTabAlignment/>
   <w:LayoutRawTableWidth/>
   <w:LayoutTableRowsApart/>
   <w:UseWord97LineBreakingRules/>
   <w:UseFELayout/>
  </w:Compatibility>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Courier;
	panose-1:2 7 4 9 2 2 5 2 4 4;
	mso-font-charset:0;
	mso-generic-font-family:modern;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"New York";
	panose-1:2 4 5 3 6 5 6 2 3 4;
	mso-font-alt:"Times New Roman";
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:Times;
	panose-1:2 2 6 3 5 4 5 2 3 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"New York";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	mso-no-proof:yes;}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	tab-stops:center 240.95pt right 453.55pt;
	layout-grid-mode:char;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	mso-hansi-font-family:"New York";
	mso-no-proof:yes;}
p.eForth, li.eForth, div.eForth
	{mso-style-name:eForth;
	margin-top:0cm;
	margin-right:-36.0pt;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	tab-stops:36.0pt 72.0pt 108.0pt 144.0pt 180.0pt 216.0pt 252.0pt 288.0pt 324.0pt 360.0pt 396.0pt 432.0pt 468.0pt;
	font-size:10.0pt;
	font-family:Courier;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:Courier;
	mso-no-proof:yes;}
p.text, li.text, div.text
	{mso-style-name:text;
	mso-style-parent:eForth;
	margin-top:0cm;
	margin-right:-36.0pt;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	mso-pagination:widow-orphan;
	tab-stops:36.0pt 72.0pt 108.0pt 144.0pt 180.0pt 216.0pt 252.0pt 288.0pt 324.0pt 360.0pt 396.0pt 432.0pt 468.0pt;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Times;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:Times;
	mso-no-proof:yes;}
p.zen, li.zen, div.zen
	{mso-style-name:zen;
	margin-top:0cm;
	margin-right:-72.0pt;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	tab-stops:36.0pt 72.0pt 108.0pt 252.0pt;
	font-size:10.0pt;
	font-family:Courier;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:Courier;
	mso-no-proof:yes;}
 /* Page Definitions */
 @page
	{mso-page-border-surround-header:no;
	mso-page-border-surround-footer:no;}
@page Section1
	{size:612.0pt 792.0pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;
	mso-header-margin:36.0pt;
	mso-footer-margin:36.0pt;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:表格內文;
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
	mso-para-margin:0cm;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="2050"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
<style type="text/css"></style></head>

<body lang="ZH-TW" style="tab-interval:36.0pt">

<div class="Section1">

<p class="MsoNormal" align="center" style="margin-right: -20.0pt;text-align:center"><b style="mso-bidi-font-weight:normal"><span lang="EN-US" style="font-size:18.0pt;
font-family:Times;mso-bidi-font-family:Times">eForth Overview<o:p></o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Before diving directly
into eForth, I would like to discuss the general principles of Forth language.
The language consists of a collection of words, which reside in the memory of a
computer and can be executed by entering their names on the computer
keyboard.<span style="mso-spacerun:yes">&nbsp; </span>A list of words can be
compiled, given a new name and made a new word.<span style="mso-spacerun:yes">&nbsp; </span>In fact, most words in Forth are defined
as lists of existing words.<span style="mso-spacerun:yes">&nbsp; </span>A small
set of primitive words are defined in machine code of the native CPU.<span style="mso-spacerun:yes">&nbsp; </span>All other words are built from this
primitive words and eventually refer to them when executed.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Words are similar to
procedures and subroutines in other languages.<span style="mso-spacerun:yes">&nbsp; </span>The difference is that Forth words are
executable interactively when referenced by name, and they can be compiled into
lists which can be referenced as new words.<span style="mso-spacerun:yes">&nbsp; </span>Programming in Forth is to define new
and more powerful words as lists of existing words.<span style="mso-spacerun:yes">&nbsp; </span>This process continues until the final
word becomes the solution to an application.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Here I will state 'The
Forth Law of Computing" without a proof:<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">All
computable functions can be constructed by defining new words as lists of words
which include a small number of primitive words.<o:p></o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">This eForth model consists
of about 200 words, of which only 31 are primitive words.<span style="mso-spacerun:yes">&nbsp; </span>Although it is very difficult to prove
the above law, I will demonstrate it to you that from this small set of
primitive words a complete operating system with many tools, that is the eForth
model itself, can be built.<span style="mso-spacerun:yes">&nbsp; </span>If an
operating system can be built this way, it is not difficult to understand that
any application can be so developed.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Forth is very similar to
machine code.<span style="mso-spacerun:yes">&nbsp; </span>In a computer, the
CPU has a finite set of machine instructions, and all computable functions are
implemented as lists of these machine instructions.<span style="mso-spacerun:yes">&nbsp; </span>High level languages generally replace
machine instruction lists by statements, functions, subroutines, and procedures,
which can be used to construct procedures and subroutines at higher levels
until the last procedure which is the application.<span style="mso-spacerun:yes">&nbsp; </span>This also helps demonstrating the
validity of the above law.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">The primitive words must
be constructed using native machine code of the host computer.<span style="mso-spacerun:yes">&nbsp; </span>They are also called low level words or
code words.<span style="mso-spacerun:yes">&nbsp; </span>All other words are
constructed as lists of existing words.<span style="mso-spacerun:yes">&nbsp;
</span>They are called high level words or colon words because ":"
(colon) is a Forth word which defines or constructs new words to replace lists
of existing words.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Forth as a computing
system has two principal components: an user interface as the Forth language
processor which interprets the commands entered from keyboard or equivalent
devices; and a machine interface which interprets lists or words recursively
until it can issue machine instructions in the primitive words to the host
computer for execution.<span style="mso-spacerun:yes">&nbsp; </span>The user
interface processes commands in text form.<span style="mso-spacerun:yes">&nbsp;
</span>It is often referred to as the text interpreter and the outer interpreter.<span style="mso-spacerun:yes">&nbsp; </span><o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">The machine interface
executes words by processing recursively the word lists compiled in colon words
to reach the primitive words which are handed to the host computer for
execution. It is often called the inner interpreter and the address
interpreter, because the word lists are often stored in the dictionary as
address lists.<b style="mso-bidi-font-weight:normal"><o:p></o:p></b></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt;mso-pagination:widow-orphan lines-together;
page-break-after:avoid"><b style="mso-bidi-font-weight:normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Virtual Forth
Computer<o:p></o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt;mso-pagination:widow-orphan lines-together;
page-break-after:avoid"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:
Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;mso-pagination:widow-orphan lines-together;
page-break-after:avoid"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:
Times">Forth is a computer model which can be implemented on any real CPU with
reasonable resources.<span style="mso-spacerun:yes">&nbsp; </span>This model is
often called a virtual Forth computer.<span style="mso-spacerun:yes">&nbsp;
</span>The minimal components of a virtual Forth computer are:<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">1.<span style="mso-spacerun:yes">&nbsp;&nbsp; </span>A dictionary in memory to hold all
the execution procedures.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">2.<span style="mso-spacerun:yes">&nbsp;&nbsp; </span>A return stack to hold return
addresses of procedures yet to be executed.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">3.<span style="mso-spacerun:yes">&nbsp;&nbsp; </span>A data stack to hold parameters
passing between procedures.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">4.<span style="mso-spacerun:yes">&nbsp;&nbsp; </span>A user area in RAM memory to hold
all the system variables.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">5.<span style="mso-spacerun:yes">&nbsp;&nbsp; </span>A CPU to move date among stacks
and memory, and to do ALU operations to parameters stored on the data stack.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">The eForth model is a
detailed specification of a virtual Forth computer which can be implemented on
many different CPU's and forces them to behave identically in executing an
identical Forth instruction set. It was first implemneted on a PC using Intel
8086 CPU as a guiding model for other implementations.<span style="mso-spacerun:yes">&nbsp; </span>Here we will try to describe precisely
the behavior of the virtual Forth computer. To describe precisely how this
computer functions, we will use the 8086 machine code to clarify the
specification.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">The following registers
are required for a virtual Forth computer:<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Forth Register <span style="mso-tab-count:1"> </span>8086 Register<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Function<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">IP<span style="mso-tab-count:
3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>SI<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-tab-count:3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Interpreter
Pointer<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">SP<span style="mso-tab-count:
3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>SP<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-tab-count:3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Data
Stack Pointer<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">RP<span style="mso-tab-count:
3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>RP<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp; </span><span style="mso-tab-count:
3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Return
Stack Pointer<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">WP<span style="mso-tab-count:
3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>AX<span style="mso-tab-count:3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Word
or Work Pointer<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">UP<span style="mso-tab-count:
3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(in
memory )<span style="mso-spacerun:yes">&nbsp;&nbsp; </span><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>User
Area Pointer<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">In the dictionary, each
procedure (or word in Forth terminology) occupies an area called code field,
which contains executable machine code and data required by the code. There are
two types of words used in eForth: code word whose code field contains only
machine instructions, and colon word whose code field contains a call to the
list processing subroutine and a list of word addresses.<span style="mso-spacerun:yes">&nbsp; </span>A word address is the code field address
of the word in the dictionary.<span style="mso-spacerun:yes">&nbsp; </span>4
bytes are allocated for the call to list processor. Word addresses are 2 bytes
in length, and are pointers to code fields of words in the dictionary.<span style="mso-spacerun:yes">&nbsp; </span>The length of a code field varies
depending upon the complexity of the word.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">In the code field of a
code word there is a list of machine instructions of the native CPU.<span style="mso-spacerun:yes">&nbsp; </span>The machine instructions are terminated
by a group of instructions, generally specified as a macro instruction named
$NEXT.<span style="mso-spacerun:yes">&nbsp; </span>The function of $NEXT is to
fetch the next word pointed to by the Interpreter Pointer IP, increment IP to
point to the next word in the word list, and jump to the address just
fetched.<span style="mso-spacerun:yes">&nbsp; </span>Since a word address
points to a code field containing executable machine instructions, executing a
word means jumping directly to the code field pointed to by the word
address.<span style="mso-spacerun:yes">&nbsp; </span>$NEXT thus allows the
virtual Forth computer to execute a list of words with very little CPU
overhead.<span style="mso-spacerun:yes">&nbsp; </span>In the 8086
implementation, $NEXT is a macro assembling the following two machine
instructions as shown below.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">In a colon word, the first
four byte in the code field must be a subroutine call instruction to process
the address list following this call instruction.<span style="mso-spacerun:yes">&nbsp; </span>This address list processing subroutine
is named doLIST.<span style="mso-spacerun:yes">&nbsp; </span>doLIST pushes the
contents in IP onto the return stack, copies the address of the first entry in
its address list into IP and then calls $NEXT.<span style="mso-spacerun:yes">&nbsp; </span>$NEXT will then start executing this
list of addresses in sequence.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">The last entry in the
address list of a colon word must be EXIT.<span style="mso-spacerun:yes">&nbsp;
</span>EXIT is a code word which undoes what doLIST accomplished.<span style="mso-spacerun:yes">&nbsp; </span>EXIT pops the top item on the return
stack into the IP register. Consequently, IP points to the address following
the colon word just executed.<span style="mso-spacerun:yes">&nbsp; </span>EXIT
then invokes $NEXT which continues the processing of the word list, briefly
interrupted by the last colon word in this word list.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">$NEXT<span style="mso-tab-count:
1"> </span><span style="mso-spacerun:yes">&nbsp; </span>MACRO<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun:yes">&nbsp; </span>LODSW<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
load next word into WP (AX)<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>JMP<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;
</span>AX<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
jump directly to the word thru WP<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ENDM<span style="mso-tab-count:4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
IP (SI) now points to the next word<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">doLIST<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>( a -- )<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
Run address list in a colon word. <o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>XCHG<span style="mso-tab-count:1">&nbsp; </span>BP,SP<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
exchange pointers<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>PUSH<span style="mso-tab-count:1">&nbsp; </span>SI<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
push return stack<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>XCHG<span style="mso-tab-count:1">&nbsp; </span>BP,SP<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
restore the pointers<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>POP<span style="mso-tab-count:1">&nbsp;&nbsp; </span>SI<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
new list address<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$NEXT<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">CODE<span style="mso-tab-count:1">&nbsp; </span>EXIT<span style="mso-tab-count:3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
Terminate a colon definition.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>XCHG<span style="mso-tab-count:1">&nbsp; </span>BP,SP<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
exchange pointers<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>POP<span style="mso-tab-count:1">&nbsp;&nbsp; </span>SI<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
pop return stack<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>XCHG<span style="mso-tab-count:1">&nbsp; </span>BP,SP<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
restore the pointers<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$NEXT<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">It is interesting to note
that in this eForth implementation, $NEXT is a macro, doLIST is a subroutine,
and EXIT is actually a Forth code words.<span style="mso-spacerun:yes">&nbsp;
</span>$NEXT, doLIST and EXIT are collectively<span style="mso-spacerun:yes">&nbsp; </span>call the 'inner interpreters' and
'address interpreters' of Forth.<span style="mso-spacerun:yes">&nbsp;
</span>They are the corner stones of a virtual Forth computer as they control
the execution flow of Forth words in the system.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Based on the above
mechanism to execute code words and colon words, a Forth computer can be
constructed using a small set of machine dependent code words and a much larger
set of colon words.<span style="mso-spacerun:yes">&nbsp; </span>Tools are
provided so that the user can extend the system by adding new words in truly
modular fashion to solve any practical problems.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">There are 190 high level
words in eForth, built on the 31 low level primitive words.<span style="mso-spacerun:yes">&nbsp; </span>The high level word set is required to
build the outer interpreter and the associated utility words.<span style="mso-spacerun:yes">&nbsp; </span>As the outer interpreter itself
represents a fairly substantial application, the word set necessary to build
the outer interpreter forms a very solid foundation to build most other
applications.<span style="mso-spacerun:yes">&nbsp; </span>However, for any real
world application one would not expect that this eForth word set is
sufficient.<span style="mso-spacerun:yes">&nbsp; </span>The beauty of Forth is
that in programming an application, the user designs and implements a new word
set best tailored to his application.<span style="mso-spacerun:yes">&nbsp;
</span>Forth is an open system, assuming that no operating system can be
complete and all-encompassing.<span style="mso-spacerun:yes">&nbsp; </span>The
user has the best understanding of his own needs, and he knows the best way to
accomplish his goal.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt;mso-pagination:widow-orphan lines-together;
page-break-after:avoid"><b style="mso-bidi-font-weight:normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Memory Map<o:p></o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt;mso-pagination:widow-orphan lines-together;
page-break-after:avoid"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:
Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;mso-pagination:widow-orphan lines-together;
page-break-after:avoid"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:
Times">The most important contribution by von Neumann to the computer design
was the recognition that a single, uniform memory device can be used to store
program and data, contrasting to the then prevailing architectures in which
program and data were stored separately and most often using very different
storage media.<span style="mso-spacerun:yes">&nbsp; </span>It greatly
simplified the design of computers and had become the dominant computer
architecture for all the important computer families ever since.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;mso-pagination:widow-orphan lines-together;
page-break-after:avoid"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:
Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Memory space is a concept
of paramount importance in computer hardware and assembly programming, but
often hidden and ignored in most conventional high level languages.<span style="mso-spacerun:yes">&nbsp; </span>High level languages and operating
systems hide the addressable memory space from the user in order to protect the
operating system, because there are very sensitive areas in the memory space
and unintentional alterations to the information stored in these areas would
cause the system to malfunction or even to crash.<span style="mso-spacerun:yes">&nbsp; </span>The point of view from the operating
system and from the computer priesthood,<span style="mso-spacerun:yes">&nbsp;
</span>these sensitive areas must be protected at all cost, and they are the
reserved territory of the systems programmers.<span style="mso-spacerun:yes">&nbsp; </span>Ordinary applications programmers are
allocated only enough space to run their programs safely, for their own good.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Forth opens the entire
memory space to the user.<span style="mso-spacerun:yes">&nbsp; </span>The user
can freely store data and code into memory and retrieve them from the
memory.<span style="mso-spacerun:yes">&nbsp; </span>Coming with the freedom is
the responsibility of handling the memory correctly.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Memory used in eForth is
separated into the following areas:<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">Cold boot<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-tab-count:1">&nbsp; </span>100H-17FH<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-tab-count:1">&nbsp; </span>Cold start and variable initial values<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">Code dictionary <span style="mso-tab-count:1">&nbsp; </span>180H-1344H<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-tab-count:1">&nbsp; </span>Code dictionary growing upward<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">Free space<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-tab-count:1">&nbsp; </span>1346H-33E4H<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp; </span><span style="mso-tab-count:
1">&nbsp;&nbsp; </span>Shared by code and name dictionaries<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">Name/word<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-tab-count:1">&nbsp;&nbsp; </span>33E6H-3BFFH<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-tab-count:1">&nbsp; </span>Name dictionary growing downward<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">Data stack<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-tab-count:1">&nbsp; </span>3C00H-3E7FH<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-tab-count:1">&nbsp; </span>Growing downward<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">TIB<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style="mso-tab-count:1">&nbsp; </span>3E80H-<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style="mso-tab-count:1">&nbsp; </span>Growing upward<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">Return stack<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>-3F7FH<span style="mso-spacerun:yes">&nbsp; </span><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;</span><span style="mso-tab-count:
2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Growing downward<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">User variables<span style="mso-spacerun:yes">&nbsp; </span><span style="mso-tab-count:1">&nbsp; </span>3F80H-3FFFH<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">These areas are allocated
by assembly constants and can be changed conveniently to suit the target
environment.<span style="mso-spacerun:yes">&nbsp; </span>The following assembly
code segment prescribes the memory allocation in a typical eForth system.<span style="mso-spacerun:yes">&nbsp; </span>The memory map is also illustrated in a
schematic drawing for easier visulization.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">;; Memory allocation<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">;;
0//code&gt;--//--&lt;name//up&gt;--&lt;sp//tib&gt;--rp//em<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">EM<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp; </span>EQU<span style="mso-tab-count:
1">&nbsp;&nbsp; </span>04000H<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;top
of memory<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">COLDD<span style="mso-tab-count:1"> </span>EQU<span style="mso-tab-count:1">&nbsp;&nbsp; </span>00100H<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;cold
start vector<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">US<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp; </span>EQU<span style="mso-tab-count:
1">&nbsp;&nbsp; </span>64*CELLL<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;user
area size in cells<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">RTS<span style="mso-tab-count:1">&nbsp;&nbsp; </span>EQU<span style="mso-tab-count:1">&nbsp;&nbsp; </span>64*CELLL<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;return
stack/TIB size<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">RPP<span style="mso-tab-count:1">&nbsp;&nbsp; </span>EQU<span style="mso-tab-count:1">&nbsp;&nbsp; </span>EM-8*CELLL<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;start
of return stack (RP0)<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">TIBB<span style="mso-tab-count:1">&nbsp; </span>EQU<span style="mso-tab-count:1">&nbsp;&nbsp; </span>RPP-RTS<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;terminal
input buffer (TIB)<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">SPP<span style="mso-tab-count:1">&nbsp;&nbsp; </span>EQU<span style="mso-tab-count:1">&nbsp;&nbsp; </span>TIBB-8*CELLL<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;start
of data stack (SP0)<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">UPP<span style="mso-tab-count:1">&nbsp;&nbsp; </span>EQU<span style="mso-tab-count:1">&nbsp;&nbsp; </span>EM-256*CELLL<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;start
of user area (UP0)<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">NAMEE<span style="mso-tab-count:1"> </span>EQU<span style="mso-tab-count:1">&nbsp;&nbsp; </span>UPP-8*CELLL<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;name
dictionary<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">CODEE<span style="mso-tab-count:1"> </span>EQU<span style="mso-tab-count:1">&nbsp;&nbsp; </span>COLDD+US<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;code
dictionary<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></b></p>

<p class="MsoNormal" align="center" style="margin-right:-36.0pt;text-align:center"><span lang="EN-US"><!--[if gte vml 1]><v:shapetype id="_x0000_t75" coordsize="21600,21600"
 o:spt="75" o:preferrelative="t" path="m@4@5l@4@11@9@11@9@5xe" filled="f"
 stroked="f">
 <v:stroke joinstyle="miter"/>
 <v:formulas>
  <v:f eqn="if lineDrawn pixelLineWidth 0"/>
  <v:f eqn="sum @0 1 0"/>
  <v:f eqn="sum 0 0 @1"/>
  <v:f eqn="prod @2 1 2"/>
  <v:f eqn="prod @3 21600 pixelWidth"/>
  <v:f eqn="prod @3 21600 pixelHeight"/>
  <v:f eqn="sum @0 0 1"/>
  <v:f eqn="prod @6 1 2"/>
  <v:f eqn="prod @7 21600 pixelWidth"/>
  <v:f eqn="sum @8 21600 0"/>
  <v:f eqn="prod @7 21600 pixelHeight"/>
  <v:f eqn="sum @10 21600 0"/>
 </v:formulas>
 <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>
 <o:lock v:ext="edit" aspectratio="t"/>
</v:shapetype><v:shape id="_x0000_i1025" type="#_x0000_t75" style='width:230.25pt;
 height:465pt'>
 <v:imagedata src="" o:title=""/>
</v:shape><![endif]--></span><span lang="EN-US" style="font-family:Times;
mso-bidi-font-family:Times"><o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<b style="mso-bidi-font-weight:normal"><span lang="EN-US" style="font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:Times;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:Times;mso-ansi-language:EN-US;mso-fareast-language:ZH-TW;
mso-bidi-language:AR-SA;mso-no-proof:yes"><br clear="all" style="page-break-before:
always">
</span></b>

<p class="MsoNormal" align="center" style="margin-right:-36.0pt;text-align:center"><b style="mso-bidi-font-weight:normal"><span lang="EN-US" style="font-size:18.0pt;
font-family:Times;mso-bidi-font-family:Times">eForth Kernel<o:p></o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">One of the most important
feature of eForth is the small machine dependent kernel, which allows its to be
ported to other CPU's very conveniently. The selection of words in this kernel
is based on the criteria that they are very difficult if not impossible to
synthesize from other primitive words.<span style="mso-spacerun:yes">&nbsp;
</span>From this set of kernel words, all other Forth words have to be built.<span style="mso-spacerun:yes">&nbsp; </span>The kernel words can be classified as
following:<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">System interface:<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>BYE,
?rx, tx!, !io<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Inner interpreters:<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-tab-count:1">&nbsp; </span>doLIT, doLIST, next, ?branch,<span style="mso-spacerun:yes">&nbsp; </span>branch, EXECUTE, EXIT<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Memory access:<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>! , @,<span style="mso-spacerun:yes">&nbsp; </span>C!,<span style="mso-spacerun:yes">&nbsp; </span>C@<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Return stack:<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>RP@,<span style="mso-spacerun:yes">&nbsp; </span>RP!,<span style="mso-spacerun:yes">&nbsp; </span>R&gt;, R@,<span style="mso-spacerun:yes">&nbsp; </span>R&gt;<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Data stack:<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>SP@,<span style="mso-spacerun:yes">&nbsp; </span>SP!,<span style="mso-spacerun:yes">&nbsp; </span>DROP, DUP,<span style="mso-spacerun:yes">&nbsp; </span>SWAP,<span style="mso-spacerun:yes">&nbsp; </span>OVER<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Logic:<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0&lt;,<span style="mso-spacerun:yes">&nbsp; </span>AND,<span style="mso-spacerun:yes">&nbsp; </span>OR,<span style="mso-spacerun:yes">&nbsp;
</span>XOR<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Arithmetic:<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style="mso-tab-count:1">&nbsp; </span>UM+<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">The virtual Forth computer
is based on a two-stack architecture.<span style="mso-spacerun:yes">&nbsp;
</span>The return stack is used to allow a high level word to be executed in
the address list of another high level word.<span style="mso-spacerun:yes">&nbsp; </span>It is very similar to the return stack
used for nested subroutine calls in a conventional computer.<span style="mso-spacerun:yes">&nbsp; </span>Before executing a high level word in an
address list, the next address of the list is pushed on the return stack so
that the IP register can be used to scan the address list in the called
word.<span style="mso-spacerun:yes">&nbsp; </span>When the called word is
executed to completion, the stored address on the returned stack is popped back
into IP register and execution of the calling word list can be continued.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">The data stack is used to
pass parameters from one word to another.<span style="mso-spacerun:yes">&nbsp;
</span>Conventional computers use the return stack to do the parameter passing,
and it takes a very complicated compiler to figure out which are return
addresses and which are parameters.<span style="mso-spacerun:yes">&nbsp;
</span>Forth segregated these two types of information on two separate stacks
and thus greatly simplies the execution and compilation of words.<span style="mso-spacerun:yes">&nbsp; </span>Passing parameter on the data stack also
reduces the syntactical complexity of Forth language to the minimum and allows
words to be strung together into lists with minimum overhead in compilation and
interpretation.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">The kernal words move and
process data and address among the stacks and the memory.<span style="mso-spacerun:yes">&nbsp; </span>They emcompass the minimal functionality
necessary to make a computer to behave like a Forth computer.<span style="mso-spacerun:yes">&nbsp; </span>A complete understanding of these kernel
word is vital to the understanding of a virtual Forth computer.<span style="mso-spacerun:yes">&nbsp; </span>However, it is not difficult to
understand the kernel words, because there are only 31 of them.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">It is my intention to use
this eForth model to illustrate the validity of 'the Forth Law of Computing',
which stated that all computable functions can be constructed by lists of these
kernel words and the high level words built from these kernel words.<span style="mso-spacerun:yes">&nbsp; </span>The eForth model includes a text
interpreter which allows the user to type lists of word names and execute them
in sequence, a compiler which allows the user to name lists of words and
compile new words, and utilities like memory dump, stack dump, and a colon word
decompiler.<span style="mso-spacerun:yes">&nbsp; </span>Thus the eForth system
forms a fairly complete software development environment for the user to
develop applications.<span style="mso-spacerun:yes">&nbsp; </span>If such a
system can be built from this small set of kernel words, it should be obvious
that most practical applications can also be built from it.<span style="mso-spacerun:yes">&nbsp; </span><o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<b style="mso-bidi-font-weight:normal"><span lang="EN-US" style="font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:Times;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:Times;mso-ansi-language:EN-US;mso-fareast-language:ZH-TW;
mso-bidi-language:AR-SA;mso-no-proof:yes"><br clear="all" style="page-break-before:
always">
</span></b>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">System
Interface <o:p></o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">BYE returns control from
eForth back to the operating system.<span style="mso-spacerun:yes">&nbsp;
</span>!io initializes the serial I/O device in the system so that it can
interact with the user through a terminal.<span style="mso-spacerun:yes">&nbsp;
</span>These two words are not needed once the eForth system is up and running,
but they are essential to bring the system up in DOS.<span style="mso-spacerun:yes">&nbsp; </span>?rx is used to implement ?KEY and KEY,
and tx! is used to implement EMIT.<span style="mso-spacerun:yes">&nbsp;
</span>eForth communicates with the user through these words which supports
terminal interactions and file download/upload.<span style="mso-spacerun:yes">&nbsp; </span>Here these words are defined using the
DOS service calls.<span style="mso-spacerun:yes">&nbsp; </span>For embedded
controllers, these three words must be defined for the specific I/O devices.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">?RX is a unique design
invented by Bill Muench to support serial input .<span style="mso-spacerun:yes">&nbsp; </span>?RX provides the functions required of
both KEY and KEY? which accept input from a terminal.<span style="mso-spacerun:yes">&nbsp; </span>?RX inspects the terminal device and
returns a character and a true flag if the character has been received and is
waiting to be retrieved.<span style="mso-spacerun:yes">&nbsp; </span>If no
character was received, ?RX simply returns a false flag.<span style="mso-spacerun:yes">&nbsp; </span>With ?RX, both KEY and KEY? can be
defined as high level colon definitions.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">TX! sends a character on
the data stack to the terminal device.<span style="mso-spacerun:yes">&nbsp;
</span>Both ?RX and TX! are coded here as DOS calls.<span style="mso-spacerun:yes">&nbsp; </span>In embedded applications, they will have
to be coded in machine specific code to handle the specific serial I/O
device.<span style="mso-spacerun:yes">&nbsp; </span>!IO initializes the serial
I/O device, which is not necessary here because it is taking care of by the
DOS.<span style="mso-spacerun:yes">&nbsp; </span>In embedded systems, the I/O
device must be initialized by !IO.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">CODE BYE<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp; </span>( -- , exit Forth )<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>INT<span style="mso-tab-count:1">&nbsp;&nbsp; </span>020H<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
return to DOS <o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">CODE<span style="mso-tab-count:1">&nbsp; </span>?RX<span style="mso-tab-count:1">&nbsp;&nbsp; </span>(
-- c T | F )<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
Return input character and true, <o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
or a false if no input. <o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$CODE<span style="mso-tab-count:1"> </span>3,'?RX',QRX<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>XOR<span style="mso-tab-count:1">&nbsp;&nbsp; </span>BX,BX<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
BX=0 setup for false flag<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>MOV<span style="mso-tab-count:1">&nbsp;&nbsp; </span>DL,0FFH<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
input command<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>MOV<span style="mso-tab-count:1">&nbsp;&nbsp; </span>AH,6<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
MS-DOS Direct Console I/O<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>INT<span style="mso-tab-count:1">&nbsp;&nbsp; </span>021H<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>JZ<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp; </span>QRX3<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
?key ready<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>OR<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp; </span>AL,AL<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
AL=0 if extended char<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>JNZ<span style="mso-tab-count:1">&nbsp;&nbsp; </span>QRX1<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
?extended character code<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>INT<span style="mso-tab-count:1">&nbsp;&nbsp; </span>021H<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>MOV<span style="mso-tab-count:1">&nbsp;&nbsp; </span>BH,AL<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
extended code in msb<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>JMP<span style="mso-tab-count:1">&nbsp;&nbsp; </span>QRX2<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">QRX1:<span style="mso-tab-count:1"> </span>MOV<span style="mso-tab-count:1">&nbsp;&nbsp; </span>BL,AL<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">QRX2:<span style="mso-tab-count:1"> </span>PUSH<span style="mso-tab-count:1">&nbsp; </span>BX<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
save character<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>MOV<span style="mso-tab-count:1">&nbsp;&nbsp; </span>BX,-1<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
true flag<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">QRX3:<span style="mso-tab-count:1"> </span>PUSH<span style="mso-tab-count:1">&nbsp; </span>BX<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$NEXT<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">CODE<span style="mso-tab-count:1">&nbsp; </span>TX!<span style="mso-tab-count:1">&nbsp;&nbsp; </span>(
c -- )<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
Send character c to output device.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>POP<span style="mso-tab-count:1">&nbsp;&nbsp; </span>DX<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
char in DL<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>CMP<span style="mso-tab-count:1">&nbsp;&nbsp; </span>DL,0FFH<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
0FFH is interpreted as input<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>JNZ<span style="mso-tab-count:1">&nbsp;&nbsp; </span>TX1<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
do NOT allow input<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>MOV<span style="mso-tab-count:1">&nbsp;&nbsp; </span>DL,32<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
change to blank<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">TX1:<span style="mso-tab-count:1">&nbsp; </span>MOV<span style="mso-tab-count:1">&nbsp;&nbsp; </span>AH,6<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
MS-DOS Direct Console I/O<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>INT<span style="mso-tab-count:1">&nbsp;&nbsp; </span>021H<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
display character<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$NEXT<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">CODE<span style="mso-tab-count:1">&nbsp; </span>!IO<span style="mso-tab-count:1">&nbsp;&nbsp; </span>(
-- )<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
Initialize the serial I/O devices.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$NEXT<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<b style="mso-bidi-font-weight:normal"><span lang="EN-US" style="font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:Times;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:Times;mso-ansi-language:EN-US;mso-fareast-language:ZH-TW;
mso-bidi-language:AR-SA;mso-no-proof:yes"><br clear="all" style="page-break-before:
always">
</span></b>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Inner
Interpreter <o:p></o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">In the word list of a
colon definition, it is generally assumed that words are execution addresses,
which can be executed sequentially by the address interpreter $NEXT.<span style="mso-spacerun:yes">&nbsp; </span>However, occasionally we do need to
compile other types of data in-line with the words.<span style="mso-spacerun:yes">&nbsp; </span>Special mechanisms must be used to tell
the address interpreter to treat these data differently.<span style="mso-spacerun:yes">&nbsp; </span>All data entries must be preceded by
special words which can handle the data properly.<span style="mso-spacerun:yes">&nbsp; </span>A special word and its associated data
form a data structure.<span style="mso-spacerun:yes">&nbsp; </span>Data
structures are extensions of words and can be thought of as building blocks to
form lists in colon definitions.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">$NEXT must be assembled at
the end of a code word.<span style="mso-spacerun:yes">&nbsp; </span>It fetches
the next address in the address list pointed to by IP and jumps to that
address.<span style="mso-spacerun:yes">&nbsp; </span>It allows an address list
to be scanned and thus executed.<span style="mso-spacerun:yes">&nbsp;
</span>doLIST starts the execution of an address list by saving IP on the
return stack and stores the starting address of an address list into IP, and
then $NEXT starts executing this address list.<span style="mso-spacerun:yes">&nbsp; </span>EXIT must be compiled as the last entry
in an address list.<span style="mso-spacerun:yes">&nbsp; </span>It terminates
the execution of the current address list and returns execution to the address
saved on the return stack.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">EXECUTE takes the
execution address from the data stack and executes that word.<span style="mso-spacerun:yes">&nbsp; </span>This powerful word allows the user to
execute any word which is not a part of an address list.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">doLIT pushes the next word
onto the data stack as an integer literal instead of as an addresses to be
executed by $NEXT.<span style="mso-spacerun:yes">&nbsp; </span>It allows
numbers to be compiled as in-line literals, supplying data to the data stack at
run time.<span style="mso-spacerun:yes">&nbsp; </span>doLIT is not used by
itself, but rather compiled by LITERAL which inserts doLIT and its asociated
integer into the address list under construction.<span style="mso-spacerun:yes">&nbsp; </span>Anytime you see a number in a colon
definition, LITERAL is invoked to compile an integer literal with doLIT.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Integer literals are by
far the most numerous data structures in colon definitions other than regular
words.<span style="mso-spacerun:yes">&nbsp; </span>Address literals are used to
build control structures.<span style="mso-spacerun:yes">&nbsp; </span>String
literals are used to embed text strings in colon definitions.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">$NEXT<span style="mso-tab-count:
1"> </span><span style="mso-spacerun:yes">&nbsp; </span>MACRO<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun:yes">&nbsp; </span>LODSW<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
load next word into WP (AX)<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun:yes">&nbsp;&nbsp;</span>JMP<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>AX<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
jump directly to the word thru WP<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ENDM<span style="mso-tab-count:4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
IP (SI) now points to the next word<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">doLIST<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>( a -- )<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
Run address list in a colon word. <o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>XCHG<span style="mso-tab-count:1">&nbsp; </span>BP,SP<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
exchange pointers<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>PUSH<span style="mso-tab-count:1">&nbsp; </span>SI<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
push return stack<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>XCHG<span style="mso-tab-count:1">&nbsp; </span>BP,SP<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
restore the pointers<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>POP<span style="mso-tab-count:1">&nbsp;&nbsp; </span>SI<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
new list address<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$NEXT<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">CODE<span style="mso-tab-count:1">&nbsp; </span>EXIT<span style="mso-tab-count:3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
Terminate a colon definition.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>XCHG<span style="mso-tab-count:1">&nbsp; </span>BP,SP<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
exchange pointers<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>POP<span style="mso-tab-count:1">&nbsp;&nbsp; </span>SI<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
pop return stack<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>XCHG<span style="mso-tab-count:1">&nbsp; </span>BP,SP<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
restore the pointers<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$NEXT<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">CODE<span style="mso-tab-count:1">&nbsp; </span>EXECUTE<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp; </span>(
ca -- )<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
Execute the word at ca.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>POP<span style="mso-tab-count:1">&nbsp;&nbsp; </span>BX<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>JMP<span style="mso-tab-count:1">&nbsp;&nbsp; </span>BX<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
jump to the code address<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">CODE<span style="mso-tab-count:1">&nbsp; </span>doLIT<span style="mso-tab-count:1"> </span>(
-- w )<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
Push inline literal on data stack.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>LODSW<span style="mso-tab-count:3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
get the literal compiled in-line<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>PUSH<span style="mso-tab-count:1">&nbsp; </span>AX<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
push literal on the stack<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$NEXT<span style="mso-tab-count:3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
execute next word after literal<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<b style="mso-bidi-font-weight:normal"><span lang="EN-US" style="font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:Times;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:Times;mso-ansi-language:EN-US;mso-fareast-language:ZH-TW;
mso-bidi-language:AR-SA;mso-no-proof:yes"><br clear="all" style="page-break-before:
always">
</span></b>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Loops
and Branches<o:p></o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">eForth uses three
different types of address literals. 'next', '?branch' and 'branch' are
followed not by word addresses but by pointers to locations in a list to be
executed next.<span style="mso-spacerun:yes">&nbsp; </span>These address
literals are the building blocks upon which loops and branching structures are
constructed.<span style="mso-spacerun:yes">&nbsp; </span>An address literal is
followed by a branch pointer which causes execution to be transferred to that
location.<span style="mso-spacerun:yes">&nbsp; </span>The branch location most
often points to a different location in the address list of the same colon
word.<span style="mso-spacerun:yes">&nbsp; </span><o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">CODE<span style="mso-tab-count:1">&nbsp; </span>next<span style="mso-tab-count:1">&nbsp; </span>(
-- )<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
Decrement index and exit loop <o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
if index is less than 0.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>SUB<span style="mso-tab-count:1">&nbsp;&nbsp; </span>WORD
PTR [BP],1<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
decrement the index<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>JC<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp; </span>NEXT1<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
?decrement below 0<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>MOV<span style="mso-tab-count:1">&nbsp;&nbsp; </span>SI,0[SI]<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
no, continue loop<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$NEXT<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">NEXT1:ADD<span style="mso-tab-count:1">&nbsp;&nbsp; </span>BP,2<span style="mso-tab-count:
2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
yes, pop the index<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ADD<span style="mso-tab-count:1">&nbsp;&nbsp; </span>SI,2<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
exit loop<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$NEXT<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">CODE<span style="mso-tab-count:1">&nbsp; </span>?branch<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp; </span>(
f -- )<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
Branch if flag is zero.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>POP<span style="mso-tab-count:1">&nbsp;&nbsp; </span>BX<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
pop flag<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>OR<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp; </span>BX,BX<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
?flag=0<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>JZ<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp; </span>BRAN1<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
yes, so branch<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ADD<span style="mso-tab-count:1">&nbsp;&nbsp; </span>SI,2<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
point IP to next cell<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$NEXT<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">BRAN1:MOV<span style="mso-tab-count:1">&nbsp;&nbsp; </span>SI,0[SI]<span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
IP:=(IP), jump to new address<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$NEXT<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">CODE<span style="mso-tab-count:1">&nbsp; </span>branch<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(
-- )<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
Branch to an inline address.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>MOV<span style="mso-tab-count:1">&nbsp;&nbsp; </span>SI,0[SI]<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
jump to new address unconditionally<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$NEXT<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Address literals are used
to construct control structures in colon definitions.<span style="mso-spacerun:yes">&nbsp; </span>'next' is compiled by NEXT.<span style="mso-spacerun:yes">&nbsp; </span>'?branch' is compiled by IF, WHILE and
UNTIL.<span style="mso-spacerun:yes">&nbsp; </span>'branch' is compiled by AFT,
ELSE, REPEAT and AGAIN.<span style="mso-spacerun:yes">&nbsp; </span>In the
colon words to be discussed in the later sections, you will not see these
kernel words but words which construct loops and branches.<span style="mso-spacerun:yes">&nbsp; </span>For examples:<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>IF
( compiles ?branch and address after THEN ) &lt;true clause&gt;<span style="mso-spacerun:yes">&nbsp; </span>THEN<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>IF
( compiles ?branch and address after ELSE )<span style="mso-spacerun:yes">&nbsp; </span>&lt;true clause&gt;<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><span style="mso-tab-count:
2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ELSE
( compiles branch and address after THEN ) &lt;false clause&gt;<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><span style="mso-tab-count:
2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>THEN<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>BEGIN
(marks current address ) &lt;loop clause&gt;<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><span style="mso-tab-count:
2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>AGAIN
( compiles branch and address after BEGIN )<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>BEGIN
( mark current address ) &lt;loop clause&gt;<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><span style="mso-tab-count:
2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>UNTIL
( compiles ?branch and address after BEGIN )<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>BEGIN
( mark current address ) &lt;loop clause&gt;<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><span style="mso-tab-count:
2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>WHILE
( compiles ?branch and address after REPEAT ) &lt;true clause&gt;<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><span style="mso-tab-count:
2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>REPEAT
( compile branch and address after BEGIN )<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>FOR<span style="mso-spacerun:yes">&nbsp; </span>( set up loop, mark current address )
&lt;loop clause&gt;<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><span style="mso-tab-count:
2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>NEXT
( compile next and address after FOR )<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>FOR
( set up loop, mark current address ) &lt;loopclause&gt;<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><span style="mso-tab-count:
2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>AFT
( change marked address to current address, compile branch<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><span style="mso-tab-count:
3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>and
address after THEN ) &lt;skip clause&gt;<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><span style="mso-tab-count:
2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>THEN
&lt;loop clause&gt;<span style="mso-spacerun:yes">&nbsp; </span>NEXT ( compile
next and address after AFT )<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><span style="mso-tab-count:
2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></span></p>

<b style="mso-bidi-font-weight:normal"><span lang="EN-US" style="font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:Times;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:Times;mso-ansi-language:EN-US;mso-fareast-language:ZH-TW;
mso-bidi-language:AR-SA;mso-no-proof:yes"><br clear="all" style="page-break-before:
always">
</span></b>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Memory
Access</span></b><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:
Times"><o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Four memory accessing
words are included in the eForth kernel: ! (store), @ (fetch), C! (C-store) and
C@ (C-fetch).<span style="mso-spacerun:yes">&nbsp; </span>! and @ access memory
in cells, whose size depends on the CPU underneath.<span style="mso-spacerun:yes">&nbsp; </span>eForth assumes that the CPU can access
memory in bytes and that all addresses are in the units of bytes.<span style="mso-spacerun:yes">&nbsp;&nbsp; </span>C! and C@ allow the user access
memory in bytes.<span style="mso-spacerun:yes">&nbsp; </span><o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">The two most important
resources in a computer are the CPU and the memory.<span style="mso-spacerun:yes">&nbsp; </span>There is not much one can do with the
CPU, except to use its instruction set to write programs.<span style="mso-spacerun:yes">&nbsp; </span>However, the real usefulness and
intelligence lies with the memory, which holds both the program and the
data.<span style="mso-spacerun:yes">&nbsp; </span>In conventional languages,
you humbly request memory to store your data, and the compiler reluctantly
allocate it to you.<span style="mso-spacerun:yes">&nbsp; </span>If you exceed
your memory allocation, your program will be ruthlessly terminated.<span style="mso-spacerun:yes">&nbsp; </span><o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">In Forth, you have all the
memory and you are allowed to do anything with the memory.<span style="mso-spacerun:yes">&nbsp; </span>!, @, C! and C@ do not place restriction
on their use.<span style="mso-spacerun:yes">&nbsp; </span>You can use them to
write self-modifying code if you like.<span style="mso-spacerun:yes">&nbsp;
</span>However, you must know exactly what you are doing. <o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">It is not a very good idea
to change the contents of the dictionary, except in the parameter fields of
variables and arrays you defined specifically for data storage.<span style="mso-spacerun:yes">&nbsp; </span>The space occupied by the stacks should
be respected, too.<span style="mso-spacerun:yes">&nbsp; </span>The user variable
area holds vital information for the system to run correctly.<span style="mso-spacerun:yes">&nbsp; </span>The space bewteen the code dictionary
and the name dictionary are not used and you are free to use it to store
temporary data.<span style="mso-spacerun:yes">&nbsp; </span>Be reminded,
however, that as you define new words, the dictionaries are extended and may
over-write data you placed there.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">The moral is: Use @ and C@
freely, but be careful with ! and C!.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">CODE<span style="mso-tab-count:1">&nbsp; </span>!<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp; </span>(
w a -- )<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
Pop the data stack to memory.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>POP<span style="mso-tab-count:1">&nbsp;&nbsp; </span>BX<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
get address from tos<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>POP<span style="mso-tab-count:1">&nbsp;&nbsp; </span>0[BX]<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
store data to that adddress<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$NEXT<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">CODE<span style="mso-tab-count:1">&nbsp; </span>@<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp; </span>(
a -- w )<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
Push memory location to data stack.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>POP<span style="mso-tab-count:1">&nbsp;&nbsp; </span>BX<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
get address<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>PUSH<span style="mso-tab-count:1">&nbsp; </span>0[BX]<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
fetch data<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$NEXT<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">CODE<span style="mso-tab-count:1">&nbsp; </span>C!<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp; </span>(
c b -- )<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
Pop data stack to byte memory.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>POP<span style="mso-tab-count:1">&nbsp;&nbsp; </span>BX<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
get address<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>POP<span style="mso-tab-count:1">&nbsp;&nbsp; </span>AX<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
get data in a cell<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>MOV<span style="mso-tab-count:1">&nbsp;&nbsp; </span>0[BX],AL<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
store one byte<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$NEXT<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">CODE<span style="mso-tab-count:1">&nbsp; </span>C@<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp; </span>(
b -- c )<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
Push byte memory content on data stack.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>POP<span style="mso-tab-count:1">&nbsp;&nbsp; </span>BX<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
get address<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>XOR<span style="mso-tab-count:1">&nbsp;&nbsp; </span>AX,AX
<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
AX=0 zero the hi byte<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>MOV<span style="mso-tab-count:1">&nbsp;&nbsp; </span>AL,0[BX]<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
get low byte<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>PUSH<span style="mso-tab-count:1">&nbsp; </span>AX<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
push on stack<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$NEXT<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<b style="mso-bidi-font-weight:normal"><span lang="EN-US" style="font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:Times;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:Times;mso-ansi-language:EN-US;mso-fareast-language:ZH-TW;
mso-bidi-language:AR-SA;mso-no-proof:yes"><br clear="all" style="page-break-before:
always">
</span></b>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Return
Stack <o:p></o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">RP! pushes the address on
the top of the data stack to the return stack and thus initializes the return
stack.<span style="mso-spacerun:yes">&nbsp; </span>RP! is only used to
initialize the system and are seldom used in applications.<span style="mso-spacerun:yes">&nbsp; </span>RP@ pushes the contents of the return
stack pointer RP on the data stack.<span style="mso-spacerun:yes">&nbsp;
</span>It is also used very rarely in applications.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">&gt;R pops a number off
the data stack and pushes it on the return stack..<span style="mso-spacerun:yes">&nbsp; </span>R&gt; does the opposite.<span style="mso-spacerun:yes">&nbsp; </span>R@ copies the top item on the return
stack and pushes it on the data stack.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">The eForth system uses the
return stack for two specific purposes: to save addresses while recusing
through an address list, and to store the loop index during a FOR-NEXT
loop.<span style="mso-spacerun:yes">&nbsp; </span>As the addresses piled up on
the return stack changes dynamically as words are executed, there is very
little useful information the user can get from the return stack at the run
time.<span style="mso-spacerun:yes">&nbsp; </span>In setting up a loop, FOR
compiles &gt;R, which pushes the loop index from the data stack to the return
stack.<span style="mso-spacerun:yes">&nbsp; </span>Inside the FOR-NEXT loop,
the running index can be recalled by R@.<span style="mso-spacerun:yes">&nbsp;
</span>NEXT compiles 'next' with an address after FOR.<span style="mso-spacerun:yes">&nbsp; </span>when 'next' is executed, it decrements
the loop index on the top of the return stack.<span style="mso-spacerun:yes">&nbsp; </span>If the index becomes negative, the loop
is terminated; otherwise, 'next' jumps back to the word after FOR.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Return stack is used by
the virtual Forth computer to save return addresses to be processes later.<span style="mso-spacerun:yes">&nbsp; </span>It is also a convenient place to store
data temporarily.<span style="mso-spacerun:yes">&nbsp; </span>The return stack
can thus be considered as a extension of the data stack.<span style="mso-spacerun:yes">&nbsp; </span>However, one must be very careful in
using the return stack for temporary storage.<span style="mso-spacerun:yes">&nbsp; </span>The data pushed on the return stack must
be popped off before EXIT is executed.<span style="mso-spacerun:yes">&nbsp;
</span>Otherwise, EXIT will get the wrong address to return to, and the system
generally will crash.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">CODE<span style="mso-tab-count:1">&nbsp; </span>RP@<span style="mso-tab-count:1">&nbsp;&nbsp; </span>(
-- a )<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
Push current RP to data stack.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>PUSH<span style="mso-tab-count:1">&nbsp; </span>BP<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
copy address to return stack<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$NEXT<span style="mso-tab-count:3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
pointer register BP<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">CODE<span style="mso-tab-count:1">&nbsp; </span>RP!<span style="mso-tab-count:1">&nbsp;&nbsp; </span>(
a -- )<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
Set the return stack pointer.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>POP<span style="mso-tab-count:1">&nbsp;&nbsp; </span>BP<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
copy (BP) to tos<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$NEXT<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">CODE<span style="mso-tab-count:1">&nbsp; </span>R&gt;<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp; </span>(
-- w )<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
Pop return stack to data stack.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>PUSH<span style="mso-tab-count:1">&nbsp; </span>0[BP]<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
copy w to data stack<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ADD<span style="mso-tab-count:1">&nbsp;&nbsp; </span>BP,2<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
adjust RP for popping<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$NEXT<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">CODE<span style="mso-tab-count:1">&nbsp; </span>R@<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp; </span>(
-- w )<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
Copy top of return stack to data stack.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>PUSH<span style="mso-tab-count:1">&nbsp; </span>0[BP]<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
copy w to data stack<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$NEXT<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">CODE<span style="mso-tab-count:1">&nbsp; </span>&gt;R<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp; </span>(
w -- )<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
Push data stack to return stack.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>SUB<span style="mso-tab-count:1">&nbsp;&nbsp; </span>BP,2<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
adjust RP for pushing<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>POP<span style="mso-tab-count:1">&nbsp;&nbsp; </span>0[BP]<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
push w to return stack<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$NEXT<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<b style="mso-bidi-font-weight:normal"><span lang="EN-US" style="font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:Times;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:Times;mso-ansi-language:EN-US;mso-fareast-language:ZH-TW;
mso-bidi-language:AR-SA;mso-no-proof:yes"><br clear="all" style="page-break-before:
always">
</span></b>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Data
Stack <o:p></o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">The data stack is the centralized
location where all numerical data are processed, and where parameters are
passed from one word to another.<span style="mso-spacerun:yes">&nbsp;
</span>The stack items has to be arranged properly so that they can be
retrieved properly in the Last-In-First-Out (LIFO) manner.<span style="mso-spacerun:yes">&nbsp; </span>When stack items are out of order, they
can be rearranged by the stack words DUP, SWAP, OVER and DROP.<span style="mso-spacerun:yes">&nbsp; </span>There are other stack words useful in
manipulating stack items, but these four are considered to be the minimum set.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Data stack is initialized
by SP!.<span style="mso-spacerun:yes">&nbsp; </span>The depth of data stack can
be examined by SP@.<span style="mso-spacerun:yes">&nbsp; </span>These words, as
RP@ and RP! are only used by the system and very rarely used in
applications.<span style="mso-spacerun:yes">&nbsp; </span>These words are
necessary in the Forth kernel because you cannot operate a stack-based computer
without these instructions.<span style="mso-spacerun:yes">&nbsp; </span><o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">CODE<span style="mso-tab-count:1">&nbsp; </span>DROP<span style="mso-tab-count:1">&nbsp; </span>(
w -- )<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
Discard top stack item.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ADD<span style="mso-tab-count:1">&nbsp;&nbsp; </span>SP,2<span style="mso-tab-count:1">&nbsp; </span> <span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
adjust SP to pop<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$NEXT<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">CODE<span style="mso-tab-count:1">&nbsp; </span>DUP<span style="mso-tab-count:1">&nbsp;&nbsp; </span>(
w -- w w )<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
Duplicate the top stack item.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>MOV<span style="mso-tab-count:1">&nbsp;&nbsp; </span>BX,SP
<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
use BX to index the stack<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>PUSH<span style="mso-tab-count:1">&nbsp; </span>0[BX]<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$NEXT<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">CODE<span style="mso-tab-count:1">&nbsp; </span>SWAP<span style="mso-tab-count:1">&nbsp; </span>(
w1 w2 -- w2 w1 )<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
Exchange top two stack items.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>POP<span style="mso-tab-count:1">&nbsp;&nbsp; </span>BX<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
get w2<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>POP<span style="mso-tab-count:1">&nbsp;&nbsp; </span>AX<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
get w1<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>PUSH<span style="mso-tab-count:1">&nbsp; </span>BX<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
push w2<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>PUSH<span style="mso-tab-count:1">&nbsp; </span>AX<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
push w1<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$NEXT<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">CODE<span style="mso-tab-count:1">&nbsp; </span>OVER<span style="mso-tab-count:1">&nbsp; </span>(
w1 w2 -- w1 w2 w1 )<span style="mso-tab-count:1">&nbsp;&nbsp; </span>\ Copy
second stack item to top.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>MOV<span style="mso-tab-count:1">&nbsp;&nbsp; </span>BX,SP
<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
use BX to index the stack<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>PUSH<span style="mso-tab-count:1">&nbsp; </span>2[BX]<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
get w1 and push on stack<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$NEXT<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">CODE<span style="mso-tab-count:1">&nbsp; </span>SP@<span style="mso-tab-count:1">&nbsp;&nbsp; </span>(
-- a )<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
Push the current data stack pointer.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>MOV<span style="mso-tab-count:1">&nbsp;&nbsp; </span>BX,SP
<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
use BX to index the stack<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>PUSH<span style="mso-tab-count:1">&nbsp; </span>BX<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
push SP back<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$NEXT<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">CODE<span style="mso-tab-count:1">&nbsp; </span>SP!<span style="mso-tab-count:1">&nbsp;&nbsp; </span>(
a -- )<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
Set the data stack pointer.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>POP<span style="mso-tab-count:1">&nbsp;&nbsp; </span>SP<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
safety<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$NEXT<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></b></p>

<b style="mso-bidi-font-weight:normal"><span lang="EN-US" style="font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:Times;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:Times;mso-ansi-language:EN-US;mso-fareast-language:ZH-TW;
mso-bidi-language:AR-SA;mso-no-proof:yes"><br clear="all" style="page-break-before:
always">
</span></b>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Logical
Words<o:p></o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">The only primitive word which
cares about logic is '?branch'.<span style="mso-spacerun:yes">&nbsp; </span>It
tests the top item on the stack.<span style="mso-spacerun:yes">&nbsp; </span>If
it is zero, ?branch will branch to the following address.<span style="mso-spacerun:yes">&nbsp; </span>If it is not zero, ?branch will ignore
the address and execute the word after the branch address.<span style="mso-spacerun:yes">&nbsp; </span>Thus we distinguish two classes of
numbers, zero for 'false' and non-zero for 'true'.<span style="mso-spacerun:yes">&nbsp; </span>Numbers used this way are called logic
flags which can be either true or false.<span style="mso-spacerun:yes">&nbsp;
</span>The only primitive word which generates flags is '0&lt;', which examines
the top item on the data stack for its negativeness.<span style="mso-spacerun:yes">&nbsp; </span>If it is negative, '0&lt;' will return a
-1 for true.<span style="mso-spacerun:yes">&nbsp; </span>If it is 0 or
positive, '0&lt;' will return a 0 for false.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">The three logic words AND,
OR and XOR are bitwise logic operators over the width of a cell.<span style="mso-spacerun:yes">&nbsp; </span>They can be used to operate on real flags
(0 and -1) for logic purposes.<span style="mso-spacerun:yes">&nbsp; </span>The
user must be aware of the distinct behaviors between the real flags and the
generalized flags.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">CODE<span style="mso-tab-count:1">&nbsp; </span>0&lt;<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp; </span>(
n -- f )<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
Return true if n is negative.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>POP<span style="mso-tab-count:1">&nbsp;&nbsp; </span>AX<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>CWD<span style="mso-tab-count:1">&nbsp;&nbsp; </span><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp; </span><span style="mso-tab-count:
2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
sign extend AX into DX<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>PUSH<span style="mso-tab-count:1">&nbsp; </span>DX<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
push 0 or -1<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$NEXT<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">CODE<span style="mso-tab-count:1">&nbsp; </span>AND<span style="mso-tab-count:1">&nbsp;&nbsp; </span>(
w w -- w )<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
Bitwise AND.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>POP<span style="mso-tab-count:1">&nbsp;&nbsp; </span>BX<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>POP<span style="mso-tab-count:1">&nbsp;&nbsp; </span>AX<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>AND<span style="mso-tab-count:1">&nbsp;&nbsp; </span>BX,AX<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>PUSH<span style="mso-tab-count:1">&nbsp; </span>BX<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$NEXT<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">CODE<span style="mso-tab-count:1">&nbsp; </span>OR<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp; </span>(
w w -- w )<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
Bitwise inclusive OR.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>POP<span style="mso-tab-count:1">&nbsp;&nbsp; </span>BX<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>POP<span style="mso-tab-count:1">&nbsp;&nbsp; </span>AX<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>OR<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp; </span>BX,AX<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>PUSH<span style="mso-tab-count:1">&nbsp; </span>BX<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$NEXT<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">CODE<span style="mso-tab-count:1">&nbsp; </span>XOR<span style="mso-tab-count:1">&nbsp;&nbsp; </span>(
w w -- w )<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
Bitwise exclusive OR.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>POP<span style="mso-tab-count:1">&nbsp;&nbsp; </span>BX<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>POP<span style="mso-tab-count:1">&nbsp;&nbsp; </span>AX<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>XOR<span style="mso-tab-count:1">&nbsp;&nbsp; </span>BX,AX<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>PUSH<span style="mso-tab-count:1">&nbsp; </span>BX<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$NEXT<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></b></p>

<b style="mso-bidi-font-weight:normal"><span lang="EN-US" style="font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:Times;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:Times;mso-ansi-language:EN-US;mso-fareast-language:ZH-TW;
mso-bidi-language:AR-SA;mso-no-proof:yes"><br clear="all" style="page-break-before:
always">
</span></b>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Primitive
Arithmetic </span></b><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:
Times"><o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">The only primitive
arithmetic word in the eForth kernel is UM+.<span style="mso-spacerun:yes">&nbsp; </span>All other arithmetic words, like +, -, *
and / are derived from UM+ as colon definitions.<span style="mso-spacerun:yes">&nbsp; </span>This design emphasize portability over performance,
because it greatly reduces the efforts in moving eForth into CPU's which do not
have native multiply and divide instructions.<span style="mso-spacerun:yes">&nbsp; </span>Once eForth is implemented on a new CPU,
the more complicated arithmetic words are the first ones to be optimized to
enhance the performance.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">UM+ adds two unsigned
number on the top of the data stack and returns to the data stack the sum of
these two numbers and the carry as one number on top of the sum.<span style="mso-spacerun:yes">&nbsp; </span>To handle the carry this way is very
inefficient, because most CPU's have carry as a bit in the status register, and
the carry can be accessed by many machine instructions.<span style="mso-spacerun:yes">&nbsp; </span>It is thus more convenient to use carry
in machine code programming.<span style="mso-spacerun:yes">&nbsp; </span>eForth
provides the user a handle on the carry in high level, making it easier for the
user to deal with it directly.<span style="mso-spacerun:yes">&nbsp; </span><o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">CODE<span style="mso-tab-count:1">&nbsp; </span>UM+<span style="mso-tab-count:1">&nbsp;&nbsp; </span>(
w w -- w cy )<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">\ <span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp; </span>Add two numbers, return the
sum and carry flag.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>XOR<span style="mso-tab-count:1">&nbsp;&nbsp; </span>CX,CX
<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
CX=0 initial carry flag<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>POP<span style="mso-tab-count:1">&nbsp;&nbsp; </span>BX<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>POP<span style="mso-tab-count:1">&nbsp;&nbsp; </span>AX<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ADD<span style="mso-tab-count:1">&nbsp;&nbsp; </span>AX,BX<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>RCL<span style="mso-tab-count:1">&nbsp;&nbsp; </span>CX,1<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
get carry<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>PUSH<span style="mso-tab-count:1">&nbsp; </span>AX<span style="mso-spacerun:yes">&nbsp;&nbsp; </span><span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
push sum<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>PUSH<span style="mso-tab-count:1">&nbsp; </span>CX<span style="mso-spacerun:yes">&nbsp; </span><span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
push carry<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$NEXT<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><o:p>&nbsp;</o:p></span></p>

<b style="mso-bidi-font-weight:normal"><span lang="EN-US" style="font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:Times;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:Times;mso-ansi-language:EN-US;mso-fareast-language:ZH-TW;
mso-bidi-language:AR-SA;mso-no-proof:yes"><br clear="all" style="page-break-before:
always">
</span></b>

<p class="MsoNormal" align="center" style="margin-right:-36.0pt;text-align:center"><b style="mso-bidi-font-weight:normal"><span lang="EN-US" style="font-size:18.0pt;
font-family:Times;mso-bidi-font-family:Times">High Level Forth Words<o:p></o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Following are the eForth
words defined as high level colon definitions.<span style="mso-spacerun:yes">&nbsp; </span>They are built from the primitive eForth
words and other high level eForth words, including data structures and control
structures.<span style="mso-spacerun:yes">&nbsp; </span>Since eForth source is
coded in Microsoft MASM assembler, the word lists in the colon definitions are
constructed as data in MASM, using the DW directive.<span style="mso-spacerun:yes">&nbsp; </span>This form of representation, though very
effective, is very difficult to read.<span style="mso-spacerun:yes">&nbsp;
</span>The original model of eForth as provided by Bill Muench was in the form
of a Forth source listing.<span style="mso-spacerun:yes">&nbsp; </span>This
listing is much simpler and easy to read, assuming that the reader has some
knowledge of the Forth syntax.<span style="mso-spacerun:yes">&nbsp; </span>This
listing is also a very good source to learn a good coding style of Forth.<span style="mso-spacerun:yes">&nbsp; </span>I therefore think it is better to
present the high level Forth colon definitions in this form.<span style="mso-spacerun:yes">&nbsp; </span>As the 8086 eForth implementation
deviates slightly from the original Forth model, I tried to translate the 8086
implementation faithfully back to the Forth style for our discussion here.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">The sequence of words is
exactly the same as that in the MASM assembly source listing.<span style="mso-spacerun:yes">&nbsp; </span>The reader is encouraged to read the
MASM source listing along with the text in this book.<span style="mso-spacerun:yes">&nbsp; </span>Reading two descriptions of the same
subject often enable better comprehension and understanding.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Variables<span style="mso-spacerun:yes">&nbsp; </span>and User Variables<o:p></o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">The term user variable was
codified in earlier Forth systems on the mini-computers in which multitasking
was an integral part of the Forth operating system.<span style="mso-spacerun:yes">&nbsp; </span>In a multitasking system, many user
share CPU and other resources in the computing system.<span style="mso-spacerun:yes">&nbsp; </span>Each user has a private memory area to
store essential information about its own task so that the system can leave a
task temporarily to serve other users and return to this task continuing the
unfinished work.<span style="mso-spacerun:yes">&nbsp; </span>In a single user
environment, the user variables have the same functionality as system
variables.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">In eForth, all variables
used by the system are merged together and are implemented uniformly as user
variables.<span style="mso-spacerun:yes">&nbsp; </span>A special memory area in
the high memory is allocated for all these variables, and they are all
initialized by copying a table of initial values stored in the cold boot area.<span style="mso-spacerun:yes">&nbsp; </span>A significant benefit of this scheme is
that it allows the eForth system to operate in ROM memory naturally.<span style="mso-spacerun:yes">&nbsp; </span>It is very convenient for embedded
system applications which preclude mass storage and file downloading.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">In an application, the
user can choose to implement variables in the forms of user variables or
regular variables when running in RAM memory.<span style="mso-spacerun:yes">&nbsp; </span>To run things in ROM, variables must be
defined as user variables.<span style="mso-spacerun:yes">&nbsp; </span>Although
eForth in the original model allows only a small number of user variable to be
defined in an application, the user area can be enlarged at will by changing a
few assembly constants and equates.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">In eForth only one
vocabulary is used.<span style="mso-spacerun:yes">&nbsp; </span>The name of
this vocabulary is FORTH.<span style="mso-spacerun:yes">&nbsp; </span>When
FORTH is executed, the address of the pointer to the top of the dictionary is
written into the first cell in the CONTEXT array. <span style="mso-spacerun:yes">&nbsp;</span>When the text interpreter searches the
dictionary for a words, it picks up the pointer in CONTEXT and follow the
thread through the name dictionary.<span style="mso-spacerun:yes">&nbsp;
</span>If the name dictionary is exhausted, the text interpreter will pick up
the next cell in the CONTEXT array and do the search.<span style="mso-spacerun:yes">&nbsp; </span>The first cell in CONTEXT array
containing a 0 stops the searching.<span style="mso-spacerun:yes">&nbsp;
</span>There are 8 cells in the CONTEXT array. Since the last cell must be
zero, eForth allows up to 8 context vocabularies to be searched.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">There are two empty cells
in the code field of FORTH.<span style="mso-spacerun:yes">&nbsp; </span>The
first cell stores the pointer to the last name field in the name
dictionary.<span style="mso-spacerun:yes">&nbsp; </span>The second field must
be a 0, which serves to terminate a vocabulary link when many vocabularies are
created.<span style="mso-spacerun:yes">&nbsp; </span>Vocabularies are useful in
reducing the number of words the text interpreter must search to locate a word,
and allowing related words to be grouped together as logic modules.<span style="mso-spacerun:yes">&nbsp; </span>Although the eForth itself only uses one
vocabulary, the mechanism is provided to define multiple vocabularies in large applications.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">The CONTEXT arrays is
designed as a vocabulary stack to implement the ONLY- ALSO concept of
vocabulary search order first<span style="mso-spacerun:yes">&nbsp;
</span>proposed by Bill Ragsdale in the Forth 83 Standard.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">CURRENT points to a
vocabulary thread to which new definitions are to be added.<span style="mso-spacerun:yes">&nbsp; </span><o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: doVAR ( -- a ) R&gt; ; </span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 144.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">VARIABLE UP<span style="mso-tab-count:1"> </span>( -- a, Pointer to the user area.)<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 144.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 144.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">: doUSER<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp; </span>( -- a, Run time routine for
user variables.)<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 144.0pt 216.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>R&gt; @ <span style="mso-tab-count:
4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
retrieve user area offset<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 144.0pt 216.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>UP @ + ; <span style="mso-tab-count:
3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\
add to user area base addr<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: doVOC ( -- ) R&gt; CONTEXT ! ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: FORTH ( -- ) doVOC [ 0 , 0 ,</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: doUSER ( -- a ) R&gt; @ UP @ + ; </span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">eForth provides many
functions in the vectored form to allow the behavior the these functions to be
changed dynamically at run time.<span style="mso-spacerun:yes">&nbsp; </span>A
vectored function stores a code address in a user variable. @EXECUTE is used to
execute the function, given the address of the user variable.<span style="mso-spacerun:yes">&nbsp; </span>Following is the list of user variables
defined in eForth:<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">SP0<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(
-- a, pointer to bottom of the data stack.)<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">RP0<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(
-- a, pointer to bottom of the return stack.)<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">'?KEY<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>( -- a,
execution vector of ?KEY.<span style="mso-spacerun:yes">&nbsp; </span>Default
to ?rx.)<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">'EMIT<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>( -- a,
execution vector of EMIT.<span style="mso-spacerun:yes">&nbsp; </span>Default
to tx!)<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">'EXPECT<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp; </span>( -- a, execution
vector of EXPECT.<span style="mso-spacerun:yes">&nbsp; </span>Default to
'accept'.)<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">'TAP<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>( --
a, execution vector of TAP.<span style="mso-spacerun:yes">&nbsp; </span>Defulat
the kTAP.)<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">'ECHO<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>( -- a, execution
vector of ECHO.<span style="mso-spacerun:yes">&nbsp; </span>Default to tx!.)<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">'PROMPT<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp; </span>( -- a, execution
vector of PROMPT.<span style="mso-spacerun:yes">&nbsp; </span>Default to
'.ok'.)<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">BASE<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>( --
a,.radix base for numeric I/O.<span style="mso-spacerun:yes">&nbsp;
</span>Default to 10.)<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">tmp<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(
-- a, a temporary storage location used in parse and find.)<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">SPAN<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>( --
a, hold character count received by EXPECT.)<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">&gt;IN<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(
-- a, hold the character pointer while parsing input stream.)<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">#TIB<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>( --
a, hold the current count and address of the terminal input <span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>buffer.
Terminal Input Buffer used one cell after #TIB.)<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">CSP<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(
-- a, hold the stack pointer for error checking.)<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">'EVAL<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>( -- a,
execution vector of EVAL. Default to EVAL.)<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">'NUMBER<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp; </span>( -- a, address of
number conversion.<span style="mso-spacerun:yes">&nbsp; </span>Default to
NUMBER?.)<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">HLD<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(
-- a, hold a pointer in building a numeric output string.)<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">HANDLER<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp; </span>( -- a, hold the return
stack pointer for error handling.)<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">CONTEXT<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp; </span>( -- a, a area to
specify vocabulary search order.<span style="mso-spacerun:yes">&nbsp;
</span>Default to <span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>FORTH.
Vocabulary stack, 8 cells follwing CONTEXT.)<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">CURRENT<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp; </span>( -- a, point to the
vocabulary to be extended.<span style="mso-spacerun:yes">&nbsp; </span>Default
to FORTH.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Vocabulary
link uses one cell after CURRENT.)<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">CP<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(
-- a, point to the top of the code dictionary.)<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">NP<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(
-- a, point to the bottom of the name dictionary.)<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">LAST<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>( --
a, point to the last name in the name dictionary.)<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Common
Functions</span></b><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:
Times"><o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">This group of Forth words
are commonly used in writing Forth applications.<span style="mso-spacerun:yes">&nbsp; </span>They are coded in high level to enhance
the portability of eForth.<span style="mso-spacerun:yes">&nbsp; </span>In most
Forth implementations, they are coded in machine language to increase the
execute speed.<span style="mso-spacerun:yes">&nbsp; </span>After an eForth
system is ported to a new CPU, this word set should be recoded in assembly to
improve the run time performance of the system.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">?DUP, ROT, 2DROP,<span style="mso-spacerun:yes">&nbsp; </span>and 2DUP are stack operators
supplementing the four classic stack operators DUP, SWAP, OVER and DROP. <o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">ROT is unique in that it
accesses the third item on the data stack.<span style="mso-spacerun:yes">&nbsp;
</span>All other stack operators can only access one or two stack items.<span style="mso-spacerun:yes">&nbsp; </span>In Forth programming, it is generally
accepted that one should not try to access stack items deeper than the third
item.<span style="mso-spacerun:yes">&nbsp; </span>When you have to access
deeper into the data stack, it is a good time to re-evaluate your
algorithm.<span style="mso-spacerun:yes">&nbsp; </span>Most often, you can
avoid this situation by factoring your code into smaller parts which do not
reach so deep.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">+, - and D+ are simple
extensions from the primitive word UM+.<span style="mso-spacerun:yes">&nbsp;
</span>It is interesting to see how the more commonly used arithmetic operators
are derived.<span style="mso-spacerun:yes">&nbsp; </span>+ is UM+ with the
carry discarded.<span style="mso-spacerun:yes">&nbsp; </span>NOT returns the
ones compliment of a number, and NEGATE returns the two's compliment.<span style="mso-spacerun:yes">&nbsp; </span>Because UM+ preserves the carry, it can
be used to form multiple precision operators like D+.<span style="mso-spacerun:yes">&nbsp; </span>Later we will see how UM+ is used to do
multiplication and division.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: ?DUP ( w -- w w | 0 ) DUP IF DUP THEN ;</span></p>

<p class="zen"><span lang="EN-US">: ROT ( w1 w2 w3 -- w2 w3 w1 ) &gt;R SWAP R&gt;
SWAP ;</span></p>

<p class="zen"><span lang="EN-US">: 2DROP ( w w<span style="mso-spacerun:yes">&nbsp; </span>-- ) DROP DROP ;</span></p>

<p class="zen"><span lang="EN-US">: 2DUP ( w1 w2 -- w1 w2 w1 w2 ) OVER OVER ;</span></p>

<p class="zen"><span lang="EN-US">: + ( w w -- w ) UM+ DROP ;</span></p>

<p class="zen"><span lang="EN-US">: NOT ( w -- w ) -1 XOR ;</span></p>

<p class="zen"><span lang="EN-US">:<span style="mso-spacerun:yes">&nbsp;
</span>NEGATE ( n -- -n ) NOT 1 + ;</span></p>

<p class="zen"><span lang="EN-US">: DNEGATE ( d -- -d ) NOT &gt;R NOT 1 UM+ R&gt; +
;</span></p>

<p class="zen"><span lang="EN-US">: D+ ( d d -- d ) &gt;R SWAP &gt;R UM+ R&gt;
R&gt; + + ;</span></p>

<p class="zen"><span lang="EN-US">: - ( w w -- w ) NEGATE + ;</span></p>

<p class="zen"><span lang="EN-US">: ABS ( n -- +n ) DUP 0&lt; IF NEGATE THEN ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<b style="mso-bidi-font-weight:normal"><span lang="EN-US" style="font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:Times;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:Times;mso-ansi-language:EN-US;mso-fareast-language:ZH-TW;
mso-bidi-language:AR-SA;mso-no-proof:yes"><br clear="all" style="page-break-before:
always">
</span></b>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Comparison<o:p></o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">The primitive comparison
word in eForth is ?branch and 0&lt;.<span style="mso-spacerun:yes">&nbsp;
</span>However, ?branch is at such a low level that it can not be readily used
in high level Forth code.<span style="mso-spacerun:yes">&nbsp; </span>?branch
is secretly compiled into the high level Forth words by IF as an address
literal.<span style="mso-spacerun:yes">&nbsp; </span>For all intentions and
purposes, we can consider IF the equivalent of ?branch.<span style="mso-spacerun:yes">&nbsp; </span>When IF is encountered, the top item on
the data stack is considered a logic flag.<span style="mso-spacerun:yes">&nbsp;
</span>If it is true (non-zero), the execution continues until ELSE, then jump
to THEN, or to THEN directly if there is no ELSE clause.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">The following logic words
are constructed using the IF...ELSE...THEN structure with 0&lt; and XOR.<span style="mso-spacerun:yes">&nbsp; </span>XOR is used as 'not equal' operator,
because if the top two items on the data stack are not equal, the XOR operator
will return a non-zero number, which is considered to be 'true'.<span style="mso-spacerun:yes">&nbsp; </span><o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">U&lt; is used to compared
two unsigned numbers.<span style="mso-spacerun:yes">&nbsp; </span>This operator
is very important, especially in comparing addresses, as we assume that the
addresses are unsigned numbers pointing to unique memory locations.<span style="mso-spacerun:yes">&nbsp; </span>The arithmetic comparison operator &lt;
cannot be used to determine whether one address is higher or lower than the
other.<span style="mso-spacerun:yes">&nbsp; </span>Using &lt; for address
comparison had been the single cause of many failures in the annals of Forth.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">MAX retains the larger of
the top two items on the data stack.<span style="mso-spacerun:yes">&nbsp;
</span>Both numbers are assumed to be signed integers.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">MIN retains the smaller of
the top two items on the data stack.<span style="mso-spacerun:yes">&nbsp;
</span>Both numbers are assumed to be signed integers.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">WITHIN checks whether the
third item on the data stack is within the range as specified by the top two
numbers on the data stack.<span style="mso-spacerun:yes">&nbsp; </span>The
range is inclusive as to the lower limit and exclusive to the upper limit.<span style="mso-spacerun:yes">&nbsp; </span>If the third item is within range, a
true flag is returned on the data stack.<span style="mso-spacerun:yes">&nbsp;
</span>Otherwise, a false flag is returned.<span style="mso-spacerun:yes">&nbsp; </span>All numbers are assumed to be unsigned
integers.<span style="mso-spacerun:yes">&nbsp; </span><o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: = ( w w -- t ) XOR IF 0 EXIT THEN -1 ;</span></p>

<p class="zen"><span lang="EN-US">: U&lt; ( u u -- t ) 2DUP XOR 0&lt; IF SWAP DROP
0&lt; EXIT THEN - 0&lt; ;</span></p>

<p class="zen"><span lang="EN-US">:<span style="mso-spacerun:yes">&nbsp;
</span>&lt; ( n n -- t ) 2DUP XOR 0&lt; IF<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DROP 0&lt; EXIT
THEN - 0&lt; ;</span></p>

<p class="zen"><span lang="EN-US">: MAX ( n n -- n ) 2DUP<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt; IF SWAP
THEN DROP ;</span></p>

<p class="zen"><span lang="EN-US">: MIN ( n n -- n ) 2DUP SWAP &lt; IF SWAP THEN
DROP ;</span></p>

<p class="zen"><span lang="EN-US">: WITHIN ( u ul uh -- t ) \ ul &lt;= u &lt; uh</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>OVER
- &gt;R - R&gt; U&lt; ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><o:p>&nbsp;</o:p></span></p>

<b style="mso-bidi-font-weight:normal"><span lang="EN-US" style="font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:Times;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:Times;mso-ansi-language:EN-US;mso-fareast-language:ZH-TW;
mso-bidi-language:AR-SA;mso-no-proof:yes"><br clear="all" style="page-break-before:
always">
</span></b>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Divide
<o:p></o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">This group of words
provide a variety of multiplication and division functions.<span style="mso-spacerun:yes">&nbsp; </span>The most interesting feature of this
word set is that they are all based on the primitive UM+ operator in the
kernel. Building this word set in high level has the penalty that all math
operations will be slow.<span style="mso-spacerun:yes">&nbsp; </span>However,
since eForth needs these functions only in numeric I/O conversions, the
performance of eForth itself is not substantially affected by them.<span style="mso-spacerun:yes">&nbsp; </span>Nevertheless, if an application requires
lots of numeric computations, a few critical words in this word set should be
recoded in assembly.<span style="mso-spacerun:yes">&nbsp; </span>The primary
candidates for optimization are UM/MOD and UM*, because all other multiply and
divide operators are derived from these two words.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">UM/MOD and UM* are the
most complicated and comprehensive division and multiplication operators.<span style="mso-spacerun:yes">&nbsp; </span>Once they are coded, all other division
and multiplication operators can be derived easily.<span style="mso-spacerun:yes">&nbsp; </span>It has been a tradition in Forth coding
that one solves the most difficult problem first, and all other problems are
solved by themselves.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">UM/MOD divides an unsigned
double integer by an unsigned signal integer.<span style="mso-spacerun:yes">&nbsp; </span>It returns the unsigned remainder and
unsigned quotient on the data stack.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">M/MOD divides a signed
double integer by a signed signal integer.<span style="mso-spacerun:yes">&nbsp;
</span>It returns the signed remainder and signed quotient on the data
stack.<span style="mso-spacerun:yes">&nbsp; </span>The signed division is
floored towards negative infinity.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">/MOD divides a signed
single integer by a signed integer.<span style="mso-spacerun:yes">&nbsp;
</span>It returns the signed remainder and quotient.<span style="mso-spacerun:yes">&nbsp; </span>MOD is similar to /MOD, except that only
the signed remainder is returned.<span style="mso-spacerun:yes">&nbsp; </span>/
is also similar to /MOD, except that only the signed quotient is returned.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">In most advanced
microprocessors like 8086, all these division operations can be performed by
the CPU as native machine instructions.<span style="mso-spacerun:yes">&nbsp;
</span>The user can take advantage of these machine instructions by recoding
these Forth words in machine code.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: UM/MOD ( ud u -- ur uq )</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>2DUP
U&lt;</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>IF
NEGATE<span style="mso-spacerun:yes">&nbsp; </span>15</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;
</span>FOR &gt;R DUP UM+ &gt;R &gt;R DUP UM+ R&gt; + DUP</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>R&gt; R@ SWAP &gt;R UM+<span style="mso-spacerun:yes">&nbsp;
</span>R&gt; OR</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>IF &gt;R DROP 1
+ R&gt; ELSE DROP THEN R&gt;</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;
</span>NEXT DROP SWAP EXIT</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>THEN
DROP 2DROP<span style="mso-spacerun:yes">&nbsp; </span>-1 DUP ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: M/MOD ( d n -- r q ) \ floored division</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>DUP
0&lt;<span style="mso-spacerun:yes">&nbsp; </span>DUP &gt;R</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>IF
NEGATE &gt;R DNEGATE R&gt;</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>THEN
&gt;R DUP 0&lt; IF R@ + THEN R&gt; UM/MOD R&gt;</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>IF
SWAP NEGATE SWAP THEN ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: /MOD ( n n -- r q ) OVER 0&lt; SWAP M/MOD ;</span></p>

<p class="zen"><span lang="EN-US">: MOD ( n n -- r ) /MOD DROP ;</span></p>

<p class="zen"><span lang="EN-US">: / ( n n -- q ) /MOD SWAP DROP ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><o:p>&nbsp;</o:p></span></p>

<b style="mso-bidi-font-weight:normal"><span lang="EN-US" style="font-size:10.0pt;
font-family:Courier;mso-fareast-font-family:&quot;Times New Roman&quot;;mso-bidi-font-family:
&quot;Times New Roman&quot;;mso-ansi-language:EN-US;mso-fareast-language:ZH-TW;
mso-bidi-language:AR-SA;mso-no-proof:yes"><br clear="all" style="page-break-before:
always">
</span></b>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">Multiply <o:p></o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">UM* is the most
complicated multiplication operation.<span style="mso-spacerun:yes">&nbsp;
</span>Once it is coded, all other multiplication words can be derived from
it.<span style="mso-spacerun:yes">&nbsp; </span><o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">UM* multiplies two
unsigned single integers and returns the unsigned double integer product on the
data stack.<span style="mso-spacerun:yes">&nbsp; </span>M*<span style="mso-spacerun:yes">&nbsp; </span>multiplies two signed single integers
and returns the signed double integer product on the data stack.<span style="mso-spacerun:yes">&nbsp; </span>* multiplies two signed single integers
and returns the signed single integer product on the data stack.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Again, advanced CPU's
generally have these multiplication operations as native machine
instructions.<span style="mso-spacerun:yes">&nbsp; </span>The user should take
advantage of these resources to enhance the eForth system.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Forth is very close to the
machine language that it generally only handles integer numbers.<span style="mso-spacerun:yes">&nbsp; </span>There are floating point extensions on
many more sophisticated Forth systems, but they are more exceptions than
rules.<span style="mso-spacerun:yes">&nbsp; </span>The reason that Forth has
traditionally been an integer language is that integers are handled faster and
more efficiently in the computers, and most technical problems can be solved
satisfactorily using integers only.<span style="mso-spacerun:yes">&nbsp;
</span>A 16-bit integer has the dynamic range of 110 dB which is far more than
enough for most engineering problems.<span style="mso-spacerun:yes">&nbsp;
</span>The precision of a 16-bit integer representation is limited to one part
in 65535, which could be inadequate for small numbers.<span style="mso-spacerun:yes">&nbsp; </span>However, the precision can be greatly
improved by scaling; i.e., taking the ratio of two integers.<span style="mso-spacerun:yes">&nbsp; </span>It was demonstrated that pi, or any
other irrational numbers, can be represented accurately to 1 part in
100,000,000 by a ratio of two 16-bit integers.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">The scaling operators
*/MOD and */ are useful in scaling number n1 by the ratio of n2/n3.<span style="mso-spacerun:yes">&nbsp; </span>When n2 and n3 are properly chosen, the
scaling operation can preserve precision similar to the floating point
operations at a much higher speed.<span style="mso-spacerun:yes">&nbsp;
</span>Notice also that in these scaling operations, the intermediate product
of n1 and n2 is a double precision integer so that the precision of scaling is
maintained.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">*/MOD multiplies the
signed integers n1 and n2, and then divides the double integer product by
n3.<span style="mso-spacerun:yes">&nbsp; </span>It in fact is ratioing n1 by
n2/n3.<span style="mso-spacerun:yes">&nbsp; </span>It returns both the
remainder and the quotient.<span style="mso-spacerun:yes">&nbsp; </span>*/ is
similar to */MOD except that it only returns the quotient.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: UM* ( u u -- ud )</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>0
SWAP ( u1 0 u2 ) 15</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>FOR
DUP UM+ &gt;R &gt;R DUP UM+ R&gt; + R&gt;</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;
</span>IF &gt;R OVER UM+ R&gt; + THEN</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>NEXT
ROT DROP ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: * ( n n -- n ) UM* DROP ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: M* ( n n -- d )</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>2DUP
XOR 0&lt; &gt;R<span style="mso-spacerun:yes">&nbsp; </span>ABS SWAP ABS
UM*<span style="mso-spacerun:yes">&nbsp; </span>R&gt; IF DNEGATE THEN ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: */MOD ( n n n -- r q ) &gt;R M* R&gt; M/MOD ;</span></p>

<p class="zen"><span lang="EN-US">: */ ( n n n -- q ) */MOD SWAP DROP ;</span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<b style="mso-bidi-font-weight:normal"><span lang="EN-US" style="font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:Times;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:Times;mso-ansi-language:EN-US;mso-fareast-language:ZH-TW;
mso-bidi-language:AR-SA;mso-no-proof:yes"><br clear="all" style="page-break-before:
always">
</span></b>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Memory<span style="mso-spacerun:yes">&nbsp; </span>Alignment </span></b><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">The most serious problem
in porting system from one computer to another is that different computers have
different sizes for their addresses and data.<span style="mso-spacerun:yes">&nbsp; </span>We generally classify computers as 8,
16, 32, ... , bit machines, because they operate on data of these various
sizes.<span style="mso-spacerun:yes">&nbsp; </span>It is thus difficult to port
a single programming model as eForth to all these computers.<span style="mso-spacerun:yes">&nbsp; </span>In eForth, a set of memory alignment
words helps to make it easier to port the eForth model to different machines.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">We assume that the target
computer can address it memory in 8 bit chunks (bytes).<span style="mso-spacerun:yes">&nbsp; </span>The natural width of data best handled
by the computer is thus a multiple of bytes.<span style="mso-spacerun:yes">&nbsp;&nbsp; </span>A unit of such data is a
cell.<span style="mso-spacerun:yes">&nbsp; </span>An 16 bit machine handles
data in 2 byte cells, and a 32 bit machine handles data in 4 byte cells.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">CELL+ increments the
memory address by the cell size in bytes, and CELL- decrements the memory
address by the cell size.<span style="mso-spacerun:yes">&nbsp; </span>CELLS
multiplies the cell number on the stack by the cell size in bytes.<span style="mso-spacerun:yes">&nbsp; </span>These words are very useful in
converting a cell offset into a byte offset, in order to access integers in a
data array.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">ALIGNED converts an
address on the stack to the next cell boundary, to help accessing memory by
cells.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">The blank character (ASCII
32) is special in eForth because it is the most often used character to delimit
words in the input stream and the most often used character to format the
output strings.<span style="mso-spacerun:yes">&nbsp; </span>It is used so often
that it is advantageous to define an unique word for it.<span style="mso-spacerun:yes">&nbsp; </span>BL simply returns the number 32 on the
data stack.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">&gt;CHAR is very important
in converting a non-printable character to a harmless 'underscare'
character(ASCII 95).<span style="mso-spacerun:yes">&nbsp; </span>As eForth is
designed to communicate with a host computer through the serial I/O device, it
is important that eForth will not emit control characters to the host and
causes unexpected behavior on the host computer.<span style="mso-spacerun:yes">&nbsp; </span>&gt;CHAR thus filters the characters
before they are sent out by EMIT.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">DEPTH returns the number
of items currently on the data stack to the top of the stack.<span style="mso-spacerun:yes">&nbsp; </span>PICK takes a number<span style="mso-spacerun:yes">&nbsp; </span>n<span style="mso-spacerun:yes">&nbsp;
</span>off the data stack and replaces it with the n'th item on the data
stack.<span style="mso-spacerun:yes">&nbsp; </span>The number<span style="mso-spacerun:yes">&nbsp; </span>n<span style="mso-spacerun:yes">&nbsp;
</span>is 0-based; i.e., the top item is number 0,<span style="mso-spacerun:yes">&nbsp; </span>the next item is number 1, etc.<span style="mso-spacerun:yes">&nbsp; </span>Therefore, 0 PICK is equivalent to DUP,
and 1 PICK is<span style="mso-spacerun:yes">&nbsp; </span>equivalent to OVER.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: CELL- ( a -- a ) -2 + ;</span></p>

<p class="zen"><span lang="EN-US">: CELL+ ( a -- a )<span style="mso-spacerun:yes">&nbsp; </span>2 + ;</span></p>

<p class="zen"><span lang="EN-US">: CELLS ( n -- n )<span style="mso-spacerun:yes">&nbsp; </span>2 * ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: ALIGNED ( b -- a )</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>DUP
0 2 UM/MOD DROP DUP</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>IF 2
SWAP - THEN + ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: BL ( -- 32 ) 32 ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: &gt;CHAR ( c -- c )</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>$7F AND
DUP 127 BL WITHIN IF DROP 95 THEN ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: DEPTH ( -- n ) SP@ SP0 @ SWAP - 2 / ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: PICK ( +n -- w ) 1 + CELLS SP@ + @ ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 252.0pt"><b style="mso-bidi-font-weight:normal"><span lang="EN-US" style="font-family:Times;
mso-bidi-font-family:Times">Memory Access<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 252.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Here are three useful
memory operators.<span style="mso-spacerun:yes">&nbsp; </span>+! increments the
contents of a memory location by an integer on the stack.<span style="mso-spacerun:yes">&nbsp; </span>2! and 2@ store and fetch double
integers to and from memory.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">There are three buffer
areas used often in the eForth system.<span style="mso-spacerun:yes">&nbsp;
</span>HERE returns the address of the first free location above the code
dictionary, where new words are compiled.<span style="mso-spacerun:yes">&nbsp;
</span>PAD returns the address of the text buffer where numbers are constructed
and text strings are stored temporarily.<span style="mso-spacerun:yes">&nbsp;
</span>TIB is the terminal input buffer where input text string is held.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">@EXECUTE is a special word
supporting the vectored execution words in eForth.<span style="mso-spacerun:yes">&nbsp; </span>It takes the word address stored in a
memory location and executes the word.<span style="mso-spacerun:yes">&nbsp;
</span>It is used extensively to execute the vectored words in the user area.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">A memory array is
generally specified by a starting address and its length in bytes.<span style="mso-spacerun:yes">&nbsp; </span>In a string, the first byte is a count
byte, specifying the number of bytes in the following string.<span style="mso-spacerun:yes">&nbsp; </span>This is called a counted string.<span style="mso-spacerun:yes">&nbsp; </span>String literals in the colon definitions
and the name strings in the name dictionary are all represented by counted
strings.<span style="mso-spacerun:yes">&nbsp; </span>Following are special words
which handles memory arrays and strings.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">COUNT converts a string
array address to the address-length representation of a counted string.<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp; </span>CMOVE copies a memory array
from one location to another.<span style="mso-spacerun:yes">&nbsp; </span>FILL
fills a memory array with the same byte.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Arrays and strings are
generally specified by the address of the first byte in the array or string,
and the byte length.<span style="mso-spacerun:yes">&nbsp; </span>This
specification of course is the consequence that the memory is byte addressable.<span style="mso-spacerun:yes">&nbsp; </span>In a CPU which address memory in cells,
these words must be defined in terms of an artificial byte space.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><span style="mso-spacerun:yes">&nbsp;&nbsp; </span><o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">-TRAILING removes the
trailing white space characters from the end of a string. White space
characters include all the non-printable characters below ASCII 32. This word
allows eForth to process text lines in files downloaded from a host
computer.<span style="mso-spacerun:yes">&nbsp; </span>It conveniently
eliminates carriage-returns, life-feeds, tabs and spaces at the end of the text
lines.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">PACK$ is an important
string handling word used by the text interpreter.<span style="mso-spacerun:yes">&nbsp; </span>It copies a text string from on location
to another.<span style="mso-spacerun:yes">&nbsp; </span>In the target
area,<span style="mso-spacerun:yes">&nbsp; </span>the string is converted to a
counted string by adding a count byte before the text of the string.<span style="mso-spacerun:yes">&nbsp; </span>This word is used to build the name
field of a new word at the bottom of the name dictionary.<span style="mso-spacerun:yes">&nbsp; </span>PACK$ is designed so that it can pack
bytes into cells in a cell addressable machine.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">A cheap way to implement
eForth on a cell addressable machine is to equate cell addresses to byte
addresses, and to store one byte in a cell.<span style="mso-spacerun:yes">&nbsp; </span>This scheme is workable, but very inefficient
in the memory utilization.<span style="mso-spacerun:yes">&nbsp; </span>PACK$ is
a tool which helps the implementor to bridge the gap.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: +! ( n a -- ) SWAP OVER @ + SWAP ! ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: 2! ( d a -- ) SWAP OVER ! CELL+ ! ;</span></p>

<p class="zen"><span lang="EN-US">: 2@ ( a -- d ) DUP CELL+ @ SWAP @ ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: COUNT ( b -- b +n ) DUP 1 + SWAP C@ ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: HERE ( -- a ) CP @ ;</span></p>

<p class="zen"><span lang="EN-US">: PAD ( -- a ) HERE 80 + ;</span></p>

<p class="zen"><span lang="EN-US">: TIB ( -- a ) #TIB CELL+ @ ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: @EXECUTE ( a -- ) @ ?DUP IF EXECUTE THEN ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: CMOVE ( b b u -- )</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>FOR
AFT &gt;R DUP C@ R@ C! 1 + R&gt; 1 + THEN NEXT 2DROP ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: FILL ( b u c -- )</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>SWAP
FOR SWAP AFT 2DUP C! 1 + THEN NEXT 2DROP ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: -TRAILING ( b u -- b u )</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>FOR
AFT BL OVER R@ + C@ &lt;</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;
</span>IF R&gt; 1 + EXIT THEN THEN</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>NEXT
0 ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: PACK$ ( b u a -- a ) \ null fill</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;
</span>ALIGNED<span style="mso-spacerun:yes">&nbsp; </span>DUP &gt;R OVER</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>DUP
0 2 UM/MOD DROP</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>-
OVER +<span style="mso-spacerun:yes">&nbsp; </span>0 SWAP !<span style="mso-spacerun:yes">&nbsp; </span>2DUP C!<span style="mso-spacerun:yes">&nbsp; </span>1 + SWAP CMOVE<span style="mso-spacerun:yes">&nbsp; </span>R&gt; ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<span lang="EN-US" style="font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:
Times;mso-fareast-font-family:&quot;Times New Roman&quot;;mso-bidi-font-family:Times;
mso-ansi-language:EN-US;mso-fareast-language:ZH-TW;mso-bidi-language:AR-SA;
mso-no-proof:yes"><br clear="all" style="page-break-before:always">
</span>

<p class="MsoNormal" align="center" style="margin-right:-36.0pt;text-align:center"><b style="mso-bidi-font-weight:normal"><span lang="EN-US" style="font-size:18.0pt;
font-family:Times;mso-bidi-font-family:Times">Text Interpreter<o:p></o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">The text interpreter is
also called the outer interpreter in Forth.<span style="mso-spacerun:yes">&nbsp; </span>It is functionally equivalent to an
operating system in a conventional computer.<span style="mso-spacerun:yes">&nbsp; </span>It accepts command similar to English
entered by a user, and carries out the tasks specified by the commands.<span style="mso-spacerun:yes">&nbsp; </span>As an operating system, the text
interpreter must be complicated, because of all the things it has to do.<span style="mso-spacerun:yes">&nbsp; </span>However, because Forth employs very
simple syntax rules, and has very simple internal structures, the Forth text
interpreter is much simpler that conventional operating systems.<span style="mso-spacerun:yes">&nbsp; </span>It is simple enough that we can discuss
it completely in a single chapter, admitted that this is a long chapter.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Let us summarize what a
text interpreter must do:<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Accept
text input from a terminal<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Parse
out commands from input text<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Search
dictionary<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Execute
commands<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Translate
numbers into binary<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Display
numbers in text form<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Handle
errors gracefully<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Forth allows us to build
and integrate these required functions gradually in modules.<span style="mso-spacerun:yes">&nbsp; </span>All the modules finally fall into their
places in the word QUIT, which is the text interpreter itself.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">You might want to look up
the code of QUIT first and see how the modules fit together.<span style="mso-spacerun:yes">&nbsp; </span>A good feeling about the big picture
will help you in the study of the smaller modules.<span style="mso-spacerun:yes">&nbsp; </span>Nevertheless, we will doggedly follow
the loading order of the source code, and hope that you will not get lost too
far in the progress.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<b style="mso-bidi-font-weight:normal"><span lang="EN-US" style="font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:Times;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:Times;mso-ansi-language:EN-US;mso-fareast-language:ZH-TW;
mso-bidi-language:AR-SA;mso-no-proof:yes"><br clear="all" style="page-break-before:
always">
</span></b>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Numeric
Output<o:p></o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Forth is interesting in
its special capabilities in handling numbers across the man-machine
interface.<span style="mso-spacerun:yes">&nbsp; </span>It recognizes that the
machine and the human prefer very different representations of numbers.<span style="mso-spacerun:yes">&nbsp; </span>The machine prefers the binary
representation, but the human prefers decimal Arabic digital
representations.<span style="mso-spacerun:yes">&nbsp; </span>However, depending
on circumstances, the human may want numbers to be represented in other
radices, like hexadecimal, octal, and sometimes binary.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Forth solves this problem
of internal (machine) versus external (human) number representations by
insisting that all numbers are represented in the binary form in the CPU and in
memory.<span style="mso-spacerun:yes">&nbsp; </span>Only when numbers are
imported or exported for human consumption are they converted to the external
ASCII representation.<span style="mso-spacerun:yes">&nbsp; </span>The radix of external
representation is controlled by the radix value stored in the user variable
BASE.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Since BASE is a user
variable, the user can select any reasonable radix for entering numbers<span style="mso-spacerun:yes">&nbsp; </span>into the computer and format ting
numbers to be shown to the user.<span style="mso-spacerun:yes">&nbsp; </span>Most
programming languages can handle a small set of radices, like decimal, octal,
hexadecimal and binary.<span style="mso-spacerun:yes">&nbsp; </span><o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">DIGIT converts an integer
to a digit.<span style="mso-spacerun:yes">&nbsp; </span>EXTRACT extracts the
least significan digit from a number n.<span style="mso-spacerun:yes">&nbsp;
</span>n is divided by the radix in BASE and returned on the stack.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">The output number string
is built below the PAD buffer.<span style="mso-spacerun:yes">&nbsp; </span>The
least significant digit is extracted from the integer on the top of the data
stack by dividing it by the current radix in BASE.<span style="mso-spacerun:yes">&nbsp; </span>The digit thus extracted are added to
the output string backwards from PAD to the low memory. The conversion is
terminated when the integer is divided to zero. The address and length of the
number string are made available by #&gt; for outputting.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">An output number
conversion is initiated by &lt;# and terminated by #&gt;.<span style="mso-spacerun:yes">&nbsp; </span>Between them, # converts one digit at a
time, #S converts all the digits, while HOLD and SIGN inserts special
characters into the string under construction.<span style="mso-spacerun:yes">&nbsp; </span>This set of words is very versatile and
can handle many different output formats.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: DIGIT ( u -- c ) 9 OVER &lt; 7 AND + 48 + ;</span></p>

<p class="zen"><span lang="EN-US">: EXTRACT ( n base -- n c ) 0 SWAP UM/MOD SWAP
DIGIT ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: &lt;# ( -- ) PAD HLD ! ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: HOLD ( c -- ) HLD @ 1 - DUP HLD ! C! ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: # ( u -- u ) BASE @ EXTRACT HOLD ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: #S ( u -- 0 ) BEGIN # DUP WHILE REPEAT ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: SIGN ( n -- ) 0&lt; IF 45 HOLD THEN ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: #&gt; ( w -- b u ) DROP HLD @ PAD OVER - ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: str ( n -- b u ) DUP &gt;R ABS &lt;# #S R&gt;
SIGN #&gt; ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: HEX ( -- ) 16 BASE ! ;</span></p>

<p class="zen"><span lang="EN-US">: DECIMAL ( -- ) 10 BASE ! ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></b></p>

<b style="mso-bidi-font-weight:normal"><span lang="EN-US" style="font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:Times;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:Times;mso-ansi-language:EN-US;mso-fareast-language:ZH-TW;
mso-bidi-language:AR-SA;mso-no-proof:yes"><br clear="all" style="page-break-before:
always">
</span></b>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Number
Output </span></b><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:
Times"><o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">With the number formatting
word set as shown above, one can format numbers for output in any form
desired.<span style="mso-spacerun:yes">&nbsp; </span>The free output format is
a number string preceded by a single space.<span style="mso-spacerun:yes">&nbsp; </span>The fix column format displays a number
right-justified in a column of pre-determined width.<span style="mso-spacerun:yes">&nbsp; </span>The words ., U., and ? use the free
format.<span style="mso-spacerun:yes">&nbsp; </span>The words .R and U.R use
the fix format.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 252.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">: str<span style="mso-tab-count:1"> </span>( n -- b u )<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>( Convert a signed integer to a
numeric string.)<o:p></o:p></span></p>

<p class="zen" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US"><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DUP
&gt;R <span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(
save a copy for sign)</span></p>

<p class="zen" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US"><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ABS
<span style="mso-tab-count:3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(
use absolute of n)</span></p>

<p class="zen" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US"><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;#
#S <span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(
convert all digits)<span style="mso-tab-count:1">&nbsp;&nbsp; </span></span></p>

<p class="zen" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US"><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>R&gt;
SIGN <span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(
add sign from n)</span></p>

<p class="zen" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US"><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>#&gt;
;<span style="mso-tab-count:3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(
return number string addr and length)</span></p>

<p class="zen" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">: HEX<span style="mso-tab-count:1"> </span>( -- )<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>( Use radix 16 as base for numeric
conversions.)<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>16 BASE ! ;<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">: DECIMAL<span style="mso-tab-count:1">&nbsp;&nbsp; </span>( -- )<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>( Use radix 10 as base for numeric
conversions.)<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>10 BASE ! ;<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">: .R<span style="mso-tab-count:1">&nbsp; </span>( n +n -- )<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>( Display an integer in a field of n columns,
right justified.)<o:p></o:p></span></p>

<p class="zen" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US"><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&gt;R
str<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(
convert n to a number string)</span></p>

<p class="zen" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US"><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>R&gt;
OVER - SPACES <span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(
print leading spaces)</span></p>

<p class="zen" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US"><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>TYPE
;<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(
print number in +n column format)</span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">: U.R<span style="mso-tab-count:1"> </span>( u +n -- )<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>( Display an unsigned integer in n
column, right justified.)<o:p></o:p></span></p>

<p class="zen" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US"><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&gt;R
<span style="mso-tab-count:3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(
save column number)</span></p>

<p class="zen" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US"><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;#
#S #&gt; R&gt; <span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(
convert unsigned number)</span></p>

<p class="zen" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US"><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>OVER
- SPACES <span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(
print leading spaces)</span></p>

<p class="zen" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US"><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>TYPE
;<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(
print number in +n columns)</span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">: U.<span style="mso-tab-count:1">&nbsp; </span>( u -- )<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>( Display an unsigned integer in free
format.)<o:p></o:p></span></p>

<p class="zen" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US"><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;#
#S #&gt; <span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(
convert unsigned number)</span></p>

<p class="zen" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US"><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>SPACE
<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(
print one leading space)</span></p>

<p class="zen" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US"><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>TYPE
;<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(
print number)</span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">: .<span style="mso-tab-count:1">&nbsp;&nbsp; </span>( w -- )<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>( Display an integer in free format,
preceeded by a space.)<o:p></o:p></span></p>

<p class="zen" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US"><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>BASE
@ 10 XOR <span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(
if not in decimal mode)</span></p>

<p class="zen" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US"><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>IF
U. EXIT THEN <span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(
print unsigned number)</span></p>

<p class="zen" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US"><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>str
SPACE TYPE ;<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(
print signed number if decimal)</span></p>

<p class="zen" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">: ?<span style="mso-tab-count:1">&nbsp;&nbsp; </span>( a -- )<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>( Display the contents in a memory
cell.)<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>@ . ;<span style="mso-tab-count:3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(
very simple but useful command)<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><o:p>&nbsp;</o:p></span></p>

<b style="mso-bidi-font-weight:normal"><span lang="EN-US" style="font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:Times;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:Times;mso-ansi-language:EN-US;mso-fareast-language:ZH-TW;
mso-bidi-language:AR-SA;mso-no-proof:yes"><br clear="all" style="page-break-before:
always">
</span></b>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Numeric
Input<o:p></o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">The Forth text interpreter
also handles the number input to the system.<span style="mso-spacerun:yes">&nbsp; </span>It parses words out of the input stream
and try to execute the words in sequence.<span style="mso-spacerun:yes">&nbsp;
</span>When the text interpreter encounters a word which is not the name of a
word in the dictionary, it then assumes that the word must be a number and
attempts to convert the ASCII string to a number according to the current
radix.<span style="mso-spacerun:yes">&nbsp; </span>When the text interpreter
succeeds in converting the string to a number, the number is pushed on the data
stack for future use if the text interpreter is in the interpreting mode.<span style="mso-spacerun:yes">&nbsp; </span>If it is in the compiling mode, the text
interpreter will compile the number to the code dictionary as an integer
literal so that when the word under construction is later executed, this
literal integer will be pushed on the data stack.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">If the text interpreter
fails to convert the word to a number, there is an error condition which will
cause the text interpreter to abort, posting an error message to the user, and
then wait for the user's next line of commands.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Only two words are needed
in eForth to handle input of single precision integer numbers.<span style="mso-spacerun:yes">&nbsp; </span><o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">DIGIT? converts a digit to
its numeric value according to the current base, and NUMBER? converts a number
string to a single integer.<span style="mso-spacerun:yes">&nbsp; </span>NUMBER?
is vectored through 'NUMBER to convert numbers.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">NUMBER? converts a string
of digits to a single integer.<span style="mso-spacerun:yes">&nbsp; </span>If
the first character is a $ sign, the number is assumed to be in
hexadecimal.<span style="mso-spacerun:yes">&nbsp; </span>Otherwise, the number
will be converted using the radix value stored in BASE.<span style="mso-spacerun:yes">&nbsp; </span>For negative numbers, the first
character should be a - sign.<span style="mso-spacerun:yes">&nbsp; </span>No
other characters are allowed in the string.<span style="mso-spacerun:yes">&nbsp; </span>If a non-digit character is encountered,
the address of the string and a false flag are returned.<span style="mso-spacerun:yes">&nbsp; </span>Successful conversion returns the
integer value and a true flag.<span style="mso-spacerun:yes">&nbsp; </span>If
the number is larger than 2**n, where n is the bit width of the single integer,
only the modulus to 2**n will be kept.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: DIGIT? ( c base -- u t )</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;
</span>&gt;R 48 - 9 OVER &lt;</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>IF 7
- DUP 10 &lt; OR THEN DUP R&gt; U&lt; ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: NUMBER? ( a -- n T | a F )</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>BASE
@ &gt;R<span style="mso-spacerun:yes">&nbsp; </span>0 OVER COUNT ( a 0 b n)</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>OVER
C@ 36 =</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>IF
HEX SWAP 1 + SWAP 1 - THEN ( a 0 b' n')</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>OVER
C@ 45 = &gt;R ( a 0 b n)</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>SWAP
R@ - SWAP R@ + ( a 0 b" n") ?DUP</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>IF 1
- ( a 0 b n)</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;
</span>FOR DUP &gt;R C@ BASE @ DIGIT?</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>WHILE SWAP BASE
@ * +<span style="mso-spacerun:yes">&nbsp; </span>R&gt; 1 +</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;
</span>NEXT DROP R@ ( b ?sign) IF NEGATE THEN SWAP</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ELSE R&gt; R&gt;
( b index) 2DROP ( digit number) 2DROP 0</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>THEN DUP</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>THEN
R&gt; ( n ?sign) 2DROP R&gt; BASE ! ;</span></p>

<p class="eForth"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<b style="mso-bidi-font-weight:normal"><span lang="EN-US" style="font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:Times;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:Times;mso-ansi-language:EN-US;mso-fareast-language:ZH-TW;
mso-bidi-language:AR-SA;mso-no-proof:yes"><br clear="all" style="page-break-before:
always">
</span></b>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Basic
I/O <o:p></o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">The eForth system assumes
that the system will communicate with its environment only through a serial I/O
interface.<span style="mso-spacerun:yes">&nbsp; </span>To support the serial
I/O, only three words are needed:<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">?KEY returns a false flag
if no character is pending on the receiver. If a character is received, the
character and a true flag are returned.<span style="mso-spacerun:yes">&nbsp;
</span>This word is more powerful than that usually defined in most Forth
systems because it consolidate the functionality of KEY into ?KEY.<span style="mso-spacerun:yes">&nbsp; </span>It simplifies the coding of the machine
dependent I/O interface.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">KEY will execute ?KEY
continually until a valid character is received and the character is
returned.<span style="mso-spacerun:yes">&nbsp; </span>EMIT sends a character
out throughout the transmit line.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">?KEY and EMIT are vectored
through '?KEY and 'EMIT, so that their function can be changed dynamically at
run time.<span style="mso-spacerun:yes">&nbsp; </span>Normally ?KEY executes
?RX and EMIT executes TX!.<span style="mso-spacerun:yes">&nbsp; </span>?RX and
TX! are machine dependent kernel words.<span style="mso-spacerun:yes">&nbsp;
</span>Vectoring the I/O words allows the eForth system to changes its I/O
channels dynamically and still uses all the existing tools to handle input and
output transactions.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">All I/O words are derived
from ?KEY, KEY and EMIT.<span style="mso-spacerun:yes">&nbsp; </span>The
following set defined in eForth is particularly useful in normal programming:<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">SPACE outputs a blank
space character.<span style="mso-spacerun:yes">&nbsp; </span>SPACES output n
blank space characters.<span style="mso-spacerun:yes">&nbsp; </span>CR outputs
a carriage-return and a line-feed.<span style="mso-spacerun:yes">&nbsp;
</span>PACE outputs an ASCII 11 character to acknowledge lines received during
file downloading.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">NUF? returns a false flag
if no character is pending in the input buffer.<span style="mso-spacerun:yes">&nbsp; </span>After receiving a character, pause and
wait for another character.<span style="mso-spacerun:yes">&nbsp; </span>If this
character is CR, return a true flag; otherwise, return false.<span style="mso-spacerun:yes">&nbsp; </span>This word is very useful in user
interruptable routines.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">TYPE outputs n characters
from a string in memory.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">With the number formatting
word set as shown above, one can format numbers for output in any form
desired.<span style="mso-spacerun:yes">&nbsp; </span>The free output format is
a number string preceded by a single space.<span style="mso-spacerun:yes">&nbsp; </span>The fix column format displays a number
right-justified in a column of pre-determined width.<span style="mso-spacerun:yes">&nbsp; </span>The words ., U., and ? use the free
format.<span style="mso-spacerun:yes">&nbsp; </span>The words .R and U.R use
the fix format.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 252.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">String literals are data
structures compiled in colon definitions, in-line with the words.<span style="mso-spacerun:yes">&nbsp; </span>A string literal must start with a
string word which knows how to handle the following string at the run
time.<span style="mso-spacerun:yes">&nbsp; </span>Let us show two examples of
the string literals:<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">: xxx<span style="mso-spacerun:yes">&nbsp; </span><span style="mso-tab-count:1">&nbsp; </span>...<span style="mso-spacerun:yes">&nbsp;&nbsp; </span>" A compiled
string"<span style="mso-spacerun:yes">&nbsp; </span>...<span style="mso-spacerun:yes">&nbsp;&nbsp; </span>;<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">: yyy<span style="mso-spacerun:yes">&nbsp; </span><span style="mso-tab-count:1">&nbsp; </span>...<span style="mso-spacerun:yes">&nbsp;&nbsp; </span>." An output
string"<span style="mso-spacerun:yes">&nbsp; </span>...<span style="mso-spacerun:yes">&nbsp;&nbsp; </span>;<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">In xxx, "<span style="mso-spacerun:yes">&nbsp; </span>is an immediate word which compiles the
following string as a string literal preceded by a special word $"|.<span style="mso-spacerun:yes">&nbsp; </span>When $"| is executed at the run
time, it returns the address of this string on the data stack.<span style="mso-spacerun:yes">&nbsp; </span>In yyy,<span style="mso-spacerun:yes">&nbsp; </span>." compiles a string literal
preceded by another word ."|, which prints the compiled string to the
output device.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;mso-pagination:widow-orphan lines-together;
page-break-after:avoid"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:
Times">Both $"| and ."| use the word do$, which retrieve the address
of a string stored as the second item on the return stack.<span style="mso-spacerun:yes">&nbsp; </span>do$ is a bit difficult to understand,
because the starting address of the following string is the second item on the
return stack.<span style="mso-spacerun:yes">&nbsp; </span>This address is
pushed on the data stack so that the string can be accessed.<span style="mso-spacerun:yes">&nbsp; </span>This address must be changed so that the
address interpreter will return to the word right after the compiled
string.<span style="mso-spacerun:yes">&nbsp; </span>This address will allow the
address interpreter to skip over the string literal and continue to execute the
word list as intended.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: ?KEY ( -- c T | F ) '?KEY @EXECUTE ;</span></p>

<p class="zen"><span lang="EN-US">: KEY ( -- c ) BEGIN ?KEY UNTIL ;<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp; </span></span></p>

<p class="zen"><span lang="EN-US">: EMIT ( c -- ) 'EMIT @EXECUTE ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: NUF? ( -- f ) ?KEY DUP IF 2DROP KEY 13 = THEN ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">:<span style="mso-spacerun:yes">&nbsp;
</span>PACE ( -- ) 11 EMIT ;</span></p>

<p class="zen"><span lang="EN-US">: SPACE ( -- ) BL EMIT ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: CHARS ( +n c -- ) \ ???ANS conflict</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>SWAP
0 MAX FOR AFT DUP EMIT THEN NEXT DROP ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: SPACES ( +n -- ) BL CHARS ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: TYPE ( b u -- ) FOR AFT DUP C@ EMIT 1 + THEN
NEXT DROP ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: CR ( -- ) 13 EMIT 10 EMIT ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: do$ ( -- a )</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;
</span>R&gt; R@ R&gt; COUNT + ALIGNED &gt;R SWAP &gt;R ; </span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: $"| ( -- a ) do$ ; </span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: ."| ( -- ) do$ COUNT TYPE ; COMPILE-ONLY</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">:<span style="mso-spacerun:yes">&nbsp; </span>.R
( n +n -- ) &gt;R str<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>R&gt; OVER -
SPACES TYPE ;</span></p>

<p class="zen"><span lang="EN-US">: U.R ( u +n -- ) &gt;R &lt;# #S #&gt; R&gt; OVER
- SPACES TYPE ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: U. ( u -- ) &lt;# #S #&gt; SPACE TYPE ;</span></p>

<p class="zen"><span lang="EN-US">:<span style="mso-spacerun:yes">&nbsp; </span>. (
n -- ) BASE @ 10 XOR IF U. EXIT THEN str SPACE TYPE ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: ? ( a -- ) @ . ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<b style="mso-bidi-font-weight:normal"><span lang="EN-US" style="font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:Times;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:Times;mso-ansi-language:EN-US;mso-fareast-language:ZH-TW;
mso-bidi-language:AR-SA;mso-no-proof:yes"><br clear="all" style="page-break-before:
always">
</span></b>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Parsing
<o:p></o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Parsing is always thought
of as a very advanced topic in computer sciences.<span style="mso-spacerun:yes">&nbsp; </span>However, because Forth uses very simple
syntax rules, parsing is easy.<span style="mso-spacerun:yes">&nbsp; </span>Forth
source code consists of words, which are ASCII strings separated by spaces and
other white space characters like tabs, carriage returns, and line feeds.<span style="mso-spacerun:yes">&nbsp; </span>The text interpreter scans the source
code, isolates words and interprets them in sequence.<span style="mso-spacerun:yes">&nbsp; </span>After a word is parsed out of the input
text stream, the text interpreter will 'interpret' it--execute it if it is a
word, compile it if the text interpreter is in the compiling mode, and convert
it to a number if the word is not a Forth word.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">PARSE scans the source
string in the terminal input buffer from where &gt;IN points to till the end of
the buffer, for a word delimited by character c.<span style="mso-spacerun:yes">&nbsp; </span>It returns the address and length of the
word parsed out.<span style="mso-spacerun:yes">&nbsp; </span>PARSE calls
'parse' to do the detailed works.<span style="mso-spacerun:yes">&nbsp;
</span>PARSE is used to implement many specialized parsing words to perform
different source code handling functions.<span style="mso-spacerun:yes">&nbsp;
</span>These words, including (, \, CHAR, WORD, and WORD are discussed in the
next section.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US">'</span><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">parse'<span style="mso-spacerun:yes">&nbsp; </span>( b1 u1 c -- b2 u2 n )<span style="mso-spacerun:yes">&nbsp; </span>is the elementary command to do text parsing.<span style="mso-spacerun:yes">&nbsp; </span>From the source string starting at b1
and of u1 characters long, parse out the first word delimited by character
c.<span style="mso-spacerun:yes">&nbsp; </span>Return the address b2 and length
u2 of the word just parsed out and the difference n between b1 and b2.<span style="mso-spacerun:yes">&nbsp; </span>Leading delimiters are skipped
over.<span style="mso-spacerun:yes">&nbsp; </span>'parse' is used by PARSE.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">.(<span style="mso-spacerun:yes">&nbsp; </span>types the following string till the next
).<span style="mso-spacerun:yes">&nbsp; </span>It is used to output text to the
terminal.<span style="mso-spacerun:yes">&nbsp; </span>(<span style="mso-spacerun:yes">&nbsp; </span>ignores the following string till the
next ).<span style="mso-spacerun:yes">&nbsp; </span>It is used to place
comments in source text.<span style="mso-spacerun:yes">&nbsp; </span>\<span style="mso-spacerun:yes">&nbsp; </span>ignores all characters till end of input
buffer.<span style="mso-spacerun:yes">&nbsp; </span>It is used to insert
comment lines in text.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="eForth" style="tab-stops:36.0pt 72.0pt 108.0pt 144.0pt 180.0pt 216.0pt 234.0pt 252.0pt 288.0pt 324.0pt 360.0pt 396.0pt 432.0pt 468.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">CHAR<span style="mso-spacerun:yes">&nbsp; </span>parses the next word but only return the
first character in this word.<span style="mso-spacerun:yes">&nbsp; </span>Get
an ASCII character from the input stream.<span style="mso-spacerun:yes">&nbsp;
</span>WORD parses out the next word delimited by the ASCII character c.<span style="mso-spacerun:yes">&nbsp; </span>Copy the word to the top of the code
dictionary and return the address of this counted string. </span><span lang="EN-US" style="font-size:12.0pt;font-family:Times;mso-bidi-font-family:Times"><span style="mso-spacerun:yes">&nbsp;&nbsp;</span>WORD parses the next word from the
input buffer and copy the counted string to the top of the name
dictionary.<span style="mso-spacerun:yes">&nbsp; </span>Return the address of
this counted string.<span style="mso-spacerun:yes">&nbsp; </span><o:p></o:p></span></p>

<p class="eForth"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: parse ( b u c -- b u delta ; &lt;string&gt; )</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>tmp
!<span style="mso-spacerun:yes">&nbsp; </span>OVER &gt;R<span style="mso-spacerun:yes">&nbsp; </span>DUP \ b u u</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>IF 1
-<span style="mso-spacerun:yes">&nbsp; </span>tmp @ BL =</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;
</span>IF \ b u' \ 'skip'</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>FOR BL OVER C@ -
0&lt; NOT<span style="mso-spacerun:yes">&nbsp; </span>WHILE 1 +</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>NEXT ( b) R&gt;
DROP 0 DUP EXIT \ all delim</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>THEN<span style="mso-spacerun:yes">&nbsp; </span>R&gt;</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;
</span>THEN OVER SWAP \ b' b' u' \ 'scan'</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;
</span>FOR tmp @ OVER C@ -<span style="mso-spacerun:yes">&nbsp; </span>tmp @ BL
=</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>IF 0&lt; THEN
WHILE 1 +</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;
</span>NEXT DUP &gt;R<span style="mso-spacerun:yes">&nbsp; </span>ELSE R&gt;
DROP DUP 1 + &gt;R</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>THEN OVER -<span style="mso-spacerun:yes">&nbsp; </span>R&gt;<span style="mso-spacerun:yes">&nbsp; </span>R&gt; - EXIT</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>THEN
( b u) OVER R&gt; - ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: PARSE ( c -- b u ; &lt;string&gt; )</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;
</span>&gt;R<span style="mso-spacerun:yes">&nbsp; </span>TIB &gt;IN @ +<span style="mso-spacerun:yes">&nbsp; </span>#TIB @ &gt;IN @ -<span style="mso-spacerun:yes">&nbsp; </span>R&gt; parse &gt;IN +! ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: .( ( -- ) 41 PARSE TYPE ; IMMEDIATE</span></p>

<p class="zen"><span lang="EN-US">: ( ( -- )<span style="mso-spacerun:yes">&nbsp;
</span>41 PARSE 2DROP ; IMMEDIATE</span></p>

<p class="zen"><span lang="EN-US">: \ ( -- ) #TIB @ &gt;IN ! ; IMMEDIATE</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: CHAR ( -- c ) BL PARSE DROP C@ ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: TOKEN ( -- a ; &lt;string&gt; )</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>BL
PARSE 31 MIN NP @ OVER - CELL- PACK$ ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: WORD ( c -- a ; &lt;string&gt; ) PARSE HERE
PACK$ ;</span></p>

<p class="eForth"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times;
text-transform:uppercase"><o:p>&nbsp;</o:p></span></b></p>

<b style="mso-bidi-font-weight:normal"><span lang="EN-US" style="font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:Times;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:Times;text-transform:uppercase;mso-ansi-language:EN-US;
mso-fareast-language:ZH-TW;mso-bidi-language:AR-SA;mso-no-proof:yes"><br clear="all" style="page-break-before:always">
</span></b>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times;
text-transform:uppercase">D</span></b><b style="mso-bidi-font-weight:normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">ictionary
Search<o:p></o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">In eForth, headers of word
definitions are linked into a name dictionary which is separated from the code
dictionary.<span style="mso-spacerun:yes">&nbsp; </span>A header contains three
fields: a word field holding the code address of the word, a link field holding
the name field address of the previous header and a name field holding the name
as a counted string.<span style="mso-spacerun:yes">&nbsp; </span>The name
dictionary is a list linked through the link fields and the name fields. The
basic searching function is performed by the word 'find'.<span style="mso-spacerun:yes">&nbsp; </span>'find' follows the linked list of names
to find a name which matches a text string, and returns the address of the
executable word and the name field address, if a match is found.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">eForth allows multiple
vocabularies in the name dictionary.<span style="mso-spacerun:yes">&nbsp;
</span>A dictionary can be divided into a number of independently linked
sublists through some hashing mechanism.<span style="mso-spacerun:yes">&nbsp;
</span>A sublist is called a vocabulary.<span style="mso-spacerun:yes">&nbsp;
</span>Although eForth itself contains only one vocabulary, it has the
provision to build many vocabularies and allows many vocabularies to be
searched in a prioritized order.<span style="mso-spacerun:yes">&nbsp;
</span>The CONTEXT array in the user area has 8 cells and allows up to 8
vocabularies to be searched in sequence.<span style="mso-spacerun:yes">&nbsp;
</span>A null entry in the CONTEXT array terminates the vocabulary search.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">find ( a va -- ca na, a F)
<span style="mso-spacerun:yes">&nbsp;</span>A counted string at a is the name
of a word to be looked up in the dictionary. The last name field address of the
vocabulary is stored in location va. If the string is found, both the word
(code address) and the name field address are returned.<span style="mso-spacerun:yes">&nbsp; </span>If the string is not the name a word,
the string address and a false flag are returned.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">To located a word, one
could follow the linked list and compare the names of defined words to the
string to be searched.<span style="mso-spacerun:yes">&nbsp; </span>If the
string matches the name of a word in the name dictionary, the word and the
address of the name field are returned.<span style="mso-spacerun:yes">&nbsp;
</span>If the string is not a defined word, the search will lead to either a
null link or a null name field.<span style="mso-spacerun:yes">&nbsp; </span>In
either case, the search will be terminated and a false flag returned.<span style="mso-spacerun:yes">&nbsp; </span>The false flag thus indicates that the
word searched is not in this vocabulary.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">'find' runs through the
name dictionary very quickly because it first compares the length and the first
character in the name field as a cell.<span style="mso-spacerun:yes">&nbsp;
</span>In most cases of mismatch, this comparison would fail and the next name
can be reached through the link field.<span style="mso-spacerun:yes">&nbsp;
</span>If the first two characters match, then SAME? is invoked to compare the
rest of the name field, one cell at a time.<span style="mso-spacerun:yes">&nbsp; </span>Since both the target text string and
the name field are null filled to the cell boundary, the comparison can be
performed quickly across the entire name field without worrying about the end
conditions.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">NAME?<span style="mso-spacerun:yes">&nbsp; </span>( a -- ca na, a F)<span style="mso-spacerun:yes">&nbsp;&nbsp; </span>Search all the vocabularies in the
CONTEXT array for a name at address a.<span style="mso-spacerun:yes">&nbsp;
</span>Return the word and a name address if a matched word is found.<span style="mso-spacerun:yes">&nbsp; </span>Otherwise, return the string address and
a false flag.<span style="mso-spacerun:yes">&nbsp; </span>The CONTEXT array can
hold up to 8 vocabulary links.<span style="mso-spacerun:yes">&nbsp;
</span>However, a 0 which is not a valid vocabulary link in this array will
terminate the searching.<span style="mso-spacerun:yes">&nbsp; </span>Changing
the vocabulary links in this array and the order of these links will alter the
searching order and hence the searching priority among the vocabularies.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: NAME&gt; ( a -- xt ) CELL- CELL- @ ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: SAME? ( a a u -- a a f \ -0+ )</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>FOR
AFT OVER R@ CELLS + @</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>OVER R@ CELLS + @ -<span style="mso-spacerun:yes">&nbsp; </span>?DUP</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;
</span>IF R&gt; DROP EXIT THEN THEN</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>NEXT
0 ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: find ( a va -- xt na | a F )</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;
</span>SWAP<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>\ va a</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>DUP
C@ 2 / tmp !<span style="mso-spacerun:yes">&nbsp; </span>\ va a<span style="mso-spacerun:yes">&nbsp; </span>\ get cell count</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>DUP
@ &gt;R<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>\ va a<span style="mso-spacerun:yes">&nbsp; </span>\ count byte &amp;
1st char</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;
</span>CELL+ SWAP<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\ a'
va</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;
</span>BEGIN @ DUP<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\ a' na na</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;
</span>IF DUP @ [ =MASK ] LITERAL AND<span style="mso-spacerun:yes">&nbsp;
</span>R@ XOR \ ignore lexicon bits</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>IF CELL+ -1 ELSE
CELL+ tmp @ SAME? THEN</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;
</span>ELSE R&gt; DROP EXIT</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;
</span>THEN</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;
</span>WHILE CELL- CELL- \ a' la</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;
</span>REPEAT R&gt; DROP SWAP DROP CELL-<span style="mso-spacerun:yes">&nbsp;
</span>DUP NAME&gt; SWAP ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: NAME? ( a -- xt na | a F )</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;
</span>CONTEXT<span style="mso-spacerun:yes">&nbsp; </span>DUP 2@ XOR IF CELL-
THEN &gt;R \ context&lt;&gt;also</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;
</span>BEGIN R&gt;<span style="mso-spacerun:yes">&nbsp; </span>CELL+<span style="mso-spacerun:yes">&nbsp; </span>DUP &gt;R<span style="mso-spacerun:yes">&nbsp; </span>@<span style="mso-spacerun:yes">&nbsp;
</span>?DUP</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;
</span>WHILE find<span style="mso-spacerun:yes">&nbsp; </span>?DUP</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;
</span>UNTIL R&gt; DROP EXIT THEN R&gt; DROP<span style="mso-spacerun:yes">&nbsp; </span>0 ;</span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times;
text-transform:uppercase"><o:p>&nbsp;</o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></b></p>

<b style="mso-bidi-font-weight:normal"><span lang="EN-US" style="font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:Times;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:Times;mso-ansi-language:EN-US;mso-fareast-language:ZH-TW;
mso-bidi-language:AR-SA;mso-no-proof:yes"><br clear="all" style="page-break-before:
always">
</span></b>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Terminal
<o:p></o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">The text interpreter
interprets source text<span style="mso-spacerun:yes">&nbsp; </span>stored in
the terminal input buffer.<span style="mso-spacerun:yes">&nbsp; </span>To
process characters from the input device, we need three special words to deal
with backspaces and carriage return from the input device:<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">kTAP<span style="mso-spacerun:yes">&nbsp; </span>processes a character c received from
terminal.<span style="mso-spacerun:yes">&nbsp; </span>b1 is the starting address
of the input buffer.<span style="mso-spacerun:yes">&nbsp; </span>b2 is the end
of the input buffer. b3 is the currently available address in the input
buffer.<span style="mso-spacerun:yes">&nbsp; </span>c is normally stored into
b3, which is bumped by 1 and becomes b5.<span style="mso-spacerun:yes">&nbsp;
</span>In this case, b4 is the same as b2.<span style="mso-spacerun:yes">&nbsp;
</span>If c is a carriage-return, echo a space and make b4=b5=b3.<span style="mso-spacerun:yes">&nbsp; </span>If c is a back-space, erase the last
character and make b4=b2, b5=b3-1.<span style="mso-spacerun:yes">&nbsp;
</span>TAP<span style="mso-spacerun:yes">&nbsp; </span>echoes c to output
device, store c in b3, and bump b3.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">^H<span style="mso-spacerun:yes">&nbsp;&nbsp; </span>processes the back-space
character.<span style="mso-spacerun:yes">&nbsp; </span>Erase the last character
and decrement b3.<span style="mso-spacerun:yes">&nbsp; </span>If b3=b1, do
nothing because you cannot backup beyond the beginning of the input buffer.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">QUERY is the word which
accepts text input, up to 80 characters, from the input device and copies the
text characters to the terminal input buffer.<span style="mso-spacerun:yes">&nbsp; </span>It also prepares the terminal input
buffer for parsing by setting #TIB to the character count and clearing &gt;IN. <o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">EXPECT<span style="mso-spacerun:yes">&nbsp; </span>accepts u characters to a memory buffer
starting at b.<span style="mso-spacerun:yes">&nbsp; </span>The input is
terminated upon receiving a carriage-return.<span style="mso-spacerun:yes">&nbsp; </span>The number of characters actually
received is stored in SPAN.<span style="mso-spacerun:yes">&nbsp; </span>EXPECT
is called by QUERY to put characters into the terminal input buffer.<span style="mso-spacerun:yes">&nbsp; </span>However, EXPECT is useful by itself
because one can use it to place input text anywhere in the memory.<span style="mso-spacerun:yes">&nbsp; </span>QUERY and EXPECT are the two words most
useful in accepting text from the terminal.<span style="mso-spacerun:yes">&nbsp; </span><o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">'accept'<span style="mso-spacerun:yes">&nbsp; </span>accepts u1 characters to b.<span style="mso-spacerun:yes">&nbsp; </span>u2<span style="mso-spacerun:yes">&nbsp;
</span>returned is the actual count of characters received.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: ^H ( b b b -- b b b ) \ backspace</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;
</span>&gt;R OVER R&gt; SWAP OVER XOR</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;
</span>IF<span style="mso-spacerun:yes">&nbsp; </span>8 'ECHO @EXECUTE</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>32 'ECHO @EXECUTE \
distructive</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>8 'ECHO @EXECUTE \
backspace</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>THEN
;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: TAP ( bot eot cur c -- bot eot cur )</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>DUP
'ECHO @EXECUTE OVER C! 1 + ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: kTAP ( bot eot cur c -- bot eot cur )</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>DUP
13 XOR</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>IF 8
XOR IF BL TAP ELSE ^H THEN EXIT</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>THEN
DROP SWAP DROP DUP ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: accept ( b u -- b u )</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>OVER
+ OVER</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;
</span>BEGIN 2DUP XOR</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;
</span>WHILE<span style="mso-spacerun:yes">&nbsp; </span>KEY<span style="mso-spacerun:yes">&nbsp; </span>DUP BL -<span style="mso-spacerun:yes">&nbsp; </span>95 U&lt;</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;
</span>IF TAP ELSE 'TAP @EXECUTE THEN</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;
</span>REPEAT DROP<span style="mso-spacerun:yes">&nbsp; </span>OVER - ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: EXPECT ( b u -- ) 'EXPECT @EXECUTE SPAN ! DROP
;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: QUERY ( -- )</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>TIB
80 'EXPECT @EXECUTE #TIB !<span style="mso-spacerun:yes">&nbsp; </span>DROP 0
&gt;IN ! ;</span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="text" align="left" style="text-align:left;tab-stops:36.0pt 72.0pt 108.0pt 144.0pt 180.0pt 216.0pt 225.0pt 252.0pt 288.0pt 324.0pt 360.0pt 396.0pt 432.0pt 468.0pt"><b style="mso-bidi-font-weight:normal"><span lang="EN-US"><o:p>&nbsp;</o:p></span></b></p>

<p class="text" align="left" style="text-align:left;tab-stops:36.0pt 72.0pt 108.0pt 144.0pt 180.0pt 216.0pt 225.0pt 252.0pt 288.0pt 324.0pt 360.0pt 396.0pt 432.0pt 468.0pt"><b style="mso-bidi-font-weight:normal"><span lang="EN-US">Error Handling<o:p></o:p></span></b></p>

<p class="text" align="left" style="text-align:left;tab-stops:36.0pt 72.0pt 108.0pt 144.0pt 180.0pt 216.0pt 225.0pt 252.0pt 288.0pt 324.0pt 360.0pt 396.0pt 432.0pt 468.0pt"><b style="mso-bidi-font-weight:normal"><span lang="EN-US"><o:p>&nbsp;</o:p></span></b></p>

<p class="text" align="left" style="text-align:left;tab-stops:36.0pt 72.0pt 108.0pt 144.0pt 180.0pt 216.0pt 225.0pt 252.0pt 288.0pt 324.0pt 360.0pt 396.0pt 432.0pt 468.0pt"><span lang="EN-US">This error handling mechanism was first developed by Mitch Bradley
in his ForthMacs and then adopted by the ANS Forth Standard.<span style="mso-spacerun:yes">&nbsp; </span>It is very simple yet very powerful in
customizing system responses to many different error conditions.</span></p>

<p class="text" align="left" style="text-align:left;tab-stops:36.0pt 72.0pt 108.0pt 144.0pt 180.0pt 216.0pt 225.0pt 252.0pt 288.0pt 324.0pt 360.0pt 396.0pt 432.0pt 468.0pt"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">CATCH setups a local error
frame and execute the word referenced by the execution word ca. It returns a
non-zero error code or a zero if no error occurred.<span style="mso-spacerun:yes">&nbsp; </span>As the assigned word at ca is executing,
any error condition will execute THROW, which pushes an error code on the data
stack, restore the return stack to the state before CATCH was executed, and
execute the error handler stored in HANDLER.<span style="mso-spacerun:yes">&nbsp; </span>Since the error handler frame is saved
on the return stack, many layers of safety nets can be laid down nested. <o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">CATCH pushes SP and
HANDLER on the return stack, saves RP in HANDLER, and then execute the word at
ca.<span style="mso-spacerun:yes">&nbsp; </span>If no error occurred,<span style="mso-spacerun:yes">&nbsp; </span>HANDLER and SP are restored from the
return stack and a 0 is pushed on the data stack.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">THROW throws the system
back to CATCH so that the error condition can be processed.<span style="mso-spacerun:yes">&nbsp; </span>CATCH is backtracked by restoring the
return stack from the pointer stored in HANDLER and popping the old handler and
SP off the error frame on the return stack.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="eForth"><span lang="EN-US">: CATCH ( ca -- err#/0 )</span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>( Execute word at ca and set up an
error frame for it.)<o:p></o:p></span></p>

<p class="eForth"><span lang="EN-US"><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>SP@
&gt;R<span style="mso-spacerun:yes">&nbsp; </span><span style="mso-tab-count:
2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>( save current
stack pointer on return stack )</span></p>

<p class="eForth"><span lang="EN-US"><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>HANDLER
@ &gt;R<span style="mso-spacerun:yes">&nbsp; </span><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp; </span>( save the handler pointer on return stack )</span></p>

<p class="eForth"><span lang="EN-US"><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>RP@
HANDLER !<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp; </span>( save
the handler frame pointer in HANDLER )</span></p>

<p class="eForth"><span lang="EN-US"><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(
ca ) EXECUTE<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp; </span>( execute the
assigned word over this safety net )</span></p>

<p class="eForth"><span lang="EN-US"><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>R&gt;
HANDLER !<span style="mso-spacerun:yes">&nbsp; </span><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp; </span>( normal return from the executed word )</span></p>

<p class="eForth"><span lang="EN-US"><span style="mso-tab-count:4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(
restore HANDLER from the return stack )</span></p>

<p class="eForth"><span lang="EN-US"><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>R&gt;
DROP<span style="mso-spacerun:yes">&nbsp; </span><span style="mso-tab-count:
2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>( discard the saved
data stack pointer )</span></p>

<p class="eForth"><span lang="EN-US"><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0
;<span style="mso-tab-count:3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(
push a no-error flag on data stack )</span></p>

<p class="eForth"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="eForth"><span lang="EN-US">: THROW ( err# -- err# )</span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>( Reset system to current local error
frame an update error flag.)<o:p></o:p></span></p>

<p class="eForth"><span lang="EN-US"><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>HANDLER
@ RP! <span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp; </span>( expose latest
error handler frame on return stack )</span></p>

<p class="eForth"><span lang="EN-US"><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>R&gt;
HANDLER !<span style="mso-spacerun:yes">&nbsp; </span><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp; </span>( restore previously saved error handler frame )</span></p>

<p class="eForth"><span lang="EN-US"><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>R&gt;
SWAP &gt;R <span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(
retrieve the data stack pointer saved )</span></p>

<p class="eForth"><span lang="EN-US"><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>SP!
<span style="mso-tab-count:3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(
restore the data stack )</span></p>

<p class="eForth"><span lang="EN-US"><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DROP
</span></p>

<p class="eForth"><span lang="EN-US"><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>R&gt;
;<span style="mso-tab-count:3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(
retrived err# )</span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">NULL$ is the address of a
string with a zero count.<span style="mso-spacerun:yes">&nbsp; </span>This
address is used by ABORT and abort" to terminate the interpreting of the
current command line.<span style="mso-spacerun:yes">&nbsp; </span>QUIT tests
the address reported by CATCH.<span style="mso-spacerun:yes">&nbsp; </span>If
this address is NULL$, the termination is normal and no error message will be
issued.<span style="mso-spacerun:yes">&nbsp; </span>If CATCH reports a
different address, QUIT will display the contents of the string at that
address. <o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="text" align="left" style="text-align:left;tab-stops:36.0pt 72.0pt 108.0pt 144.0pt 180.0pt 216.0pt 252.0pt 288.0pt 324.0pt 342.0pt 360.0pt 396.0pt 432.0pt 468.0pt"><span lang="EN-US">ABORT" is used only within a definition to compile an inline
packed string terminated by the " double quote character. At run-time, if
the flag is false, execute the sequence of words following the string.
Otherwise, the string is displayed on the current output device, and execution
is then passed to an error handling routine.</span></p>

<p class="text" align="left" style="text-align:left;tab-stops:36.0pt 72.0pt 108.0pt 144.0pt 180.0pt 216.0pt 252.0pt 288.0pt 324.0pt 342.0pt 360.0pt 396.0pt 432.0pt 468.0pt"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="text" align="left" style="text-align:left;tab-stops:36.0pt 72.0pt 108.0pt 144.0pt 180.0pt 216.0pt 252.0pt 288.0pt 324.0pt 342.0pt 360.0pt 396.0pt 432.0pt 468.0pt"><span lang="EN-US">You have to study the code in QUIT carefully with this section to
get a better understanding of the CATCH-THROW error handling mechanism.</span></p>

<p class="eForth"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: CATCH ( xt -- 0 | err# )</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>SP@
&gt;R<span style="mso-spacerun:yes">&nbsp; </span>HANDLER @ &gt;R<span style="mso-spacerun:yes">&nbsp; </span>RP@ HANDLER !</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;
</span>EXECUTE</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;
</span>R&gt; HANDLER !<span style="mso-spacerun:yes">&nbsp; </span>R&gt;
DROP<span style="mso-spacerun:yes">&nbsp; </span>0 ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: THROW ( err# -- err# )</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;
</span>HANDLER @ RP!<span style="mso-spacerun:yes">&nbsp; </span>R&gt; HANDLER
!<span style="mso-spacerun:yes">&nbsp; </span>R&gt; SWAP &gt;R SP! DROP R&gt; ;</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></p>

<p class="zen"><span lang="EN-US">CREATE NULL$ 0 , $," coyote"</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: ABORT ( -- ) NULL$ THROW ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: abort" ( f -- ) IF do$ THROW THEN do$ DROP
; </span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Let's look at how the
CATCH-THROW pair is used.<span style="mso-spacerun:yes">&nbsp; </span>In QUIT,
there is this indefinite loop:<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier;mso-bidi-font-family:Times">BEGIN
QUERY [ ' EVAL ] LITERAL <span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>CATCH
<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier;mso-bidi-font-family:Times">?DUP
UNTIL<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">QUERY get a line of text
and CATCH causes EVAL to interpret the line. CATCH also sets up an error
handling frame on the return stack and saves the return stack pointer in the
user variable HANDLER.<span style="mso-spacerun:yes">&nbsp; </span>The error
handling frame contains the current data stack pointer and the current contents
in HANDLER.<span style="mso-spacerun:yes">&nbsp; </span>If no error occurred
during EVAL, the error frame is popped off the return stack and a false flag is
returned on the data stack.<span style="mso-spacerun:yes">&nbsp; </span>?DUP
UNTIL will loop back to QUERY and the interpretive process will continue.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">While EVAL interprets the
text, any word which decided that it detects an error condition and needs
attention, it will execute THROW.<span style="mso-spacerun:yes">&nbsp;
</span>THROW restores the return stack from the pointer stored in HANDLER,
making the error handling frame available.<span style="mso-spacerun:yes">&nbsp;
</span>THROW then restores HANDLER from the one saved in the error frame so
that the error handling can be nested.<span style="mso-spacerun:yes">&nbsp;
</span>The data stack pointer is also restored from the error frame.<span style="mso-spacerun:yes">&nbsp; </span>Now THROW passes the address of a error
processing routine to the CATCH which built the error frame.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">$INTERPRET, ?STACK and
abort" pass string addresses to THROW.<span style="mso-spacerun:yes">&nbsp; </span>The strings contains appropriate error
messages to be displayed by the text interpreter.<span style="mso-spacerun:yes">&nbsp; </span>In QUIT, the words between UNTIL and
AGAIN deal with the error conditions and then re-initialize the text
interpreter.<o:p></o:p></span></p>

<p class="eForth"><span lang="EN-US"><span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Here are some of the
examples which generate error conditions:<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier;mso-bidi-font-family:Times">:
ABORT<span style="mso-spacerun:yes">&nbsp;&nbsp; </span>NULL$ THROW ;<span style="mso-tab-count:1"> </span> <o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier;mso-bidi-font-family:Times">:
abort" <span style="mso-spacerun:yes">&nbsp;&nbsp;</span>IF do$ THROW THEN
do$ DROP ;<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier;mso-bidi-font-family:Times">:
?STACK<span style="mso-spacerun:yes">&nbsp;&nbsp; </span>DEPTH 0&lt; IF $"
underflow" THROW THEN ;<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier;mso-bidi-font-family:Times">:
$INTERPRET<span style="mso-spacerun:yes">&nbsp;&nbsp; </span>... 'NUMBER
@EXECUTE<span style="mso-spacerun:yes">&nbsp; </span>IF EXIT THEN THROW ;<o:p></o:p></span></p>

<p class="eForth"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;mso-pagination:widow-orphan lines-together;
page-break-after:avoid"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:
Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;mso-pagination:widow-orphan lines-together;
page-break-after:avoid"><b style="mso-bidi-font-weight:normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Text
Interpreter </span></b><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:
Times"><o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;mso-pagination:widow-orphan lines-together;
page-break-after:avoid"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:
Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;mso-pagination:widow-orphan lines-together;
page-break-after:avoid"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:
Times">Text interpreter in Forth is like the operating system of a computer. It
is the primary interface a user goes through to get the computer to do
work.<span style="mso-spacerun:yes">&nbsp; </span>Since Forth uses very simple
syntax rules--words are separated by spaces, the text interpreter is also very
simple.<span style="mso-spacerun:yes">&nbsp; </span>It accepts a line of text
from the terminal, parses out a word delimited by spaces, locates the word of
this word in the dictionary and then executes it. The process is repeated until
the source text is exhausted.<span style="mso-spacerun:yes">&nbsp; </span>Then
the text interpreter waits for another line of text and interprets it
again.<span style="mso-spacerun:yes">&nbsp; </span>This cycle repeats until the
user is exhausted and turns off the computer.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">In eForth, the text
interpreter is encoded in the word QUIT.<span style="mso-spacerun:yes">&nbsp;
</span>QUIT contains an infinite loop which repeats the QUERY EVAL phrase.
QUERY accepts a line of text from the terminal and copies the text into the Terminal
Input Buffer (TIB).<span style="mso-spacerun:yes">&nbsp; </span>EVAL interprets
the text one word at a time till the end of the text line.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">One of the unique features
in eForth is its error handling mechanism. While EVAL is interpreting a line of
text, there could exist many error conditions: a word is not found in the
dictionary and it is not a number, a compile-only word is accidentally executed
interpretively, and the interpretive process may bee interrupted by the words
ABORT or abort".<span style="mso-spacerun:yes">&nbsp; </span>Wherever the
error occurs, the text interpreter must be made aware of it so that it can
recover gracefully from the error condition and continue on about the
interpreting business.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">$INTERPRET executes a word
whose string address is on the stack.<span style="mso-spacerun:yes">&nbsp;
</span>If the string is not a word, convert it to a number.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">[<span style="mso-spacerun:yes">&nbsp; </span>activates the text interpreter by
storing the execution address of $INTERPRET into the variable 'EVAL, which is
executed in EVAL while the text interpreter is in the interpretive mode. <o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">.OK prints the familiar
'ok' prompt after executing to the end of a line.<span style="mso-spacerun:yes">&nbsp; </span>'ok' is printed only when the text
interpreter is in the interpretive mode.<span style="mso-spacerun:yes">&nbsp;
</span>While compiling, the prompt is suppressed.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">?STACK checks for stack
underflow.<span style="mso-spacerun:yes">&nbsp; </span>Abort if the stack depth
is negative.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">EVAL is the interpreter
loop which parses words from the input stream and invokes whatever is in 'EVAL
to handle that word, either execute it with $INTERPRET or compile it with
$COMPILE.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: $INTERPRET ( a -- )</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;
</span>NAME?<span style="mso-spacerun:yes">&nbsp; </span>?DUP</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>IF @
$40 AND</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;
</span>ABORT" compile ONLY" EXECUTE EXIT</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>THEN
'NUMBER @EXECUTE IF EXIT THEN THROW ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: [ ( -- ) doLIT $INTERPRET 'EVAL ! ; IMMEDIATE</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: .OK ( -- ) doLIT $INTERPRET 'EVAL @ = IF
."<span style="mso-spacerun:yes">&nbsp; </span>ok" THEN CR ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: ?STACK ( -- ) DEPTH 0&lt; ABORT"
underflow" ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: EVAL ( -- )</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;
</span>BEGIN TOKEN DUP C@</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;
</span>WHILE 'EVAL @EXECUTE ?STACK</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>REPEAT
DROP 'PROMPT @EXECUTE ;</span></p>

<p class="eForth"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Shell
<o:p></o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Source code can be
downloaded to eForth through the serial input device.<span style="mso-spacerun:yes">&nbsp; </span>The only precaution we have to take is
that during file downloading, characters are not echoed back to the host
computer.<span style="mso-spacerun:yes">&nbsp; </span>However, whenever an
error occurred during downloading, it is more useful to resume echoing so that
error messages can be displayed on the terminal.<span style="mso-spacerun:yes">&nbsp; </span>It is also convenient to send special
pacing characters to the host to tell the host that a line of source code was
received and processed correctly.<span style="mso-spacerun:yes">&nbsp;
</span>The following words configure the eForth I/O vectors to have the proper
behavior in normal terminal interaction and also during file downloading:<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">FILE turns off character
echoing.<span style="mso-spacerun:yes">&nbsp; </span>After one line of text is
processed correctly, a pacing character ASCII 11 is sent to the host.<span style="mso-spacerun:yes">&nbsp; </span>If an error occurred, send an ESC
(ASCII<span style="mso-spacerun:yes">&nbsp; </span>26) character.<span style="mso-spacerun:yes">&nbsp; </span>An error will also restore the I/O
vectors into the terminal mode.<span style="mso-spacerun:yes">&nbsp;
</span>HAND resumes terminal interaction.<span style="mso-spacerun:yes">&nbsp;
</span>Turn on character echoing, and send normal prompt message after a line
is processed correctly.<span style="mso-spacerun:yes">&nbsp; </span>CONSOLE
initializes the serial I/O device for terminal interaction.<span style="mso-spacerun:yes">&nbsp; </span>?KEY is vectored to ?RX and EMIT is
vectored to TX!.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">QUIT is the operating
system, or a shell, of the eForth system.<span style="mso-spacerun:yes">&nbsp;
</span>It is an infinite loop eForth will never get out.<span style="mso-spacerun:yes">&nbsp; </span>It uses QUERY to accept a line of
commands from the terminal and then let EVAL parse out the words and execute
them.<span style="mso-spacerun:yes">&nbsp; </span>After a line is processed, it
displays 'ok' and wait for the next line of commands.<span style="mso-spacerun:yes">&nbsp; </span>When an error occurred during execution,
it displays the command which caused the error with an error message.<span style="mso-spacerun:yes">&nbsp; </span>After the error is reported, it
re-initializes the system using PRESET and comes back to receive the next line
of commands.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Because the behavior of
EVAL can be changed by storing either $INTERPRET or $COMPILE into 'EVAL, QUIT
exhibits the dual nature of a text interpreter and a compiler.<o:p></o:p></span></p>

<p class="eForth"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: PRESET ( -- ) SP0 @ SP!<span style="mso-spacerun:yes">&nbsp; </span>TIB #TIB CELL+ ! ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: xio ( a a a -- ) \ reset<span style="mso-spacerun:yes">&nbsp; </span>'EXPECT 'TAP<span style="mso-spacerun:yes">&nbsp; </span>'ECHO 'PROMPT</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;
</span>doLIT accept<span style="mso-spacerun:yes">&nbsp; </span>'EXPECT 2!
'ECHO 2! ; COMPILE-ONLY</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: FILE ( -- )</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;
</span>doLIT PACE<span style="mso-spacerun:yes">&nbsp; </span>doLIT DROP<span style="mso-spacerun:yes">&nbsp; </span>doLIT kTAP xio ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: HAND ( -- )</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;
</span>doLIT .OK<span style="mso-spacerun:yes">&nbsp;&nbsp; </span>doLIT
EMIT<span style="mso-spacerun:yes">&nbsp; </span>[ kTAP<span style="mso-spacerun:yes">&nbsp; </span>xio ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">CREATE I/O<span style="mso-spacerun:yes">&nbsp;
</span>' ?RX , ' TX! , \ defaults</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: CONSOLE ( -- ) I/O 2@ '?KEY 2! HAND ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: QUIT ( -- )</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>RP0
@ RP!</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>BEGIN
[COMPILE] [</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;
</span>BEGIN QUERY doLIT EVAL CATCH ?DUP</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;
</span>UNTIL 'PROMPT @ SWAP CONSOLE<span style="mso-spacerun:yes">&nbsp;
</span>NULL$ OVER XOR</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;
</span>IF CR #TIB 2@ TYPE</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>CR &gt;IN
@ 94 CHARS</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>CR COUNT
TYPE ."<span style="mso-spacerun:yes">&nbsp; </span>? "</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;
</span>THEN doLIT .OK XOR</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;
</span>IF $1B EMIT THEN</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;
</span>PRESET</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;
</span>AGAIN ;</span></p>

<p class="eForth"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<b style="mso-bidi-font-weight:normal"><span lang="EN-US" style="font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:Times;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:Times;mso-ansi-language:EN-US;mso-fareast-language:ZH-TW;
mso-bidi-language:AR-SA;mso-no-proof:yes"><br clear="all" style="page-break-before:
always">
</span></b>

<p class="MsoNormal" align="center" style="margin-right:-36.0pt;text-align:center;
mso-pagination:widow-orphan lines-together;page-break-after:avoid"><b style="mso-bidi-font-weight:normal"><span lang="EN-US" style="font-size:18.0pt;
font-family:Times;mso-bidi-font-family:Times">eForth Compiler<o:p></o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt;mso-pagination:widow-orphan lines-together;
page-break-after:avoid"><b style="mso-bidi-font-weight:normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt;mso-pagination:widow-orphan lines-together;
page-break-after:avoid"><b style="mso-bidi-font-weight:normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt;mso-pagination:widow-orphan lines-together;
page-break-after:avoid"><b style="mso-bidi-font-weight:normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt;mso-pagination:widow-orphan lines-together;
page-break-after:avoid"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:
Times">After wading through the text interpreter, the Forth compiler will be an
easy piece of cake, because the compiler uses almost all the modules used by
the text interpreter.<span style="mso-spacerun:yes">&nbsp; </span>What the
compile does, over and above the text interpreter, is to build various
structures required by the new words we want to add to the existing
system.<span style="mso-spacerun:yes">&nbsp; </span>Here is a list of these
structures:<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;mso-pagination:widow-orphan lines-together;
page-break-after:avoid"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:
Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;mso-pagination:widow-orphan lines-together;
page-break-after:avoid"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:
Times"><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Name
headers<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;mso-pagination:widow-orphan lines-together;
page-break-after:avoid"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:
Times"><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Colon
definitions<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;mso-pagination:widow-orphan lines-together;
page-break-after:avoid"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:
Times"><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Constants,<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;mso-pagination:widow-orphan lines-together;
page-break-after:avoid"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:
Times"><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Variables<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;mso-pagination:widow-orphan lines-together;
page-break-after:avoid"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:
Times"><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>User
variables<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;mso-pagination:widow-orphan lines-together;
page-break-after:avoid"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:
Times"><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Integer
literals<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;mso-pagination:widow-orphan lines-together;
page-break-after:avoid"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:
Times"><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>String
literals<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;mso-pagination:widow-orphan lines-together;
page-break-after:avoid"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:
Times"><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Address
literals<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;mso-pagination:widow-orphan lines-together;
page-break-after:avoid"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:
Times"><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Control
structures<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;mso-pagination:widow-orphan lines-together;
page-break-after:avoid"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:
Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;mso-pagination:widow-orphan lines-together;
page-break-after:avoid"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:
Times">A special concept of immediate words is difficult to grasp at
first.<span style="mso-spacerun:yes">&nbsp; </span>It is required in the
compiler because of the needs in building different data and control structures
in a colon definition. <span style="mso-spacerun:yes">&nbsp;</span>To
understand the Forth compiler fully, you have to be able to differential and
relate the actions during compile time and actions taken during executing
time.<span style="mso-spacerun:yes">&nbsp; </span>Once these concepts are
clear, the whole Forth system will become transparent.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;mso-pagination:widow-orphan lines-together;
page-break-after:avoid"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:
Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;mso-pagination:widow-orphan lines-together;
page-break-after:avoid"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:
Times">This set stage for enlightenment to strike.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;mso-pagination:widow-orphan lines-together;
page-break-after:avoid"><b style="mso-bidi-font-weight:normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt;mso-pagination:widow-orphan lines-together;
page-break-after:avoid"><b style="mso-bidi-font-weight:normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></b></p>

<b style="mso-bidi-font-weight:normal"><span lang="EN-US" style="font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:Times;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:Times;mso-ansi-language:EN-US;mso-fareast-language:ZH-TW;
mso-bidi-language:AR-SA;mso-no-proof:yes"><br clear="all" style="page-break-before:
always">
</span></b>

<p class="MsoNormal" style="margin-right:-36.0pt;mso-pagination:widow-orphan lines-together;
page-break-after:avoid"><b style="mso-bidi-font-weight:normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Interpreter and
Compiler</span></b><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:
Times"><o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;mso-pagination:widow-orphan lines-together;
page-break-after:avoid"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:
Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;mso-pagination:widow-orphan lines-together;
page-break-after:avoid"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:
Times">The Forth compiler is the twin brother of the Forth text interpreter.
They share many common properties and use lots of common code.<span style="mso-spacerun:yes">&nbsp; </span>In eForth, the implementation of the
compiler clearly reflects this special duality.<span style="mso-spacerun:yes">&nbsp; </span>Two interesting words [ and ] causes the
text interpreter to switch back and forth between the compiler mode and
interpreter mode of operation.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Since 'EVAL @EXECUTE is
used in EVAL to process a word parsed out of a line of text, the contents in
'EVAL determines the behavior of the text interpreter.<span style="mso-spacerun:yes">&nbsp; </span>If $INTERPRET is stored in 'EVAL, as [
does, the words are executed or interpreted.<span style="mso-spacerun:yes">&nbsp; </span>If we invoked ] to store $COMPILE into
'EVAL, the word will not be executed, but added to the top of the code
dictionary.<span style="mso-spacerun:yes">&nbsp; </span>This is exactly the
behavior desired by the colon definition compiler in building a list of words
in the code field of a new colon definition on the top of the code dictionary.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">$COMPILE normally adds a
word to the code dictionary.<span style="mso-spacerun:yes">&nbsp; </span>However,
there are two exceptions it must handle.<span style="mso-spacerun:yes">&nbsp;
</span>If the word parsed out of the input stream does not exist in the
dictionary, the string will be converted to a number.<span style="mso-spacerun:yes">&nbsp; </span>If the string can be converted to an
integer, the integer is then compiled into the code dictionary as an
integer<span style="mso-spacerun:yes">&nbsp; </span>literal. The integer number
is compiled into the code dictionary following the word doLIT.<span style="mso-spacerun:yes">&nbsp; </span>The other exception is that a word found
in the dictionary could be an immediate word, which must be executed
immediately, not compiled to the code dictionary.<span style="mso-spacerun:yes">&nbsp; </span>Immediate words are used to compile
special structures in colon definitions.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="eForth"><span lang="EN-US">: [ ( -- ) </span></p>

<p class="eForth"><span lang="EN-US"><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>[
' $INTERPRET ] LITERAL </span></p>

<p class="eForth"><span lang="EN-US"><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>'EVAL
! <span style="mso-tab-count:4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(
vector EVAL to $INTERPRET )</span></p>

<p class="eForth"><span lang="EN-US"><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;
IMMEDIATE<span style="mso-tab-count:4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(
enter into text interpreter mode )</span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="eForth"><span lang="EN-US">: ] ( -- ) </span></p>

<p class="eForth"><span lang="EN-US"><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>[
' $COMPILE ] LITERAL </span></p>

<p class="eForth"><span lang="EN-US"><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>'EVAL
! <span style="mso-tab-count:4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(
vector EVAL to $COMPILE )</span></p>

<p class="eForth"><span lang="EN-US"><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;
<span style="mso-tab-count:3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;mso-pagination:widow-orphan lines-together;
page-break-after:avoid"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:
Times"><o:p>&nbsp;</o:p></span></p>

<b style="mso-bidi-font-weight:normal"><span lang="EN-US" style="font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:Times;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:Times;mso-ansi-language:EN-US;mso-fareast-language:ZH-TW;
mso-bidi-language:AR-SA;mso-no-proof:yes"><br clear="all" style="page-break-before:
always">
</span></b>

<p class="MsoNormal" style="margin-right:-36.0pt;mso-pagination:widow-orphan lines-together;
page-break-after:avoid"><b style="mso-bidi-font-weight:normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Primitive
Compiler Words<o:p></o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt;mso-pagination:widow-orphan lines-together;
page-break-after:avoid"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:
Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;mso-pagination:widow-orphan lines-together;
page-break-after:avoid"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:
Times">Here is a group of words which support the compiler to build new words
in the code dictionary.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;mso-pagination:widow-orphan lines-together;
page-break-after:avoid"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:
Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;mso-pagination:widow-orphan lines-together;
page-break-after:avoid"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:
Times">'<span style="mso-spacerun:yes">&nbsp; </span>(tick) searches the next
word in the input stream for a word in the dictionary.<span style="mso-spacerun:yes">&nbsp; </span>It returns the execution address of the
word if successful.<span style="mso-spacerun:yes">&nbsp; </span>Otherwise, it
displays an error message.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;mso-pagination:widow-orphan lines-together;
page-break-after:avoid"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:
Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;mso-pagination:widow-orphan lines-together;
page-break-after:avoid"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:
Times">ALLOT allocates<span style="mso-spacerun:yes">&nbsp; </span>n bytes of
memory on the top of the code dictionary.<span style="mso-spacerun:yes">&nbsp;
</span>Once allocated, the compiler will not touch the memory locations.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;mso-pagination:widow-orphan lines-together;
page-break-after:avoid"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:
Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;mso-pagination:widow-orphan lines-together;
page-break-after:avoid"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:
Times">,<span style="mso-spacerun:yes">&nbsp; </span>(comma) adds the execution
address of a word on the top of the data stack to the code dictionary, and thus
compiles a word to the growing word list of the word currently under
construction.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;mso-pagination:widow-orphan lines-together;
page-break-after:avoid"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:
Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;mso-pagination:widow-orphan lines-together;
page-break-after:avoid"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:
Times">COMPILE is used in a colon definition.<span style="mso-spacerun:yes">&nbsp; </span>It causes the next word after COMPILE to
be added to the top of the code dictionary.<span style="mso-spacerun:yes">&nbsp; </span>It therefore forces the compilation of a
word at the run time.<span style="mso-spacerun:yes">&nbsp; </span><o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;mso-pagination:widow-orphan lines-together;
page-break-after:avoid"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:
Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;mso-pagination:widow-orphan lines-together;
page-break-after:avoid"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:
Times">[COMPILE] acts similarly, except that it compiles the next word
immediately.<span style="mso-spacerun:yes">&nbsp; </span>It causes the
following word to be compiled, even if the following word is an immediate word
which would otherwise be executed.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">LITERAL compiles an
integer literal to the current colon definition under construction.<span style="mso-spacerun:yes">&nbsp; </span>The integer literal is taken from the
data stack, and is preceded by the word doLIT.<span style="mso-spacerun:yes">&nbsp; </span>When this colon definition is executed,
doLIT will extract the integer from the word list and push it back on the data
stack.<span style="mso-spacerun:yes">&nbsp; </span>LITERAL compiles an address
literal if the compiled integer happens to be an execution address of a
word.<span style="mso-spacerun:yes">&nbsp; </span>The address will be pushed on
the data stack at the run time by doLIT.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">$," compiles a string
literal.<span style="mso-spacerun:yes">&nbsp; </span>The string is taken from
the input stream and is terminated by the double quote character.<span style="mso-spacerun:yes">&nbsp; </span>$," only copies the counted string
to the code dictionary.<span style="mso-spacerun:yes">&nbsp; </span>A word
which makes use of the counted string at the run time must be compiled before
the string.<span style="mso-spacerun:yes">&nbsp; </span>It is used by ."
and $".<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">RECURSE is an interesting
word which allows eForth to compile recursive definitions.<span style="mso-spacerun:yes">&nbsp; </span>In a recursive definition, the execution
address of the word under construction is compiled into its own word list.<span style="mso-spacerun:yes">&nbsp; </span>This is not allowed normally because the
name field of the current word under construction is not yet linked to the
current vocabulary and it cannot be referenced inside its own colon
definition.<span style="mso-spacerun:yes">&nbsp; </span>RECURSE stores the
address of the name field of the current word into CURRENT, thus enable it to
be referenced inside its own definition.<span style="mso-spacerun:yes">&nbsp;
</span>Recursive words are not used in everyday programming.<span style="mso-spacerun:yes">&nbsp; </span>RECURSE is defined here in eForth merely
as a teaser to wet your appetite.<span style="mso-spacerun:yes">&nbsp;
</span>It is not used in eForth.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: ' ( -- xt ) TOKEN NAME? IF EXIT THEN THROW ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: ALLOT ( n -- ) CP +! ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: , ( w -- ) HERE DUP CELL+ CP ! ! ; \ ???ALIGNED</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: [COMPILE] ( -- ; &lt;string&gt; ) ' , ; IMMEDIATE</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: COMPILE ( -- ) R&gt; DUP @ , CELL+ &gt;R ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: LITERAL ( w -- ) COMPILE doLIT , ; IMMEDIATE</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: $," ( -- ) 34 WORD COUNT ALIGNED CP ! ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: RECURSE ( -- ) LAST @ NAME&gt; , ; IMMEDIATE</span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Structures</span></b><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">A set of immediate words
are defined in eForth to help building control structures in colon
definitions.<span style="mso-spacerun:yes">&nbsp; </span>The control structures
used in eForth are the following:<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Conditional branch <span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>IF ... THEN <o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><span style="mso-tab-count:
3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>IF
... ELSE ... THEN<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Finite loop<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp; </span>FOR ... NEXT<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><span style="mso-tab-count:
3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>FOR
... AFT ... THEN... <span style="mso-tab-count:3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>NEXT<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Infinite loop<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun:yes">&nbsp;&nbsp; </span><span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>BEGIN
... AGAIN<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Indefinite loop<span style="mso-tab-count:1">&nbsp;&nbsp; </span>BEGIN ... UNTIL<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><span style="mso-tab-count:
2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-tab-count:1">&nbsp; </span>BEGIN ... WHILE ... <span style="mso-tab-count:3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>REPEAT<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right: -30.0pt;"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">This set of words is more
powerful than the ones in figForth model because they permit multiple exits
from a loop.<span style="mso-spacerun:yes">&nbsp; </span>Many examples are
provide in the source code of eForth like NUMBER?, parse, find and &gt;NAME.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">A control structure
contains one or more address literals, which causes execution to branch out of
the normal sequence.<span style="mso-spacerun:yes">&nbsp; </span>The control
structure words are immediate words which compile the address literals and resolve
the branch address.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">One should note that
BEGIN<span style="mso-spacerun:yes">&nbsp; </span>and THEN do not compile any
code.<span style="mso-spacerun:yes">&nbsp; </span>They executes during
compilation to set up and to resolve the branch addresses in the address
literals.<span style="mso-spacerun:yes">&nbsp; </span>IF, ELSE, WHILE, UNTIL,
and AGAIN do compile address literals with branching words.<span style="mso-spacerun:yes">&nbsp; </span>Here are many excellent examples on the
usage of COMPILE and [COMPILE], and they are worthy of careful study.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Character strings are very
important devices for the program to communicate with the user.<span style="mso-spacerun:yes">&nbsp; </span>Error messages, appropriate warnings and
suggestions must be displayed to help the use to use the system in a friendly
way.<span style="mso-spacerun:yes">&nbsp; </span>Character strings are compiled
in the colon definitions as string literals.<span style="mso-spacerun:yes">&nbsp; </span>Each string literal consists of a string
word which will use the compiled string to do things, and a counted
string.<span style="mso-spacerun:yes">&nbsp; </span>The first byte in a counted
string is the length of the string.<span style="mso-spacerun:yes">&nbsp;
</span>Thus a string may have 0 to 255 characters in it.<span style="mso-spacerun:yes">&nbsp; </span>A string is always null-filled to the
cell boundary.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">ABORT" compiles an
error message.<span style="mso-spacerun:yes">&nbsp; </span>This error message
is display when the top item on the stack is non-zero.<span style="mso-spacerun:yes">&nbsp; </span>The rest of the words in the definition
is skipped and eForth re-enters the interpreter loop.<span style="mso-spacerun:yes">&nbsp; </span>This is the universal response to an
error condition.<span style="mso-spacerun:yes">&nbsp; </span>More sophisticated
programmer can use the CATCH-THROW mechanism to customize the responses to
special error conditions.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">." compiles a
character string which will be printed which the word containing it is executed
in the runtime.<span style="mso-spacerun:yes">&nbsp; </span>This is the best
way to present messages to the user.<span style="mso-spacerun:yes">&nbsp;
</span><o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">$" compiles a
character string.<span style="mso-spacerun:yes">&nbsp; </span>When it is
executed, only the address of the string is left on the data stack.<span style="mso-spacerun:yes">&nbsp; </span>The programmer will use this address to
access the string and individual characters in the string as a string array.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: &lt;MARK ( -- a ) HERE ;</span></p>

<p class="zen"><span lang="EN-US">: &lt;RESOLVE ( a -- ) , ;</span></p>

<p class="zen"><span lang="EN-US">: &gt;MARK ( -- A ) HERE 0 , ;</span></p>

<p class="zen"><span lang="EN-US">: &gt;RESOLVE ( A -- ) &lt;MARK SWAP ! ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: FOR ( -- a ) COMPILE &gt;R &lt;MARK ; IMMEDIATE</span></p>

<p class="zen"><span lang="EN-US">: BEGIN ( -- a ) &lt;MARK ; IMMEDIATE</span></p>

<p class="zen"><span lang="EN-US">: NEXT ( a -- ) COMPILE next &lt;RESOLVE ;
IMMEDIATE</span></p>

<p class="zen"><span lang="EN-US">: UNTIL ( a -- ) COMPILE ?branch &lt;RESOLVE ;
IMMEDIATE</span></p>

<p class="zen"><span lang="EN-US">: AGAIN ( a -- ) COMPILE<span style="mso-spacerun:yes">&nbsp; </span>branch &lt;RESOLVE ; IMMEDIATE</span></p>

<p class="zen"><span lang="EN-US">: IF ( -- A )<span style="mso-spacerun:yes">&nbsp;&nbsp; </span>COMPILE ?branch &gt;MARK ;
IMMEDIATE</span></p>

<p class="zen"><span lang="EN-US">: AHEAD ( -- A ) COMPILE branch &gt;MARK ;
IMMEDIATE</span></p>

<p class="zen"><span lang="EN-US">: REPEAT ( A a -- ) [COMPILE] AGAIN &gt;RESOLVE ;
IMMEDIATE</span></p>

<p class="zen"><span lang="EN-US">: THEN ( A -- ) &gt;RESOLVE ; IMMEDIATE</span></p>

<p class="zen"><span lang="EN-US">: AFT ( a -- a A ) DROP [COMPILE] AHEAD [COMPILE]
BEGIN SWAP ; IMMEDIATE</span></p>

<p class="zen"><span lang="EN-US">: ELSE ( A -- A )<span style="mso-spacerun:yes">&nbsp; </span>[COMPILE] AHEAD SWAP [COMPILE] THEN ;
IMMEDIATE</span></p>

<p class="zen"><span lang="EN-US">: WHEN ( a A -- a A a ) [COMPILE] IF OVER ;
IMMEDIATE</span></p>

<p class="zen"><span lang="EN-US">: WHILE ( a -- A a )<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp; </span>[COMPILE] IF SWAP ;
IMMEDIATE</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: ABORT" ( -- ; &lt;string&gt; ) COMPILE
abort" $," ; IMMEDIATE</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: $" ( -- ; &lt;string&gt; ) COMPILE
$"| $," ; IMMEDIATE</span></p>

<p class="zen"><span lang="EN-US">: ." ( -- ; &lt;string&gt; ) COMPILE
."| $," ; IMMEDIATE</span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></b></p>

<b style="mso-bidi-font-weight:normal"><span lang="EN-US" style="font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:Times;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:Times;mso-ansi-language:EN-US;mso-fareast-language:ZH-TW;
mso-bidi-language:AR-SA;mso-no-proof:yes"><br clear="all" style="page-break-before:
always">
</span></b>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Compiler
<o:p></o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">We had discussed how the
compiler compiles words and structures into the code field of a colon definition
in the code dictionary.<span style="mso-spacerun:yes">&nbsp; </span>To build a
new definition, we have to build its header in the name dictionary also.<span style="mso-spacerun:yes">&nbsp; </span>A header has a word pointer field, a
link field, and a name field.<span style="mso-spacerun:yes">&nbsp; </span>Here
are the tools to build these fields.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">?UNIQUE is used to display
a warning message to show that the name of a new word is a duplicate to a word
already existing in the dictionary.<span style="mso-spacerun:yes">&nbsp;
</span>eForth does not mind your reusing the same name for different words.<span style="mso-spacerun:yes">&nbsp; </span>However, giving many words the same name
is a potential cause of problems in maintaining software projects.<span style="mso-spacerun:yes">&nbsp; </span>It is to be avoided if possible and
?UNIQUE reminds you of it.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">$,n builds a new entry in
the name dictionary using the name already moved to the bottom of the name
dictionary by PACK$.<span style="mso-spacerun:yes">&nbsp; </span>It pads the
word field with the address of the top of code dictionary where the new code is
to be built, and link the link field to the current vocabulary.<span style="mso-spacerun:yes">&nbsp; </span>A new word can now be built in the code
dictionary.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">$COMPILE builds the body
of a new colon definition.<span style="mso-spacerun:yes">&nbsp; </span>A
complete colon definition also requires a header in the name dictionary, and
its code field must start with a CALL doLIST instruction. These extra works are
performed by :.<span style="mso-spacerun:yes">&nbsp; </span>Colon definitions
are the most prevailing type of words in eForth.<span style="mso-spacerun:yes">&nbsp; </span>In addition, eForth has a few other
defining words which create other types of new definitions in the dictionary.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">OVERT links a new
definition to the current vocabulary and thus makes it available for dictionary
searches.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">; terminates a colon
definition.<span style="mso-spacerun:yes">&nbsp; </span>It compiles an EXIT to
the end of the word list, links this new word to the current vocabulary, and
then reactivates the interpreter.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">]<span style="mso-spacerun:yes">&nbsp; </span>turns the interpreter to a compiler.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">:<span style="mso-spacerun:yes">&nbsp;&nbsp; </span>creates a new header and start a
new colon word.<span style="mso-spacerun:yes">&nbsp; </span>It takes the
following string in the input stream to be the name of the new colon
definition, by building a new header with this name in the name
dictionary.<span style="mso-spacerun:yes">&nbsp; </span>It then compiles a CALL
doLIST instruction at the beginning of the code field in the code
dictionary.<span style="mso-spacerun:yes">&nbsp; </span>Now, the code dictionary
is ready to accept a word list.<span style="mso-spacerun:yes">&nbsp; </span>]
is now invoked to turn the text interpreter into a compiler, which will compile
the following words in the input stream to a word list in the code dictionary.<span style="mso-spacerun:yes">&nbsp; </span>The new colon definition is terminated
by ;, which compiles an EXIT to terminate the word list, and executes [ to turn
the compiler back to text interpreter.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">call,<span style="mso-spacerun:yes">&nbsp; </span>compiles the CALL doLIST instruction as
the first thing in the code field of a colon definition.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">IMMEDIATE sets the
immediate lexicon bit in the name field of the new definition just
compiled.<span style="mso-spacerun:yes">&nbsp; </span>When the compiler
encounters a word with this bit set, it will not compile this words into the
word list under construction, but execute the word immediately.<span style="mso-spacerun:yes">&nbsp; </span>This bit allows structure words to build
special structures in the colon definitions, and to process special conditions
when the compiler is running.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: ?UNIQUE ( a -- a )</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>DUP
NAME? IF ."<span style="mso-spacerun:yes">&nbsp; </span>reDef " OVER
COUNT TYPE THEN DROP ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: $,n ( a -- )</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>DUP
C@</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>IF
?UNIQUE</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;
</span>( na) DUP LAST ! \ for OVERT</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;
</span>( na) HERE ALIGNED SWAP</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;
</span>( cp na) CELL-</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;
</span>( cp la) CURRENT @ @</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;
</span>( cp la na') OVER !</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;
</span>( cp la) CELL- DUP NP ! ( ptr) ! EXIT</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>THEN
$" name" THROW ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">.( FORTH Compiler )</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: $COMPILE ( a -- )</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;
</span>NAME? ?DUP</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>IF @
$80 AND</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;
</span>IF EXECUTE ELSE , THEN EXIT</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>THEN
'NUMBER @EXECUTE</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>IF
[COMPILE] LITERAL EXIT</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>THEN
THROW ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: OVERT ( -- ) LAST @ CURRENT @<span style="mso-spacerun:yes">&nbsp; </span>! ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: ; ( -- )</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;
</span>COMPILE EXIT [COMPILE] [ OVERT ; IMMEDIATE</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: ] ( -- ) doLIT $COMPILE 'EVAL ! ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: call, ( xt -- ) \ DTC 8086 relative call</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;
</span>$E890 , HERE CELL+ - , ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: : ( -- ; &lt;string&gt; ) TOKEN $,n doLIT
doLIST<span style="mso-spacerun:yes">&nbsp; </span>call, ] ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: IMMEDIATE ( -- ) $80 LAST @ @ OR LAST @ ! ;</span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><o:p>&nbsp;</o:p></span></p>

<b style="mso-bidi-font-weight:normal"><span lang="EN-US" style="font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:Times;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:Times;mso-ansi-language:EN-US;mso-fareast-language:ZH-TW;
mso-bidi-language:AR-SA;mso-no-proof:yes"><br clear="all" style="page-break-before:
always">
</span></b>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Defining
Words<o:p></o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Defining words are molds
which can be used to define many words which share the same run time execution
behavior.<span style="mso-spacerun:yes">&nbsp; </span>In eForth, we have : ,
USER, CREATE, and VARIABLE.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">USER creates a new user
variable.<span style="mso-spacerun:yes">&nbsp; </span>The user variable
contains an user area offset, which is added to the beginning address of the
user area and to return the address of the user variable in the user area.<span style="mso-spacerun:yes">&nbsp; </span>CREATE creates a new array without
allocating memory.<span style="mso-spacerun:yes">&nbsp; </span>Memory is
allocated using ALLOT.<span style="mso-spacerun:yes">&nbsp; </span>VARIABLE creates
a new variable, initialized to 0.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">eForth does not use
CONSTANT, because a integer literal is more economical than a constant.<span style="mso-spacerun:yes">&nbsp; </span>One can always use a variable for a
constant.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: USER ( n -- ; &lt;string&gt; )</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;
</span>TOKEN $,n OVERT</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;
</span>doLIT doLIST COMPILE doUSER , ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: CREATE ( -- ; &lt;string&gt; )</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;
</span>TOKEN $,n OVERT</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;
</span>doLIT doLIST COMPILE doVAR ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: VARIABLE ( -- ; &lt;string&gt; ) CREATE 0 , ;</span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><o:p>&nbsp;</o:p></span></p>

<b style="mso-bidi-font-weight:normal"><span lang="EN-US" style="font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:Times;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:Times;mso-ansi-language:EN-US;mso-fareast-language:ZH-TW;
mso-bidi-language:AR-SA;mso-no-proof:yes"><br clear="all" style="page-break-before:
always">
</span></b>

<p class="MsoNormal" align="center" style="margin-right:-36.0pt;text-align:center"><b style="mso-bidi-font-weight:normal"><span lang="EN-US" style="font-size:18.0pt;
font-family:Times;mso-bidi-font-family:Times">Utilities<o:p></o:p></span></b></p>

<p class="MsoNormal" align="center" style="margin-right:-36.0pt;text-align:center"><b style="mso-bidi-font-weight:normal"><span lang="EN-US" style="font-size:18.0pt;
font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">eForth is a very small
system and only a very small set of tools are provided in the system.<span style="mso-spacerun:yes">&nbsp; </span>Nevertheless, this set of tools is
powerful enough to help the user debug new words he adds to the system.<span style="mso-spacerun:yes">&nbsp; </span>They are also very interesting
programming examples on how to use the words in eForth to build
applications.<span style="mso-spacerun:yes">&nbsp; </span><o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Generally, the tools
presents the information stored in different parts of the memory in the
appropriate format to let the use inspect the results as he executes words in
the eForth system and words he defined himself.<span style="mso-spacerun:yes">&nbsp; </span>The tools include memory dump, stack
dump, dictionary dump, and a colon definition decompiler.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Memory
Dump<o:p></o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">DUMP dumps u bytes
starting at address b to the terminal.<span style="mso-spacerun:yes">&nbsp;
</span>It dumps 16 bytes to a line.<span style="mso-spacerun:yes">&nbsp;
</span>A line begins with the address of the first byte, followed by 16 bytes
shown in hex, 3 columns per bytes.<span style="mso-spacerun:yes">&nbsp;
</span>At the end of a line are the 16 bytes shown in characters.<span style="mso-spacerun:yes">&nbsp; </span>The character display is generated by
_TYPE, which substitutes non-printable characters by underscores.<span style="mso-spacerun:yes">&nbsp; </span>Typing a key on the keyboard halts the
display.<span style="mso-spacerun:yes">&nbsp; </span>Another CR terminates the
display.<span style="mso-spacerun:yes">&nbsp; </span>Any other key resumes the
display.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">dm+<span style="mso-spacerun:yes">&nbsp; </span>displays u bytes from b1 in one
line.<span style="mso-spacerun:yes">&nbsp; </span>It leave the address b1+u on
the stack for the next dm+ command to use.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">_TYPE<span style="mso-spacerun:yes">&nbsp; </span>is similar to TYPE.<span style="mso-spacerun:yes">&nbsp; </span>It displays u characters starting from
b.<span style="mso-spacerun:yes">&nbsp; </span>Non-printable characters are
replaced by underscores.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: _TYPE ( b u -- )</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>FOR
AFT DUP C@ &gt;CHAR EMIT 1 + THEN NEXT DROP ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: dm+ ( b u -- b )</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>OVER
4 U.R SPACE FOR AFT DUP C@ 3 U.R 1 + THEN NEXT ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: DUMP ( b u -- )</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>BASE
@ &gt;R HEX<span style="mso-spacerun:yes">&nbsp; </span>16 /</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>FOR
CR 16 2DUP dm+ ROT ROT 2 SPACES _TYPE NUF? NOT WHILE</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>NEXT
ELSE R&gt; DROP THEN DROP<span style="mso-spacerun:yes">&nbsp; </span>R&gt;
BASE ! ;</span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Courier"><o:p>&nbsp;</o:p></span></b></p>

<b style="mso-bidi-font-weight:normal"><span lang="EN-US" style="font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:Courier;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-US;mso-fareast-language:
ZH-TW;mso-bidi-language:AR-SA;mso-no-proof:yes"><br clear="all" style="page-break-before:
always">
</span></b>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Courier">Stack Tools<o:p></o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Data stack is the working
place of the Forth computer.<span style="mso-spacerun:yes">&nbsp; </span>It is
where words receive their parameters and also where they left their
results.<span style="mso-spacerun:yes">&nbsp; </span>In debugging a newly
defined word which uses stack items and which leaves items on the stack, the
best was to check its function is to inspect the data stack.<span style="mso-spacerun:yes">&nbsp; </span>The number output words may be used for
this purpose, but they are destructive.<span style="mso-spacerun:yes">&nbsp;
</span>You print out the number from the stack and it is gone.<span style="mso-spacerun:yes">&nbsp; </span>To inspect the data stack non-destructively,
a special utility word .S is provided in most Forth systems.<span style="mso-spacerun:yes">&nbsp; </span>It is also implemented in eForth.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">.S<span style="mso-spacerun:yes">&nbsp; </span>dumps the contents of the data stack on
the screen in the free format.<span style="mso-spacerun:yes">&nbsp; </span>The
bottom of the stack is aligned to the left margin.<span style="mso-spacerun:yes">&nbsp; </span>The top item is shown towards the left
and followed by the characters '&lt;sp'.<span style="mso-spacerun:yes">&nbsp;
</span>.S does not change the data stack so it can be used to inspect the data
stack non-destructively at any time.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">One important discipline
in learning Forth is to learn how to use the data stack effectively.<span style="mso-spacerun:yes">&nbsp; </span>All words must consume their input
parameters on the stack and leave only their intended results on the
stack.<span style="mso-spacerun:yes">&nbsp; </span>Sloppy usage of the data
stack is often the cause of bugs which are very difficult to detect later as
unexpected items left on the stack could result in unpredictable behavior.<span style="mso-spacerun:yes">&nbsp; </span>.S should be used liberally during Forth
programming and debugging to ensure that the correct data are left on the data
stack.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">.S is useful in checking
the stack interactively during the programming and debugging.<span style="mso-spacerun:yes">&nbsp; </span>It is not appropriate for checking the
data stack at the run time.<span style="mso-spacerun:yes">&nbsp; </span>For run
time stack checking, eForth provides !CSP and ?CSP.<span style="mso-spacerun:yes">&nbsp; </span>They are not used in the eForth system
itself, but are very useful for the user in developing serious applications.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">To do run time stack
checking, at some point the program should execute !CSP to mark the depth of
the data stack at that point.<span style="mso-spacerun:yes">&nbsp;
</span>Later, the program would execute ?CSP to see if the stack depth was
changed.<span style="mso-spacerun:yes">&nbsp; </span>Normally, the stack depth
should be the same at these two points.<span style="mso-spacerun:yes">&nbsp;
</span>If the stack depth is changed, ?CSP would abort the execution.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">One application of stack
checking is to ensure compiler security.<span style="mso-spacerun:yes">&nbsp;
</span>Normally, compiling a colon definition does not change the depth of the
data stack, if all the structure building immediate words in a colon definition
are properly paired.<span style="mso-spacerun:yes">&nbsp; </span>If they are
not paired, like IF without a THEN, FOR without a NEXT, BEGIN without an AGAIN
or REPEAT, etc., the data stack will not be balanced and ?CSP is very useful in
catching these compilation errors. This stack check is a very simple but
powerful tool to check the compiler.<span style="mso-spacerun:yes">&nbsp;
</span>!CSP and CSP are the words to monitor the stack depth.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">!CSP<span style="mso-spacerun:yes">&nbsp; </span>stores the current data stack pointer
into tan user variable CSP.<span style="mso-spacerun:yes">&nbsp; </span>The
stack pointer saved will be used by ?CSP for error checking.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">?CSP compares the current
stack pointer with that saved in CSP.<span style="mso-spacerun:yes">&nbsp;
</span>If they are different, abort and display the error message 'stack
depth'.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: .S ( -- ) CR DEPTH FOR AFT R@ PICK . THEN NEXT
."<span style="mso-spacerun:yes">&nbsp; </span>&lt;sp" ;</span></p>

<p class="zen"><span lang="EN-US">: .BASE ( -- ) BASE @ DECIMAL DUP . BASE<span style="mso-spacerun:yes">&nbsp; </span>! ;</span></p>

<p class="zen"><span lang="EN-US">: .FREE ( -- ) CP 2@ - U. ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: !CSP ( -- ) SP@ CSP ! ;</span></p>

<p class="zen"><span lang="EN-US">: ?CSP ( -- ) SP@ CSP @ XOR ABORT" stack
depth" ;</span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></b></p>

<b style="mso-bidi-font-weight:normal"><span lang="EN-US" style="font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:Times;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:Times;mso-ansi-language:EN-US;mso-fareast-language:ZH-TW;
mso-bidi-language:AR-SA;mso-no-proof:yes"><br clear="all" style="page-break-before:
always">
</span></b>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Dictionary
Dump<o:p></o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">The Forth dictionary
contains all the words defined in the system, ready for execution and
compilation.<span style="mso-spacerun:yes">&nbsp; </span>WORDS allows you to
examine the dictionary and to look for the correct names of words in case you
are not sure of their spellings.<span style="mso-spacerun:yes">&nbsp;
</span>WORDS follows the vocabulary thread in the user variable CONTEXT and
displays the names of each entry in the name dictionary.<span style="mso-spacerun:yes">&nbsp; </span>The vocabulary thread can be traced
easily because the link field in the header of a word points to the name field
of the previous word.<span style="mso-spacerun:yes">&nbsp; </span>The link
field of the next word is one cell below its name field.<span style="mso-spacerun:yes">&nbsp; </span><o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">WORDS<span style="mso-spacerun:yes">&nbsp; </span>displays all the names in the context
vocabulary.<span style="mso-spacerun:yes">&nbsp; </span>The order of words is
reversed from the compiled order.<span style="mso-spacerun:yes">&nbsp;
</span>The last defined words is shown first.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">.ID displays the name of a
word, given the word's name field address.<span style="mso-spacerun:yes">&nbsp;
</span>It also replaces non-printable characters in a name by under-scores.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Since the name fields are
linked into a list in the name dictionary, it is fairly easy to locate a word
by searching its name in the name dictionary.<span style="mso-spacerun:yes">&nbsp; </span>However, finding the name of a word from
the execution address of the word is more difficult, because the execution
addresses of words are not organized in any systematic way.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">It is necessary to find
the name of a word from its execution address, if we wanted to decompile the
contents of a word list in the code dictionary.<span style="mso-spacerun:yes">&nbsp; </span>This reversed search is accomplished by
the word &gt;NAME.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">&gt;NAME<span style="mso-spacerun:yes">&nbsp; </span>finds the name field address of a word
from the execution address of the word.<span style="mso-spacerun:yes">&nbsp;
</span>If the word does not exist in the CURRENT vocabulary, it returns a false
flag.<span style="mso-spacerun:yes">&nbsp; </span>It is the mirror image of the
word NAME&gt;, which returns the execution address of a word from its name
address.<span style="mso-spacerun:yes">&nbsp; </span>Since the execution
address of a word is stored in the word field, two cells below the name,
NAME&gt; is trivial.<span style="mso-spacerun:yes">&nbsp; </span>&gt;NAME is
more complicated because the entire name dictionary must be searched to locate
the word.<span style="mso-spacerun:yes">&nbsp;&nbsp; </span>&gt;NAME only<span style="mso-spacerun:yes">&nbsp; </span>searches the CURRENT vocabulary.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:0cm"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Bill Muench and I spent
much of our spare time in July, 1991 to build and polish the eForth Model and
the first implementation on 8086/MS-DOS.<span style="mso-spacerun:yes">&nbsp;
</span>One evening he called me and told me about this smallest and greatest
Forth decompiler, only three lines of source code.<span style="mso-spacerun:yes">&nbsp; </span>I was very skeptical because I knew how
to build a Forth decompiler.<span style="mso-spacerun:yes">&nbsp; </span>If a
Forth colon definition contains only a simple list of execution addresses, it
is a trivial task to decompile it.<span style="mso-spacerun:yes">&nbsp;
</span>However, there are many different data and control structures in a colon
definition.<span style="mso-spacerun:yes">&nbsp; </span>To deal with all these
structures, it is logically impossible to have a three line decompiler. <o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:0cm"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:0cm"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">I told Bill that I had to
see it to believe.<span style="mso-spacerun:yes">&nbsp; </span>The next time we
met, he read the source code in assembly and I entered it into the eForth
model.<span style="mso-spacerun:yes">&nbsp; </span>The decompiler had 24 words
and worked the first time after we reassemble the source code.<span style="mso-spacerun:yes">&nbsp; </span><o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:0cm"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:0cm"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">SEE searches the
dictionary for the next word in the input stream and returns its code field
address.<span style="mso-spacerun:yes">&nbsp; </span>Then it scans the list of
execution addresses (words) in the colon definition.<span style="mso-spacerun:yes">&nbsp; </span>If the word fetched out of the list
matches the execution address of a word in the name dictionary, the name will
be displayed by the command '.ID'.<span style="mso-spacerun:yes">&nbsp;
</span>If the word does not match any execution address in the name dictionary,<span style="mso-spacerun:yes">&nbsp; </span>it must be part of a structure and it is
displayed by 'U.'.<span style="mso-spacerun:yes">&nbsp; </span>This way, the
decompiler ignores all the data structures and control structures in the colon
definition, and only displays valid words in the word list.<span style="mso-spacerun:yes">&nbsp; </span><o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:0cm"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: &gt;NAME ( xt -- na | F )</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;
</span>CURRENT</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;
</span>BEGIN CELL+ @ ?DUP WHILE 2DUP</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;
</span>BEGIN @ DUP WHILE 2DUP NAME&gt; XOR</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;
</span>WHILE CELL-</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;
</span>REPEAT<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>THEN SWAP DROP ?DUP</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;
</span>UNTIL SWAP DROP SWAP DROP EXIT THEN DROP 0 ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: .ID ( a -- )</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>?DUP
IF COUNT $01F AND _TYPE EXIT THEN ." {noName}" ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: SEE ( -- ; &lt;string&gt; )</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>' CR
CELL+</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;
</span>BEGIN CELL+ DUP @ DUP IF &gt;NAME THEN ?DUP</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;
</span>IF SPACE .ID ELSE DUP @ U. THEN NUF?</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;
</span>UNTIL DROP ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: WORDS ( -- )</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;
</span>CR<span style="mso-spacerun:yes">&nbsp; </span>CONTEXT @</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;
</span>BEGIN @ ?DUP</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;
</span>WHILE DUP SPACE .ID CELL-<span style="mso-spacerun:yes">&nbsp;
</span>NUF?</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;
</span>UNTIL DROP THEN ;</span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></b></p>

<b style="mso-bidi-font-weight:normal"><span lang="EN-US" style="font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:Times;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:Times;mso-ansi-language:EN-US;mso-fareast-language:ZH-TW;
mso-bidi-language:AR-SA;mso-no-proof:yes"><br clear="all" style="page-break-before:
always">
</span></b>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Startup<o:p></o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Since we expect eForth to
evolve as experience is accumulated with usage, and as it has to track the ANS
Forth Standard under development, version control becomes an important
issue.<span style="mso-spacerun:yes">&nbsp; </span>To assure compatibility at different
stages of development, the user can always inquire the version number of the
eForth he is running.<span style="mso-spacerun:yes">&nbsp; </span>With the
version number, corrective actions can be taken to put an overlay on the system
to force it to be compatible with another eForth of a different version.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">VER returns the version
number of this eForth system.<span style="mso-spacerun:yes">&nbsp; </span>The
version number contains two bytes: the most significant byte is the major
revision number, and the least significant byte is the minor release number.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">'hi' is he default
start-up routine in eForth.<span style="mso-spacerun:yes">&nbsp; </span>It
initializes the serial I/O device and then displays a sign-on message.<span style="mso-spacerun:yes">&nbsp; </span>This is where the user can customized
his application.<span style="mso-spacerun:yes">&nbsp; </span>From here one can
initialize the system to start his customized application.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Because all the system
variable in eForth are implemented as user variables and the name dictionary is
separated from the code dictionary, eForth dictionary is eminently ROMmable and
most suitable for embedded applications.<span style="mso-spacerun:yes">&nbsp;
</span>To be useful as a generic model for many different processors and
applications, a flexible mechanism is designed to help booting eForth up in
different environments. Before falling into the QUIT loop, the COLD routine
executes a boot routine whose code address is stored in 'BOOT.<span style="mso-spacerun:yes">&nbsp; </span>This code address can be vectored to an
application routine which defines the proper behavior of the system.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="text" align="left" style="text-align:left"><span lang="EN-US">After the
computer is turned on, it executes some native machine code to set up the CPU
hardware so that it emulates a virtual Forth computer.<span style="mso-spacerun:yes">&nbsp; </span>Then it jumps to COLD to initialize the
eForth system.<span style="mso-spacerun:yes">&nbsp; </span>It finally jumps to
QUIT which is the operating system in eForth.<span style="mso-spacerun:yes">&nbsp; </span>COLD and QUIT are the topmost layers of
an eForth system.</span></p>

<p class="eForth" style="text-align:justify;text-justify:inter-ideograph"><span lang="EN-US" style="font-size:12.0pt;font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">'BOOT<span style="mso-spacerun:yes">&nbsp; </span>is an variable vectored to 'hi'.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">COLD is a high level word
executed upon power-up.<span style="mso-spacerun:yes">&nbsp; </span>Its most
important function is to initialize the user area and execute the boot-up
routine vectored through 'BOOT, and then falls into the text interpreter loop
QUIT.<o:p></o:p></span></p>

<p class="eForth"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: VER ( -- u ) $101 ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: hi ( -- )</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>!IO
BASE @ HEX \ initialize IO device &amp; sign on</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>CR
." eFORTH V" VER &lt;# # # 46 HOLD # #&gt; TYPE</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp; </span>CR ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: EMPTY ( -- )</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;
</span>FORTH CONTEXT @ DUP CURRENT 2!<span style="mso-spacerun:yes">&nbsp;
</span>6 CP 3 MOVE OVERT ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">CREATE 'BOOT<span style="mso-spacerun:yes">&nbsp;
</span>' hi , \ application vector</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="zen"><span lang="EN-US">: COLD ( -- )</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;
</span>BEGIN</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;
</span>U0 UP 74 CMOVE </span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;
</span>PRESET<span style="mso-spacerun:yes">&nbsp; </span>'BOOT @EXECUTE</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;
</span>FORTH CONTEXT @ DUP CURRENT 2! OVERT</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;
</span>QUIT</span></p>

<p class="zen"><span lang="EN-US"><span style="mso-spacerun:yes">&nbsp;
</span>AGAIN ;</span></p>

<p class="zen"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" align="center" style="margin-right:-36.0pt;text-align:center"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><b style="mso-bidi-font-weight:
normal"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">ColdBoot
from DOS<o:p></o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">DOS starts executing the
object code at 100H. The eForth Model is configured for a DOS machine.<span style="mso-spacerun:yes">&nbsp; </span>It can be modified to jump to any memory
location from where the CPU boots up.<span style="mso-spacerun:yes">&nbsp;
</span>What we have to do here is to set up the 8086 CPU so that it will
emulate the virtual Forth computer as we discussed before.<span style="mso-spacerun:yes">&nbsp; </span>All the pertinent registers have to be
initialized properly.<span style="mso-spacerun:yes">&nbsp; </span>Since eForth
is very small and fits comfortably in a single 64 Kbyte code segment, we will
use only one segment for code, data, as well as the two stacks.<span style="mso-spacerun:yes">&nbsp; </span>Therefore, both the DS and SS segment
registers are initialized to be the same as the CS register.<span style="mso-spacerun:yes">&nbsp; </span>Then, the data stack pointer SP and the
return stack pointer RP (BP in 8086) are initialized.<span style="mso-spacerun:yes">&nbsp; </span>To prevent the eForth from being forced
back into DOS accidentally, the Control-C interrupt is made benign by vectoring
it to a simple IRET instruction.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Now we are ready to start
the Forth computer.<span style="mso-spacerun:yes">&nbsp; </span>Simply jumping
to COLD will do it.<span style="mso-spacerun:yes">&nbsp; </span>COLD is coded
as a colon word, containing a list of words.<span style="mso-spacerun:yes">&nbsp; </span>This word list does more initialization
in high level, including initializing the user area, and setting up the
terminal input buffer.<span style="mso-spacerun:yes">&nbsp; </span>At the end,
COLD executes QUIT, the text interpreter, which contains an infinite loop to
receive commands from a user and executes them repeatedly.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">The user area contains
vital information for Forth to perform its functions.<span style="mso-spacerun:yes">&nbsp; </span>It contains important pointers
specifying memory areas for various activities, such as the data stack, the
return stack, the terminal input buffer, where the code dictionary and the name
dictionary end, and the execution addresses of many vectored words like KEY,
EMIT, ECHO, EXPECT,<span style="mso-spacerun:yes">&nbsp; </span>NUMBER, etc.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">The user area must be
located in the RAM memory, because the information contained in it are
continuously updated when eForth is running.<span style="mso-spacerun:yes">&nbsp; </span>The default values are stored in the
code segment starting at UZERO and covering an area of 74 bytes.<span style="mso-spacerun:yes">&nbsp; </span>This area is copied to the user area in
RAM before starting the eForth computer.<span style="mso-spacerun:yes">&nbsp;
</span>The sequence of data in UZERO must match exactly the sequence of user
variables.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">;; Main entry points
and COLD start data<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">MAIN<span style="mso-tab-count:1">&nbsp; </span>SEGMENT<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">ASSUME<span style="mso-spacerun:yes">&nbsp; </span>CS:MAIN,DS:MAIN,ES:MAIN,SS:MAIN<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">ORG<span style="mso-tab-count:1">&nbsp;&nbsp; </span>COLDD<span style="mso-tab-count:
3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;beginning
of cold boot<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">ORIG:<span style="mso-tab-count:1"> </span>MOV<span style="mso-tab-count:1">&nbsp;&nbsp; </span>AX,CS<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>MOV<span style="mso-tab-count:1">&nbsp;&nbsp; </span>DS,AX<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;DS
is same as CS<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>CLI<span style="mso-tab-count:3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;disable
interrupts, old 808x CPU bug<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>MOV<span style="mso-tab-count:1">&nbsp;&nbsp; </span>SS,AX<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;SS
is same as CS<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>MOV<span style="mso-tab-count:1">&nbsp;&nbsp; </span>SP,SPP<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;initialize
SP<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>STI<span style="mso-tab-count:3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;enable
interrupts<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>MOV<span style="mso-tab-count:1">&nbsp;&nbsp; </span>BP,RPP<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;initialize
RP<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>MOV<span style="mso-tab-count:1">&nbsp;&nbsp; </span>AL,023H<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;interrupt
23H<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>MOV<span style="mso-tab-count:1">&nbsp;&nbsp; </span>DX,OFFSET
CTRLC<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>MOV<span style="mso-tab-count:1">&nbsp;&nbsp; </span>AH,025H<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;MS-DOS
set interrupt vector<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>INT<span style="mso-tab-count:1">&nbsp;&nbsp; </span>021H<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>CLD<span style="mso-tab-count:3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;direction
flag, increment<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>JMP<span style="mso-tab-count:1">&nbsp;&nbsp; </span>COLD<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;to
high level cold start<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">CTRLC:IRET<span style="mso-tab-count:3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;control
C interrupt routine<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">; COLD start moves the
following to USER variables.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">; MUST BE IN SAME ORDER
AS USER VARIABLES.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">$ALIGN<span style="mso-tab-count:3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;align
to cell boundary<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">UZERO:<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DW<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp; </span>4 DUP (0)<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;reserved<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DW<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp; </span>SPP<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;SP0<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DW<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp; </span>RPP<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;RP0<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DW<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp; </span>QRX<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;'?KEY<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DW<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp; </span>TXSTO<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;'EMIT<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DW<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp; </span>ACCEP<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;'EXPECT<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DW<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp; </span>KTAP<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;'TAP<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DW<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp; </span>TXSTO<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;'ECHO<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DW<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp; </span>DOTOK<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;'PROMPT<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DW<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp; </span>BASEE<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;BASE<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DW<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp; </span>0<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;tmp<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DW<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp; </span>0<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;SPAN<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DW<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp; </span>0<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;&gt;IN<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DW<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp; </span>0<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;#TIB<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DW<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp; </span>TIBB<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;TIB<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DW<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp; </span>0<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;CSP<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DW<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp; </span>INTER<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;'EVAL<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DW<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp; </span>NUMBQ<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;'NUMBER<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DW<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp; </span>0<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;HLD<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DW<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp; </span>0<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;HANDLER<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DW<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp; </span>0<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;CONTEXT
pointer<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DW<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp; </span>VOCSS
DUP (0)<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;vocabulary
stack<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DW<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp; </span>0<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;CURRENT
pointer<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DW<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp; </span>0<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;vocabulary
link pointer<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DW<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp; </span>CTOP<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;CP<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DW<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp; </span>NTOP<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;NP<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier"><span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DW<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp; </span>LASTN<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;LAST<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt;tab-stops:36.0pt 72.0pt 108.0pt 216.0pt 252.0pt"><span lang="EN-US" style="font-size:10.0pt;font-family:Courier">ULAST:<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<span lang="EN-US" style="font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:
&quot;New York&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;mso-bidi-font-family:&quot;Times New Roman&quot;;
mso-ansi-language:EN-US;mso-fareast-language:ZH-TW;mso-bidi-language:AR-SA;
mso-no-proof:yes"><br clear="all" style="page-break-before:always">
</span>

<p class="MsoNormal" align="center" style="margin-right:-36.0pt;text-align:center"><b style="mso-bidi-font-weight:normal"><span lang="EN-US" style="font-size:18.0pt;
font-family:Times;mso-bidi-font-family:Times">Some Final Thoughts<o:p></o:p></span></b></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Congratulations if you
reach this point the first time.<span style="mso-spacerun:yes">&nbsp; </span>As
you can see, we have traversed a complete Forth system from the beginning to
the end, and it is not as difficult as you might have thought before you
began.<span style="mso-spacerun:yes">&nbsp; </span>But, think again what we
have accomplished.<span style="mso-spacerun:yes">&nbsp; </span>It is a complete
operating system with an integrated interpreter and an integrated compiler all
together.<span style="mso-spacerun:yes">&nbsp; </span>If you look in the
memory, the whole system is less than 7 Kbytes.<span style="mso-spacerun:yes">&nbsp; </span>What else can you do with 7 Kbytes these
days?<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Forth is like Zen.<span style="mso-spacerun:yes">&nbsp; </span>It is simple, it is accessible, and it
can be understood in its entirety without devoting your whole life to it.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Is this the end?<span style="mso-spacerun:yes">&nbsp; </span>Not really.<span style="mso-spacerun:yes">&nbsp; </span>There are many topics important in Forth
but we had chose to ignore in this simple model.<span style="mso-spacerun:yes">&nbsp; </span>They include multitasking, virtual
memory, interrupt control, programming style, source code management, and yes,
metacompilation.<span style="mso-spacerun:yes">&nbsp; </span>However, these
topics can be considered advanced applications of Forth.<span style="mso-spacerun:yes">&nbsp; </span>Once the fundamental principles in Forth
are understood, these topics can be subject for further investigations at your
leisure.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US" style="font-family:Times;mso-bidi-font-family:Times">Forth is not an end to
itself.<span style="mso-spacerun:yes">&nbsp; </span>It is only a tool, as
useful as the user intends it to be.<span style="mso-spacerun:yes">&nbsp;
</span>The most important thing is how the user can use it to solve his
problems and build useful applications.<span style="mso-spacerun:yes">&nbsp;
</span>What eForth gives you is the understanding of this tool.<span style="mso-spacerun:yes">&nbsp; </span>It is up to you to make use of it.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="margin-right:-36.0pt"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

</div>




<!-- text below generated by server. PLEASE REMOVE --><!-- Counter/Statistics data collection code --><script language="JavaScript" src="./eForth Overview_files/whv2_001.js"></script><script language="javascript">geovisit();</script><img border="0" style="display:none" src="./eForth Overview_files/visit.gif">
<noscript>&lt;img src="http://visit.webhosting.yahoo.com/visit.gif?us1384795744" alt="setstats" border="0" width="1" height="1"&gt;</noscript></body></html>